import{g as Hi,c as Zi}from"./commonjsHelpers.725317a4.js";function qi(_t,Tt){for(var L=0;L<Tt.length;L++){const _=Tt[L];if(typeof _!="string"&&!Array.isArray(_)){for(const k in _)if(k!=="default"&&!(k in _t)){const dt=Object.getOwnPropertyDescriptor(_,k);dt&&Object.defineProperty(_t,k,dt.get?dt:{enumerable:!0,get:()=>_[k]})}}}return Object.freeze(Object.defineProperty(_t,Symbol.toStringTag,{value:"Module"}))}var _e={exports:{}};(function(_t,Tt){(function(L,_){_(Tt)})(Zi,function(L){function _(r){return _=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(r)}function k(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function dt(r,e){for(var n=0;e.length>n;n++){var t=e[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(r,(i=void 0,typeof(i=function(o,s){if(typeof o!="object"||o===null)return o;var a=o[Symbol.toPrimitive];if(a!==void 0){var l=a.call(o,s||"default");if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(o)}(t.key,"string"))=="symbol"?i:i+""),t)}var i}function x(r,e,n){return e&&dt(r.prototype,e),n&&dt(r,n),Object.defineProperty(r,"prototype",{writable:!1}),r}function S(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&$t(r,e)}function J(r){return J=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},J(r)}function $t(r,e){return $t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,t){return n.__proto__=t,n},$t(r,e)}function Lt(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Te(r,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Lt(r)}function P(r){var e=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var n,t=J(r);if(e){var i=J(this).constructor;n=Reflect.construct(t,arguments,i)}else n=t.apply(this,arguments);return Te(this,n)}}function $(){return $=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(r,e,n){var t=function(o,s){for(;!Object.prototype.hasOwnProperty.call(o,s)&&(o=J(o))!==null;);return o}(r,e);if(t){var i=Object.getOwnPropertyDescriptor(t,e);return i.get?i.get.call(3>arguments.length?r:n):i.value}},$.apply(this,arguments)}function Fe(r,e){return function(n){if(Array.isArray(n))return n}(r)||function(n,t){var i=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(i!=null){var o,s,a,l,u=[],c=!0,h=!1;try{if(a=(i=i.call(n)).next,t===0){if(Object(i)!==i)return;c=!1}else for(;!(c=(o=a.call(i)).done)&&(u.push(o.value),u.length!==t);c=!0);}catch(p){h=!0,s=p}finally{try{if(!c&&i.return!=null&&(l=i.return(),Object(l)!==l))return}finally{if(h)throw s}}return u}}(r,e)||We(r,e)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function We(r,e){if(r){if(typeof r=="string")return je(r,e);var n=Object.prototype.toString.call(r).slice(8,-1);return n==="Object"&&r.constructor&&(n=r.constructor.name),n==="Map"||n==="Set"?Array.from(r):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?je(r,e):void 0}}function je(r,e){(e==null||e>r.length)&&(e=r.length);for(var n=0,t=Array(e);e>n;n++)t[n]=r[n];return t}function ze(r,e){var n=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!n){if(Array.isArray(r)||(n=We(r))||e&&r&&typeof r.length=="number"){n&&(r=n);var t=0,i=function(){};return{s:i,n:function(){return r.length>t?{done:!1,value:r[t++]}:{done:!0}},e:function(l){throw l},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o,s=!0,a=!1;return{s:function(){n=n.call(r)},n:function(){var l=n.next();return s=l.done,l},e:function(l){a=!0,o=l},f:function(){try{s||n.return==null||n.return()}finally{if(a)throw o}}}}(function(r,e){e===void 0&&(e={});var n=e.insertAt;if(r&&typeof document<"u"){var t=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",n==="top"&&t.firstChild?t.insertBefore(i,t.firstChild):t.appendChild(i),i.styleSheet?i.styleSheet.cssText=r:i.appendChild(document.createTextNode(r))}})(".BMap_Draw_Panel{height:47px;border-radius:5px;overflow:hidden;box-shadow:0 2px 6px 0 rgba(27,124,236,.5);float:left}.BMap_Drawing .BMapDraw_Box{border-right:1px solid #d2d2d2;float:left;width:64px;height:100%;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYUAAABjCAMAAABDl+xRAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo4RUY1MTQyNzhBNThFMjExQTlDQ0JCMTMzNEIzNTNBQSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo4M0ExRDlFOTU4OEMxMUUyOUNDMkFCOUMwMUQzOTI2RSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo4M0ExRDlFODU4OEMxMUUyOUNDMkFCOUMwMUQzOTI2RSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5MUY1MTQyNzhBNThFMjExQTlDQ0JCMTMzNEIzNTNBQSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4RUY1MTQyNzhBNThFMjExQTlDQ0JCMTMzNEIzNTNBQSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PkLjstsAAAMAUExURR9zsKfJ4eHr8dPk8EGMv+Lp7id8tx1vrOnu8hxtq1max0WOwCl8tpO61ou104a11mGeye3y9Sp/uDKCumKaxJO92lycyKvJ3vL3+xtqqXSmyzR8tGikzb3U5HypzHqu0sLa6x5xruXs8fL09sHW5SB1soOtzlWYxbXS5rXO4VyWwr3S4S6BuXWr0ZzD3iR5tI662VGVxazN49bh6uXv9rzW6NLg6tzn7iBzrOjx902Swu7w8napzSNvpI241srZ5rDN4TSEu6LF3UmRwsrd6s3e6oGy1BxrqabH3UyLtiN2sn2u0NDj74Wz07PL3iFuq6LB2FaWxNLj7ix8tt/p8aLG4KvG22iexmymzeLs8zqAtprC3St0rmWgylKOvDeGvDiFu2OgyyJ5tZG2032w07jR4rnU5yVyrS55sbrS5EyJurbQ4sje7VGRwNnl7D2EuKnL4rHQ5J7C29fn8fb5+maizPDz9TSCuNfX1+Pt9Dt+tCV1sUODtoOv0DqIvTiHvZrB25m+2MbZ5oKx0fj6+8ba6dPi7NHf6VSTwWmhyT+Kvyx/uNrk69fk7tjj6yNxpkeErzKEu97o7vPz8yh6tW6hyFGQv0+Uw6DD3EuMvD2KvvT09CZ6tSl3sf///1WVw/X19f7+/vb29vn5+fv7+/z8/P39/fr6+vf39/j4+CJ4syF0riF3siF0rR9vpiJ5tNLS0iJyqSNyqRtpqE2NuUyNuSuAuSF2sx9yrzyJviZ7tiN4tCV6tU6Ouil+uE6UxB5wrfz9/vr8/ff6/O30+R90seDs9ery+Mvf7vX5/O/2+iV7tpfA3N3r9M7h7r7Y6R9wqB5soiByqyF2sB9upXCoz9Pk7+Lu9Z/F34q42PT19sbc7Nvp8/r7/CJroCJyqCNyqK7O5PHy8iZ5tb/U4/T19bnP4e7z9+Tr8E6OuUiFsEiJu/b393KhxvT29zSAt06Nt5i818zb502MvKfD2VGUwtzl7Ch9t0SFuCJ1sT6IvMbc68nd7KzK4DB/t////2zsHaoAAAEAdFJOU////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wBT9wclAAAO8ElEQVR42uyaeViUxx3HF8EXdje4KyuIJwjoIiwKCBrQqLhRNKJ4BCUeAV5RUGmMEjQ1McTUqAVjorlMjNNIWgKRtklQFLUv7HLfuYhnbpvQJq0xabJNE21n911g3wOYmVeWp8/zfv/g4d053pn5vDPzm/n9FOA4T4U8/YGr33P0+usPH3+9U685qthRRRwVcPTw8Vf5OiquZ8X1cOGzfUq8QvvrulvAbRm31Y794fSUMwac0eGOHH9gu4ccKI5LpPAmkEjhTSCRwptAIoXuFhBScBgDIgrHZQoyBZmCTEGmIFOQKcgUZApYFPYk+ZQdyvGXKQwkhWpVmU2aAaQw1VOlLzPoVZ77Bp5C2KE5OBQuHSrrQQaNCZ3CaC99VmFDcLnXHFIKcy/p3crc9Jq5hBQmGrubHjsbl8JNba5x4eDbQWHv5sfT9bllZS8PxaBgKOtRBvS58LOXW3VhS13hh2WPPURE4amcrtem7SWgME3vxZF+GhYFP9uby/cRU/jrHO9pd89flBNrfXmK3k9VZlQNRafg1YvQKWiYpMIwxivJFMb4k1DYqnN4rW42NoWgXFju5UVjBh89OnjMopfhQ24QBoWbXl4GvdrLK3Y6KYXNbNMrkjXz53pY94Whl3NUgTgUti7j6EObgrEoJFt+WWaxWHRVzZZIAgqzefhnY1IIMjBM3O7pneM1ffchhjEEoVN4kTE88eznoxlmPSmF2QwTtvEpW4PvHfO4X4RBPehymk8gKgWGYe4T252jYAI6hXTL1jZIwRKlsUTjU9gLB5Ejw91YFB7ItVjUBx1H7KDaYsk9gEzBwOjh3zEMs5uQwvYXtfDLCQg64qfXWVipBwVqfR4fhEYB5henABPQKQRT+mgKKiGF+QqfgsrClwqLgp6i1AHcIQtQU5QemcJjlsfgWrTNYplPSCE9z+ObIXEUR+qAoRTlhkYBZhenABPQKXykP6s+C6U+ewnfRnqys926CF3nv0EYFGbDklP5YzYVVjUblcIMivLZfENHWX4ko7De8kTBcIovo0eKcykUZqeet0n/ED6FdLbRliOwxcO92IeFGBQgf0/hoHnCbwKVwkHdWZt+Q2QjBRyJ8yyYmn+WL2qon+4wGgWYW5wCTMA5O9etnQwVvofg1GZkGz3TtpWFsw9GdApB58+nThcO2nT4XQShWqr7foBfkJfn50QUYs/nv+rhdl4gdfEPPoi7M8wtTgEmYN0jRVsprL0V+ws2hbhXbI0OsFHwYHsQh05h0eTJC8VuMODvi5BPbZth45cSnp1TJy/fvvfWZIGSA+/QIFKAuUUp/Bom4FE4x0q3bBkmhbNso1mz7hv24RV0CkvPnQsSoxB07txSZAoTJVCYu/CO+QUTzwl04+5zExEpwNziFGACEoWPbq6N1SbtKYwu6dIPvlgUUtlG21pcPIZ9SEWnsKOkxEOMgkdJyQ50CtZ3zujWzAM4u/Pw5+YWzCzha8y2knsRKcDcg0QpwAQkCprTVq39KPp0t2ZiUdCyjU6dBls87T/sgxadwhennxO/U33u9BfoFE7zdKsDx1JdmNpRtJZfRcDIHainNphbnAJMQKJwfbxN6dHjuxU7fxkGhTn2Vi8fOWfGHfb/j6BTmDx+sjgFmIBMIXQ8X+txKAT+bullD7efOBWkFrtpUSnA7OIUYAIShZnLa6z6ybvGUffcRKcw9JZgCG55oFO4VVNzWIzC4ZqaW8gUAq7X8DQR6wajY8euogeWcyrQDr1nJioFmF2cAkxA250btQqrtig4uo5xdt7GH4GabRhn5/0KxTUxCtcUiv3o/oWDQ0Z26zrsAB6Fgu/uuVm08SfHERgSpNiISgFmF6cAExBtpD37z4gI5zbvt1yCipWXMSjsOjNO1FLddebMLkIvz69g+zEpFMw5NrXI03EA1t84E4BKAWYXpwATUC3Ve0+MEwqHwj9DOAD3B+LcqV4bN26U2Knt+rhxoYQUXoDtx6VQNHaLR9FKhwHoWLkF+WYbZhenABOQzwsjKwV6BMu/sH2YQ/NDtuP5F7ZUVq4TUlhXWbmF0OPp+QjswEtzMSkEvhByefvXXQPw/GurViJTgPlFKdwHE5Ap/Owu0BY8X9vllV3NHxaI6Wsb7u5+THibd8zdfTgZhQlsD45NwfR4BozaVTQtky28cmrxkspdyBRgCXEKMAGZgmkVH4JyP6bfeftL9pIvbcf2O9/v7r6KZ953wBZ9T+b9/zHDPWPI4hB39+cxKXwzK2NxUVAl7MOwfcXFhyvdVzmXQuEMJV9jCzG9/wGjbBAyA/C9/1MylcpVnC93yiqlMnMKGYUlSiVc4KaPUmZie/+XZEwtuqEM+a6oaO/zlUplCDIFOGDiFGACOoX1AgobsSNhrtnKDSeJhAlNVCoz1nV7PNdlKJWJoYSRMOuUysWwkvuVidgUCkau8iiaUlTwxDBlpmdHULGTKXyVGM9V4lf48UgjleznQxAJE7oGvjNzbChclzpCx2bChzWhpPFIi+PjQz4/Oisx/lH8SJjATSFHi768P37nkkCsqDDY4M1iFMbABIw71a95FIYRRIV5rInPGEwYFXZg0wiONh0gjgqb/uiI0lGbEkeMWEIQjzQoY8TOEf9egRubN6IXYVBYxyv6JEls3oTSseSxeSt2lnZp5wopsXnfrbFVsvJVkqiwxNL4L/EjJONLexTOXPBI5BQNIYqQ7Mg4LCVCctaETY+Wlj66acIsiRGSg/+xM/H7f5HF5k0onUAQpzo2sUcIY3G8PLsdi665jyxOdYUcLSxHzssUZAoyBZmCTEGmIFOQKcgUZAoyBSkUgExhwCkAxX9lDbxkCjIFWTIFmYIsDoU/SdIH7z7z8bsfSCn/8d+llLdW8IykCm5HF56R2gXFHyXpvXcW3PXOe1LK3/WtlPLWChZIquB2dGGB1C4oSiTp/TsXPH3n+1LKP/2tlPLSK4A1fCu1CwukdkFR8mcpKjlx6pMTJVLKf/I3KeWtFZyUVAGs4eSn0rrw6SmJXfhU8QYtRW+cOPXWiTeklH/rL1LKWys4KakCWMPJt6V14e1TErvwtkxBpiBTkCn8X1Cg5rWCKn+tTGEgKegSgE1JA0jBGF7vajK51ocbB57CZ1XzcCisNoMeZErCoNAGXFU0014N5pFSiFjtGgNiXCdFEFIY3dLd9JZkXArtV3xbXOJuBwXjaI2Lqy8A1fkYFEygR5nQKfiAGB3tlkJXmBoZIgrqtq7X+hsJKJS3ctveWo5F4UFboWojMYWm9PA8vd/FtqvWenxdXepNLa356BRAL0KncBHOgc+AaR69FfiQUEiucnhtVTs2BVUjLFc3ySeFplN8JtXBh0YVBoVkAMwJFwDIpkgpjGabnr1htV+EzvqDgWqrZ3AotFeIKBmLQjBQVVjHj7oEwggotPPwt2NSUMFltUHT1WlG0wCHVYVOIRuY9XTTBgDSSCnA4YpMU7PTUqt50NV8IZfyz2IwKIhO3nIsCi6gPc06fOWTQA4+hVj+3mSOwKKQVw1ArZvjL261cH3JQ6ZgBq22ZRVoCClQ2f7J1mk4zyWhwd6H2lzG/4qm3JkUkkFCjvXVEY0mHT6FesFaWI9FAZav5b1WVytWSU8U6kAdXIvSQW8TuVcKSVE6urmR24eWFAMAUc6k0JQAbCZKLWjGt5FUne1ucO38kMR3lx4owNWgQS3Y7qGZkoxKIRLaBGlwGTOVk1HIMenpMMGndFVXDS44kwKtrrbbJhQ+BRe7SWY1csPsi5MLBgXI/5Iw8yX4NaJSyPNl3zqJyEaKS28Mp41VQhsz38U3z6kU6DibqendRHBqy2Yb7W17CLcbG+gU4FSqE7FGKGgpqVAtVbX10FkV3kREIRtUNRlqhSZmC+3qTzuXAm3bnaMbXPXYFOzTKIVd0NmHRnQKzQBcFMsNf29GPrWl9bgZ9U2hDtqGal8hha2MuXlAKFjHL7YCk4L94Mh+z02iJ8beKGQBIEpeD0CWUyhUXKwKo3OEFDQRYLSzKDSFRbv6p1NdFKAS8rEoxLCl2BZr2YcYdApwKom+Lx8aq1gU6ly6FZ6HszuHVcV2LqUO8pknHNr+orDa9sboJgcK9iUelYL98iLG2vG8C+xDGzoFM6gSf10VMGNR4KhRh2OpXoyKozfwq4iLrHPaqc2+qic59iPBLxaDgl+noRrp92CnqeqHQ8EsTsGMQcFH8CVrcSg0ZV1pMlzlVhBFX412GgVv+750iWulhaFTMDQKhqDRgLUipYjlTsFZkQx1/CakYd1gxMVMot24O/SGfFO4824wDNG2l17gdqIO4+ycLqCQjnF2zhJapJ0WLPruTOeFO+wKddgU6ApzMq3lXFCH+4jMp/6zkaj6vi9ke7/NC+aVDW7CoNDcw2nLG8dSFV6pYFKAO7SR1nAmkwbEOfM2z80kkQLlzymaReHcqVpPbSIFqBjhPUh/UqCTanWczykluJZ2JgW7k4SjKiz/AhPtUNSfwfMvSL/B4EljvY1IMGJSoOr9m5jsrl58Rl8Idi4FvZBCLRYFmur+iqIpGo9CMgC+0m7zBEuczWPmhkcB7tDNdLndZAw2QtOv2bkU6CgBhSw8CjST0GnlMjQmhZ5utltpIgq58AASngMnZyQmBTrCPJpWWVfnDXAelZsEF6r97+Xh6yImBfglsTZqHI1NwU3cy+NGRiHM5uyhonow83rz/vs1qOl5oK0CTsVIk+jRs18pCG9R0nAp2A9OyTQ+BckeT+6uAGz+wiuih8E+YjBcWgw0XBz1G0C1JkXc892PFHR8K8lkwKZgm1DRNAmFLu8/XJd0BN5//mUG3JpizaK3631QoFrbmmhtFqj169HM64mCqKdYi3en6sq3+Gl8Cjpf0JBLRkFqJAxnJKGdE1VfJe7+7CseKaUB1ILs9l660I+RMIIbRT0BBXp1H86uXqPCkh38LLXYUWGOMrJ2TiRNQIE2A5O21y70Y1QYncJ1+LXRJBRSGsrJKdB0hXcr/IyzW717cXAgnRfiXFqqstppIgrNvXree6Iw6fZESELTwEHV5UQU6HZaCoW+JUfO03LMtkxBpiBTkCnIFGQKMgWZgkxBpiBTkCn0M4X/CTAAQMqViQc6GXMAAAAASUVORK5CYII=);cursor:pointer}.BMap_Drawing .BMapDraw_last{border-right:none}.BMap_Drawing .BMapDraw_hander{background-position:0 0}.BMap_Drawing .BMapDraw_hander_hover{background-position:0 -52px}.BMap_Drawing .BMapDraw_marker{background-position:-65px 0}.BMap_Drawing .BMapDraw_marker_hover{background-position:-65px -52px}.BMap_Drawing .BMapDraw_circle{background-position:-130px 0}.BMap_Drawing .BMapDraw_circle_hover{background-position:-130px -52px}.BMap_Drawing .BMapDraw_polyline{background-position:-195px 0}.BMap_Drawing .BMapDraw_polyline_hover{background-position:-195px -52px}.BMap_Drawing .BMapDraw_polygon{background-position:-260px 0}.BMap_Drawing .BMapDraw_polygon_hover{background-position:-260px -52px}.BMap_Drawing .BMapDraw_rectangle{background-position:-325px 0}.BMap_Drawing .BMapDraw_rectangle_hover{background-position:-325px -52px}.BMapDraw_tip{position:absolute;top:50px;display:none;overflow:hidden;width:162px;height:40px;border:1px solid #ccc;line-height:20px;border-radius:4px;background-color:#fff;text-align:center;font-size:12px}.BMapDraw_tip_text{font-size:12px;color:#999}.BMapDraw_tip.polyline{right:135px}.BMapDraw_tip.rectangle{right:65px}.BMapDraw_tip.polygon{right:5px}.BMapDraw_tip.circle{right:-45px}.BMapDraw_tip p{margin:0}.screenshot{position:absolute;background:#fff;border:1px solid #e9e9e9;border-radius:2px;color:#333;padding:0 4px;font-size:12px}.screenshot .unit{display:block;color:#999;width:12px;float:right}.screenshot .circlShot{width:50px;text-align:center;line-height:30px;height:30px}.screenshot #screenshotNum{display:inline-block;height:30px;text-align:center;cursor:text}.screenshot #circleInput{display:none;border:none;width:34px;height:30px;margin-top:-1px;outline:none;-moz-user-select:none;user-select:none;-moz-appearance:listitem;appearance:listitem;-webkit-user-select:none;-webkit-appearance:listitem;padding:0;font-family:inherit;font-size:inherit;line-height:inherit;color:inherit}.screenshot #circleInput:focus{outline:none;border:none}.screenshot .rectWH{width:120px;height:30px;line-height:30px;padding:2px 0}.screenshot .rectWH span{display:inline-block;width:10px;text-align:center}.screenshot .rectWH .multiple{color:#999}.screenshot .rectWH .wh{display:inline-block;width:45px}.screenshot .rectWH .wh #rectHeight,.screenshot .rectWH .wh #rectWidth{width:33px;cursor:text}.screenshot .rectWH .wh #rectHeightInput,.screenshot .rectWH .wh #rectWidthInput{display:none;border:none;width:34px;height:30px;margin-top:-1px;outline:none;-moz-user-select:none;user-select:none;-moz-appearance:listitem;appearance:listitem;-webkit-user-select:none;-webkit-appearance:listitem;padding:0;font-family:inherit;font-size:inherit;line-height:inherit;color:inherit}.screenshot .rectWH .wh #rectHeightInput:focus,.screenshot .rectWH .wh #rectWidthInput:focus{outline:none;border:none;padding:0}.screenshot:focus-within,.screenshot:hover{border:1px solid #5e87db}.operateWindow{position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}.operateWindow>.containerbox{width:270px;height:35px}.operateWindow>div>span{display:block;float:left;margin:2px 0;text-align:center;cursor:pointer}.operateWindow div #confirmOperate{margin-left:15px;background:#fff url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAAXNSR0IArs4c6QAAAwxJREFUaAXtmE1oE0EUx2fWNCkpfkA9iXeN0tbqYVNUFISCJ1GoiPhxELWtx3oQRBA8iR48iEkPJYIeilK8qChFxJOJSlNsxYhFFKviIVQqqTUm+5wpmTIpm+xHNpspfXt5szOzb/6//+zO7iwheKAD6AA6gA6gA+gAOoAOoAPoADqADqADK88BupyQhzI7V+d/zd4AQg4x4T81CgNn9clHThiWDfDdpL7mN5l7CgBRAcjEzxMSiPR1jX8WdVZRs+qgQrsZLNfFZrqZUNjtRKPywJVgBSSlxpQo24lKA1vBEkoTvfrESzugoo+ywCXYJ/IzK0TzSCkZXq9vPi3X2SkruWhJsF1mEBy2VY8cO0zvF83aq9UpB1xPWG6EUsD1hlUK2A9YZYD9glUC2E9Yx8CPP+4PTc/8iIQg+PWk/irLE9Ry+A3Ltdp+D8ded3R+yU5PFYqFdM6Y+xZPtp/3AJZ/G3v+6qmmyzYwFI0YE7exlCxkgHEtlmy/Xi15pTZpZhc3AnLfWt6zch6zsm1gArB1aQIAY+BWsm0Q4LLtPBKsrzMrtNsWyr7lXoiLyiLAmXhy5M5z2Bsoqzc5aTQsl2QbuInQXgb9yYSDbdPgaCaVHeGLmlk7r1MBlutw9KU1NNa5IZ//NwpAtvCLlx6U0GctYXrgRMfbnNxW+lPh+wIlaxBl2zPMLzi1Pf1dC4T2MLAxkUCObKb35f7AaCK9bZ2oVwmWa3I0wwJi8M2OtcXC34fsXt4l6soiJePNwaZuCIfn2T8oJWZW6HMFzC9m0GEG/YBBd4tkcqSUfmDnM9X2s263ePI4TsuugflA9971BLOzmWF2Kx90MnA937NWOmoCXoCGnlXZ1PsEW8iOWw3G2xsJuzC+HZFWfdhtS+OptpsMur9a30bDcm2OVulKMOx5hb7o5Dmi0auV+7j/LVMpp5t6T4DFwP36xAWiaRfFuYgqzOyiFlHwMrJNxRFCjEvsFm+hRLvdGt10xc0PNy81YS50AB1AB9ABdAAdQAfQAXQAHUAH0AF0YCU78B/Xn4einv7Y7QAAAABJRU5ErkJggg==) no-repeat top;background-size:contain}.operateWindow div #cancelOperate,.operateWindow div #confirmOperate{float:left;width:50px;height:30px;box-shadow:0 2px 4px 0 rgba(0,0,0,.3);border-radius:2px}.operateWindow div #cancelOperate{margin-left:8px;background:#fff url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAAAXNSR0IArs4c6QAAAupJREFUaAXtmTtvFDEQx2eWQ4ICISRaegq6hI4CCSEkQgkRgi6QkhRwCOiOGlIAouIhUhGSAqVFQgr1HWW+AvcBIo7myDB25GjX571drx8NY+m0a589M7//+rVeAEmigCggCogCooAoIAqIAqKAKCAKiAKiwP+nAIYi051LZ2D65w0Q3ODfGI7hU/wy2gm1a9rTzYUHgPgYgE6y/U9w4dQzHOxOzf++18K3wUx9BXsAdzmY0/zfefhLX+nW4r2Zeh0KaHnhJTd7DUTn2P5Zvu/D3n6/g6mjJuHA6slWE3KA70Khuf06C/moalrl0PY3W2VOSQzgscN+ELSGJXrosMs9m345y1sWhgPzmGVf5PDXCVp34zpYgAkcL547fLUuCgbWExTiagxoDevsxppnAj1cws/DvdZ0jorBs7Sxqccsj13Ou2wSz7SruD36YOrb11awm6Ndu51v3hWcr42j+l2hc8GqQKMCK4O+0DlhkwD7QOeGTQbcDhq+8dx+TdV1pMMJKsKYtW1H79JlBw3du1y1fJ8MVjlJCqwceEInhc0C7AGdHFbFErzxUEaakl5/kcdsfeJ1mt5igjFru8wCrGfj+glKxcTbUOzr7m9HGDmffgyrV7z67aKN07gjsxv45pM+4YZ1NtoLhw90MuAG2AkU+IIDzQ6dBLgRVr31bI2eMPT93NDRx3Ar2NJsTMuLK3BA7xncFUv0Me1y4jMkKnV9YU3jnNDRgHlJWefjF/exjDqpwOI6bg9/GEj7mgs6CnAorIHPAR0MzN14jdfZVyboyhXhN2/mluY92Up9zjRC94qruDn8brdrmw+fpXmH5HTWAVbZ4dn749zZe0qOo1tnBM7CcGD1RcBOHWGNmQboWX+mYYtrOLD6/FFOgbDGVC10QVV/pkHLa/gYHlzuHX7+0F8ExnyUOgg9Si3HTrcvXgHVjZFO8Eq9gVs/N8r/y70oIAqIAqKAKCAKiAKigCggCogCooAo0EGBf6iFZapSQC/BAAAAAElFTkSuQmCC) no-repeat top;background-size:contain}.operateWindow div #warnOperate{float:left;width:200px;height:30px;margin-left:4px;line-height:30px;background:#fffbcc;border:1px solid #e1e1e1;border-radius:2px;font-family:PingFangSC-Regular;font-size:14px;color:#703a04;letter-spacing:0;cursor:default}.operateLeft p span{float:right}");var I={STATUS_FREE:"free",STATUS_DRAWING:"drawing",STATUS_EDITER:"editer",STATUS_MOVE:"move"},M={INIT:"operate-init",COMPLETE:"operate-ok",CANCEL:"operate-cancel",CHANGE:"operate-change",CLICK:"mouse-click",RIGHTCLICK:"right-click",MOVE:"mouse-move"},te={AREA_END:"measure-area-end",LENGTH_END:"measure-length-end"},X={DRAW_ON_MAP:"draw-on-map",EDIT_ON_MAP:"edit-on-map",SELECT_ON_MAP:"select-on-map",MOVE_ON_MAP:"move-on-map",DRAW_NO_MAP:"draw-no-map",SELECT_NO_MAP:"select-no-map",DRAW_ON_MAP_CANCEL:"draw-on-map-cancel",EDIT_ON_MAP_CANCEL:"edit-on-map-cancel",SELECT_ON_MAP_CANCEL:"select-on-map-cancel",MOVE_ON_MAP_CANCEL:"move-on-map-cancel"},B={DRAWING_POINT:"point",DRAWING_MARKER:"marker",DRAWING_POLYLINE:"polyline",DRAWING_POLYGON:"polygon",DRAWING_CIRCLE:"circle",DRAWING_RECTANGLE:"rectangle"},Ue=`data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6Q
    AAAd9JREFUOBGtVc8rRFEUPufOvELMguTHwkbKjxRlo9gqNpjyFyhTit3I8i1ldpQa5S9QmA1lS9koSn6UZmMxSCyGkPlx3O+9mTe8Zl4z
    w7eZ7rnn++aee893HlMRzEXFeLh6m2LJTpHwEJG022mcIJZTYbXX2lu/txnilJvO7sDkYnJaC0REqNO993PNTHEiDsfWAru/4vmFaYo6e3
    5dEZIwYh1tPhobNmig20/NjcpKe3rJ0vlNmg5PUnR3n7FiTBwZbGpYNk3OIuCccHIhuQoxv49lNljD4yMG6VMUhT49HRynaGvnU9IZ0Wkc
    ia0HlhxBlCkiOxAz5+u4v8tXVMgdvLjNkLnxbosyB1E+4wEeL5PXuLPQTC1NjBpunud6/yhF0e0PVBNv6Qv0KLwmxHBnKLNSgAMuNKClrN
    bQKniAUnfm9SfggAtAS9l9RtZrehG99tAJFnTP6n6wmzbfGl7EUnsFrrTbDVYqs4q4FtR20kDTVosClxMK3oQQHFAtHK7WUjA6hGAnOKBS
    gAMuAC2FqYGmhDdhp0oBDrjQgJayRxBbAwHehJ3KBXLBsfM5DC3H/v81HHIdSYQRpMcX6ekRhjcPjr/KGV+6Unt8xXJlOSfMl/lvAzYviN
    +/fAK+AW5jAVefzjWGAAAAAElFTkSuQmCC`,Ye=new BMapGL.Icon("//mapopen.bj.bcebos.com/cms/images/mapctrls.gif",new BMapGL.Size(12,12),{imageSize:new BMapGL.Size(82,174),imageOffset:new BMapGL.Size(0,14)}),Je=new BMapGL.Icon("//mapopen.bj.bcebos.com/cms/images/mapctrls.png",new BMapGL.Size(12,12),{imageSize:new BMapGL.Size(37,442),imageOffset:new BMapGL.Size(25,312)}),Hn=new BMapGL.Icon("//maponline0.bdimg.com/sty/map_icons2x/MapRes/shenghui_1.png",new BMapGL.Size(10,10),{offset:new BMapGL.Size(5,5)}),Zn=new BMapGL.Icon("//bj.bcebos.com/v1/mapopen-pub-jsapigl/bmap-draw/static/edit1.png",new BMapGL.Size(10,10),{offset:new BMapGL.Size(5,5)}),ee=new BMapGL.Icon("//bj.bcebos.com/v1/mapopen-pub-jsapigl/bmap-draw/static/edit2.png",new BMapGL.Size(10,10),{offset:new BMapGL.Size(5,5)}),xt={borderRadius:"2px",background:"#FFFBCC",border:"1px solid #E1E1E1",color:"#703A04",fontSize:"12px",letterSpacing:"0",padding:"5px"},qn={operate:null,isOpen:!1,isOnMap:!0,isSeries:!0,skipEditing:!1,isSelectDraw:!1,enableCalculate:!1,enableSnap:!0,snapDistance:10,drawCursor:"crosshair",keyCode:87,baseOpts:{icon:Hn,node:Zn,nodeT:ee,fillColor:"#1990FF",fillOpacity:.2,strokeColor:"#877efb",strokeWeight:3,strokeOpacity:1,enableDragging:!0},labelOptions:xt,matchOverlay:{type:"Circle",radius:2,icon:ee,strokeColor:"#fff",strokeStyle:"solid",strokeWeight:2},centerIcon:new BMapGL.Icon(`data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6Q
    AAAs1JREFUWAnNmb9v01AQx989SzVI8dIBJNZ27Mb/QRpExMiOKAW1Mw3MRVCB2BlRECF/CBtjuwbBwGJL1JXs474vtuU4Tkho4tyTGr9f
    fvfxvV93VzL/mfYPLndSumqT4buG6Y4MI3+MpyQayc/IEI/Y0DfLW8Ov725cuKYlf2iZ/p3j8FZylT4hQx1m3lvmXSL6zoYH3pZ9PzgNfi
    367kKA3R634t/REXF6zMa0Fh28rp8IjJjsqb/det3vUVTXp1z3T8DOs/B+kvIHw3y7/OK180Q/PUuPB2+DL/PGsrMaZQrp3tPwJEn488rh
    IFQ+GGNDBmTN4qht6D7nm3ESfpRBurNeXGk9Ud/3gkf9N/SnOu6UBvE1jcKBSBQBmXWanAJsH0YvGtNcWV0C6WSX6yQ/McVuQ2DNycFW6d
    dQkdjz6EF54xQg46MkPMfibYimXozsbn872M2PoGKKcc5tHA7IoiDHkuE7DeKGSOP04rqHcL1Klq8VqMj6dgc3jtMgx+mBFjh8DlhwpSI/
    BiTaR0FTwn0PHnJWiYnPNcHlLNb4uxYmU16h7Qk26+w5bWQZD9hsZmzqRBRDGJsks4JVMgIwN9M1ArIAykRrRHNMwoY1+EMtoLBhDcID05
    pGMsWsF1DYLPxWrepzPjWcaq2AYLPw+OFUa4MEE9jG1ox4/NoAEYUAkwNEOAJGohZIsICpAITlinCEFkCw5PEbp0GAIVZixGHZOKRzmoQl
    SwUgvCjESsSG3eDVJ26nMOQeHRgLQBScP0r0EvmNJJFd9onBIOtxMiH80D4MPzUeXZD4zPAseCjHy8QMTmgQqOiAQI5k+pPoayxlwaMqnO
    OZJXasSRenOVlfKES0JdM6PGu9qoObC5iDqw1g5oBYtIiVGLK9VRzmbgwZC2NWN0Qus/yc2iTlxmoeIRIXhRBHX5bAXrV9XlmmcH1B9DrB
    Tf0b4i99lUEMOuku/wAAAABJRU5ErkJggg==`,new BMapGL.Size(20,20)),circleMoveIcon:new BMapGL.Icon(`data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAAXNSR0IArs
    4c6QAABcdJREFUeAHtm0FoHFUYx7+ZbDfJJiZUqcEgBU3BqtGKRdGLHsSTSGxL8agUT230YtGTDQl6EKt4CD1JqPQkastSPImIvVSUQINR
    K1jrQVNSRRGz3WST3fH/f5k3THY3mmzejLub74Mv8/bNzJv3fnwz773v+yKiogSUgBJQAkpACSgBJaAElIASUAJKQAkoASWgBJSAElACSk
    AJKIH2J+A1OsQgCIZw7wh0P3Qwpr0oN7MsoHNzMZ1GOe953pVGOr0pgIB2Kx4yCj0AHW7kgU18zyz6dg46CZjXN9rPDQEEOFrVy9DjUGNh
    haIEX8+WvEuXy/LbnxX5468AWpHF0kYf/f9c190psrPPl5v7Pdm105cH9nbIQ8PZoKdbLAta6Eno2wDJ8r+KvWndiwDvIE6egg7wooszy/
    LJhZJ8e6UslQprWl98X+TeoQ556rGsPLpvhx3QPApHAfGsrah3XBcgwPHcCegY1Pv+pxU5nV+Sy1fL9dppm7q9d3TI8yOdcvedGY4pgI5D
    JwCS5RqpCxDwunHl+9DDlUCCqbOL3vkvmvzdrBna1iqefjwrRw52Bb5nXu0P0dpzgFisbrUGYGh5H+DCw4ViELw5dcOb+aG9ra4aiv2976
    4OefVIDt9Hj5wI8dlqS8TbXyN8bQ28V94pbFt4pELDIQMaEplAyWaNrAEYThhjfG1peb/Mt8kssWbIm/tBBmRBJrhzLGQUNRIBxAkuTzjb
    evzmbdfXNiITK5AFmZAN9FTIylwRAcQvrvMGONtutwnDkPiPP2RCNmQEJSsjBiCIcofBRbJZqpgzjv88cn8GC1azNHDW8qEns7L7trgNOG
    u6bkNcxoVyPGQm9ukv4kQvF8lJrfN6cx5mtG6nEG/p9+X10VxqEMmGjMgKOsqCBfgMf3CHkZQsw/p3ZNxCLOPL3n9TuhBjjOgPEB+mSK/K
    MPe23J4lJdPfLcvfhcApxM++XJZyOV2IZERWZEZ2tEC6pOSrb0peknvbhRsir00WnEL8ea4ib50upgqRjMiKzCAjBEh/nlxKYbdx9deKc4
    gXZ1ZShxhb4u0nQDpD5Xe4pNKQdoBI910ogxFA+vPSklaHGGMVBxhRTYVjK0Ok4zgUA9CYnvE32OqUjoSIfaZ5ml3i3D7Al6Jx4TfRLni5
    xJk4lpPObOPt1bszxipgb6/xIrq50xa40eG87Ioem/+8JFt1YAzu8uXAE6vEuE6cOrcoS46XtzFW10iNESoTI4hGkkKB8CaO9cie3R3maR
    99uiRnzkdbpYZ6QHhvvJTDWHwhvHfPFOXCtNm/NtTeejcxnhLKXASQAZa0pJXhkVGMlQHIuKjQ+5qGtDo8MmIkL5Rpml2ePx6+LxswOpWk
    tAM8MmIYNOSU9+HjZ0R+FoPzGNpLSjJo2vU3r6/XS+WbF2dCRmRFZmRnbY4ReRMXjV/ssvzgPRmnEwb7xshZ0hNGNQPGjkMxzCzASVQuMK
    jMuGgS0tezOnO5mG1t/xAtS3S2tc+xR7IJA+/MWCCzVX8gTJG5IExnMEFlHl0L41ou4bF/SS5V6o2fAfdQTobMonwQgW+LXtYfoQPvfbzo
    PC6SgTd/xfGSLIssjJJxENtxJXfk5+KFQ2bRP4+n7AFAWmHkkZaw4ijqAkbkXS9rXMNj59OCRxZkQjZQ5ssYeOyD/QayTIhMpBlnOgMj8l
    vdl5pGW/wPGZBFmOIxHjKKRhXtSWwNXmXWaWoHIGwktaMGIEECInaqmlzUUHIRAVJCSzyB4hhU09s2k95GgFYAUhMsLYw6x7qvcPV1gMgl
    Tk2KL6NTDEYxntIqKb5d2Ehw92JTfPmdox8g3J5x6JxhuSZ2k+LLFq0AJFNAmMXAQPywrW+T4yzGkUySeT1AgDmEesaUGRZlZM8qrbWZhR
    ZGJ7LVLf2bQzMPVPumBJSAElACSkAJKAEloASUgBJQAkpACSgBJaAElIASUAJKQAkoAVcE/gG4Wba8Vno8+QAAAABJRU5ErkJggg==`,new BMapGL.Size(40,20),{imageOffset:new BMapGL.Size(0,10)}),moveIcon:new BMapGL.Icon(Ue,new BMapGL.Size(10,10)),limitPoint:-1},$n={tips:"测距",unit:"kilometers",startLabel:"单击确定起点",followLabel:"单击确定地点，双击结束测量",skipEditing:!0,enableCalculate:!0,turnIcon:null,closeIcon:null,isSeries:!1,baseOpts:{strokeColor:"#f00",strokeWeight:2,strokeOpacity:.8,fillOpacity:.2},labelOptions:xt},ti={unit:"kilometers",startLabel:"单击确定起点",followLabel:"单击确定地点，双击结束测量",turnIcon:null,closeIcon:null,isSeries:!1,baseOpts:{strokeColor:"#f00",strokeWeight:2,strokeOpacity:1},labelOptions:xt},Xe={icon:ee,nodeT:null,node:null,fillColor:"#fff",fillOpacity:.1,strokeColor:"#00f",strokeWeight:2,strokeOpacity:.6,strokeStyle:"dashed"},ei={strokeColor:"#fff",strokeStyle:"solid",strokeWeight:"2"},ni=["marker","polyline","polygon","circle","rectangle"],m={grid:"$BAIDU$",guid:function(){return window[m.grid]||(window[m.grid]={}),window[m.grid]._counter=window[m.grid]._counter||1,window[m.grid]._instances=window[m.grid]._instances||{},"TANGRAM__"+(window[m.grid]._counter++).toString(36)},isString:function(r){return Object.prototype.toString.call(r)==="[object String]"},isFunction:function(r){return Object.prototype.toString.call(r)==="[object Function]"},isArray:function(r){return Array.isArray?Array.isArray(r):Object.prototype.toString.call(r)==="[object Array]"},isObject:function(r){return Object.prototype.toString.call(r)==="[object Object]"},copyOptionsToNew:function(r,e,n){for(var t in e)if(r.hasOwnProperty(t)){if(!e[t]||e[t]instanceof Array||e[t]instanceof BMapGL.Icon||e[t]instanceof BMapGL.Symbol||e[t].ignore){n[t]=e[t];continue}if(e[t]!==null&&_(e[t])==="object"&&Object.keys(e[t]).length===0)continue;e[t]!==null&&_(e[t])==="object"&&Object.keys(e[t]).length>0?(n[t]={},this.copyOptionsToNew(r[t],e[t],n[t])):n[t]=e[t]}},copyNotExitOptions:function(r,e){var n=this,t=function(o){if(r.hasOwnProperty(o))["baseOpts","labelOptions","matchOverlay"].findIndex(function(s){return o===s})!==-1&&n.copyNotExitOptions(r[o],e[o]);else{if(!e[o]||e[o]instanceof Array||e[o]instanceof BMapGL.Icon||e[o]instanceof BMapGL.Symbol||e[o].ignore)return r[o]=e[o],"continue";e[o]!==null&&_(e[o])==="object"?(r[o]={},n.copyNotExitOptions(r[o],e[o])):r[o]=e[o]}};for(var i in e)t(i)},copyOptions:function(r,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];for(var t in e)if(r&&r.hasOwnProperty(t)){if(e[t]instanceof Array||e[t]instanceof BMapGL.Icon||e[t]instanceof BMapGL.Symbol||this.shotObject(e[t],n)){r[t]=e[t];continue}e[t]!==null&&_(e[t])==="object"?this.copyOptions(r[t],e[t],n):r[t]=e[t]}},shotObject:function(r,e){var n=!1;return e.forEach(function(t){if(r instanceof t)return n=!0,!0}),n},deepCopy:function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,n=arguments.length>2?arguments[2]:void 0,t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,i=arguments.length>4?arguments[4]:void 0;for(var o in n?t++:(n={},t=1),r)r[o]instanceof Array||r[o]instanceof BMapGL.Icon||r[o]instanceof BMapGL.Symbol||this.shotObject(r[o],i)?n[o]=r[o]:e>=t&&m.isObject(r[o])&&Object.keys(r[o]).length>0?(n[o]={},this.deepCopy(r[o],e,n[o],t,i)):n[o]=r[o]},getTarget:function(r){var e=window.event||r;return e.target||e.srcElement},getEvent:function(r){return window.event||r},preventDefault:function(r){var e=m.getEvent(r);e.preventDefault?e.preventDefault():e.returnValue=!1},stopBubble:function(r){var e=m.getEvent(r);e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},on:function(r,e,n,t){e=e.replace(/^on/i,""),r=m.getdom(r);var i=n,o=e;return e=e.toLowerCase(),r.addEventListener?r.addEventListener(o,i,!1):r.attachEvent&&r.attachEvent("on"+o,i),r},un:function(r,e,n,t){r=m.getdom(r);for(var i,o,s,a=t.length,l=!n;a--;)(i=t[a])[1]!==e||i[0]!==r||!l&&i[2]!==n||(o=i[4],s=i[3],r.removeEventListener?r.removeEventListener(o,s,!1):r.detachEvent&&r.detachEvent("on"+o,s),t.splice(a,1));return r},getdom:function(r){return m.isString(r)?document.getElementById(r):r},addClass:function(r,e){r=m.getdom(r);for(var n=e.split(/\s+/),t=r.className,i=" "+t+" ",o=n.length,s=0;o>s;s++)0>i.indexOf(" "+n[s]+" ")&&(t+=(t?" ":"")+n[s]);return r.className=t,r},mc2ll:function(r,e){var n=e.mercatorToLnglat(r.lng,r.lat);return new BMapGL.Point(n[0],n[1])},ll2mc:function(r,e){var n=e.lnglatToMercator(r.lng,r.lat);return new BMapGL.Point(n[0],n[1])},getPointByDistance:function(r,e,n){var t,i,o,s=e/6378800,a=Math.PI/180*r.lat,l=Math.PI/180*r.lng;switch(n){case"North":case"north":case"N":case"n":t=0,i=r.lng;break;case"West":case"west":case"W":case"w":t=90,o=r.lat;break;case"South":case"south":case"S":case"s":t=180,i=r.lng;break;case"East":case"east":case"E":case"e":t=270,o=r.lat;break;default:t=~~n}var u=Math.PI/180*t,c=Math.asin(Math.sin(a)*Math.cos(s)+Math.cos(a)*Math.sin(s)*Math.cos(u)),h=new BMapGL.Point(i||((l-Math.atan2(Math.sin(u)*Math.sin(s)*Math.cos(a),Math.cos(s)-Math.sin(a)*Math.sin(c))+Math.PI)%(2*Math.PI)-Math.PI)*(180/Math.PI),o||c*(180/Math.PI));return h.lng=parseFloat(h.lng.toFixed(6)),h.lat=parseFloat(h.lat.toFixed(6)),h},throttle:function(r,e,n){if(typeof r!="function")return Function();var t=null,i=null;return function(o){var s=o,a=+new Date;!i&&(i=a),n&&a-i>n?(r(s),i=a):(clearTimeout(t),t=setTimeout(function(){r(s),i=null},e))}}},ne=function(r){for(var e=arguments.length,n=Array(e>1?e-1:0),t=1;e>t;t++)n[t-1]=arguments[t];var i=function(s){S(l,s);var a=P(l);function l(){var u;k(this,l);for(var c=arguments.length,h=Array(c),p=0;c>p;p++)h[p]=arguments[p];return u=a.call.apply(a,[this].concat(h)),n.forEach(function(f){o(Lt(u),new f)}),u}return x(l)}(r),o=function(s,a){Object.getOwnPropertyNames(a).concat(Object.getOwnPropertySymbols(a)).forEach(function(l){l.match(/^(?:constructor|prototype|arguments|caller|name|bind|call|apply|toString|length)$/)||Object.defineProperty(s,l,Object.getOwnPropertyDescriptor(a,l))})};return n.forEach(function(s){o(i.prototype,s.prototype),o(i,s)}),i},A=x(function r(e,n){k(this,r),this.type=e,this.returnValue=!0,this.target=n||null,this.currentTarget=null}),z=function(){function r(){k(this,r),this._listeners={}}return x(r,[{key:"addEventListener",value:function(e,n,t){if(m.isFunction(n)){!this._listeners&&(this._listeners={});var i,o=this._listeners;if(typeof t=="string"&&t){if(/[^\w\-]/.test(t))throw"nonstandard key:"+t;n.hashCode=t,i=t}e.indexOf("on")!==0&&(e="on"+e),_(o[e])!=="object"&&(o[e]={}),i=i||m.guid(),n.hashCode=i,o[e][i]=n}}},{key:"removeEventListener",value:function(e,n){if(m.isFunction(n))n=n.hashCode;else if(!m.isString(n))return;!this._listeners&&(this._listeners={}),e.indexOf("on")!==0&&(e="on"+e);var t=this._listeners;t[e]&&t[e][n]&&delete t[e][n]}},{key:"dispatchEvent",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};for(var t in!this._listeners&&(this._listeners={}),m.isString(e)&&(e=new A(e)),n)e[t]=n[t];var i=this._listeners,o=e.type;if(o.indexOf("on")!==0&&(o="on"+o),m.isFunction(this[o])&&this[o].apply(this,arguments),_(i[o])==="object")for(var s in i[o])i[o][s].apply(this,arguments);return e.returnValue}},{key:"dispose",value:function(){for(var e in this._listeners)for(var n in this._listeners[e])delete this._listeners[e][n]}},{key:"defineProperty",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,t=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;for(var o in t===void 0?(t=this,i=1):i++,e)t&&t.hasOwnProperty(o)&&(e[o]instanceof Array||e[o]instanceof BMapGL.Icon||e[o]instanceof BMapGL.Symbol?t[o]=e[o]:n>i&&m.isObject(e[o])&&Object.keys(e[o]).length>0?this.defineProperty(e[o],n,t[o],i):t[o]=e[o])}},{key:"setSnapPointType",value:function(e){var n,t;((n=e.matchOverlay)===null||n===void 0?void 0:n.type)==="Marker"?this.matchOverlay=new BMapGL.Marker(new BMapGL.Point(116.395,39.935),e.matchOverlay):((t=e.matchOverlay)===null||t===void 0?void 0:t.type)==="Circle"?(!e.matchOverlay.radius||(this.matchOverlayRadius=e.matchOverlay.radius),this.matchOverlay=new BMapGL.Circle(new BMapGL.Point(116.395,39.935),this.matchOverlayRadius,e.matchOverlay)):this.matchOverlay=new BMapGL.Circle(new BMapGL.Point(116.395,39.935),this.matchOverlayRadius,ei)}},{key:"setSceneStatus",value:function(e){this.scene.currentStatus=e}}]),r}(),ie=function(r){S(n,r);var e=P(n);function n(t){var i;return k(this,n),(i=e.call(this)).delayLimit=100,i.minLimit=200,i.overlayData=[],i.click=void 0,i.mousemove=void 0,i.rightclick=void 0,i.map=t,i.open(),i}return x(n,[{key:"open",value:function(){this.openClick(),this.openMouse(),this.openRightClick()}},{key:"linkOverlayData",value:function(t){this.overlayData=t}},{key:"clickAction",value:function(t){this.dispatchEvent(new A(M.CLICK,t))}},{key:"rightclickAction",value:function(t){this.dispatchEvent(new A(M.RIGHTCLICK,t))}},{key:"mouseAction",value:function(t){t&&this.dispatchEvent(new A(M.MOVE,t))}},{key:"openClick",value:function(){this.click||this.map.addEventListener("click",this.click=this.clickAction.bind(this))}},{key:"openRightClick",value:function(){this.rightclick||this.map.addEventListener("rightclick",this.rightclick=this.rightclickAction.bind(this))}},{key:"openMouse",value:function(){this.mousemove||(this.mousemove=m.throttle(this.mouseAction.bind(this),this.delayLimit,this.minLimit).bind(this),this.map.addEventListener("mousemove",this.mousemove))}},{key:"close",value:function(){this.closeClick(),this.closeMouse()}},{key:"closeClick",value:function(){this.click&&(this.map.removeEventListener("click",this.click),this.click=null)}},{key:"closeMouse",value:function(){this.mousemove&&(this.map.removeEventListener("mousemove",this.mousemove),this.mousemove=null)}},{key:"intersectOverlays",value:function(t){for(var i=[],o=0;this.overlayData.length>o;o++){var s=this.overlayData[o];if(""+s!="Marker"){var a=(""+s!="Polyline"?s._getInPnpoly(t.point):s._getProximity(t.point)).dist;a>=0&&s._config.mouseOverTolerance>a&&i.push(s)}else s._getInPnBox(t.pixel)&&i.push(s)}return i.length>0?i:null}}]),n}(z),D=63710088e-1,re={centimeters:100*D,centimetres:100*D,degrees:D/111325,feet:3.28084*D,inches:39.37*D,kilometers:D/1e3,kilometres:D/1e3,meters:D,metres:D,miles:D/1609.344,millimeters:1e3*D,millimetres:1e3*D,nauticalmiles:D/1852,radians:1,yards:1.0936*D},oe={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function U(r,e,n){n===void 0&&(n={});var t={type:"Feature"};return(n.id===0||n.id)&&(t.id=n.id),n.bbox&&(t.bbox=n.bbox),t.properties=e||{},t.geometry=r,t}function G(r,e,n){if(n===void 0&&(n={}),!r)throw Error("coordinates is required");if(!Array.isArray(r))throw Error("coordinates must be an Array");if(2>r.length)throw Error("coordinates must be at least 2 numbers long");if(!zt(r[0])||!zt(r[1]))throw Error("coordinates must contain numbers");return U({type:"Point",coordinates:r},e,n)}function gt(r,e,n){n===void 0&&(n={});for(var t=0,i=r;i.length>t;t++){var o=i[t];if(4>o.length)throw Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;o[o.length-1].length>s;s++)if(o[o.length-1][s]!==o[0][s])throw Error("First and last Position are not equivalent.")}return U({type:"Polygon",coordinates:r},e,n)}function R(r,e,n){if(n===void 0&&(n={}),2>r.length)throw Error("coordinates must be an array of two or more positions");return U({type:"LineString",coordinates:r},e,n)}function V(r,e){e===void 0&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=r,n}function Ft(r,e,n){return n===void 0&&(n={}),U({type:"MultiLineString",coordinates:r},e,n)}function Ve(r,e,n){return n===void 0&&(n={}),U({type:"MultiPoint",coordinates:r},e,n)}function Ot(r,e,n){return n===void 0&&(n={}),U({type:"MultiPolygon",coordinates:r},e,n)}function se(r,e){e===void 0&&(e="kilometers");var n=re[e];if(!n)throw Error(e+" units is invalid");return r*n}function Wt(r,e){e===void 0&&(e="kilometers");var n=re[e];if(!n)throw Error(e+" units is invalid");return r/n}function Qe(r,e){return mt(Wt(r,e))}function mt(r){return 180*(r%(2*Math.PI))/Math.PI}function T(r){return r%360*Math.PI/180}function jt(r,e,n){if(e===void 0&&(e="kilometers"),n===void 0&&(n="kilometers"),r<0)throw Error("length must be a positive number");return se(Wt(r,e),n)}function zt(r){return!isNaN(r)&&r!==null&&!Array.isArray(r)}function At(r){return!!r&&r.constructor===Object}var ii=Object.freeze({__proto__:null,earthRadius:D,factors:re,unitsFactors:{centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/D,yards:1.0936133},areaFactors:oe,feature:U,geometry:function(r,e,n){switch(r){case"Point":return G(e).geometry;case"LineString":return R(e).geometry;case"Polygon":return gt(e).geometry;case"MultiPoint":return Ve(e).geometry;case"MultiLineString":return Ft(e).geometry;case"MultiPolygon":return Ot(e).geometry;default:throw Error(r+" is invalid")}},point:G,points:function(r,e,n){return n===void 0&&(n={}),V(r.map(function(t){return G(t,e)}),n)},polygon:gt,polygons:function(r,e,n){return n===void 0&&(n={}),V(r.map(function(t){return gt(t,e)}),n)},lineString:R,lineStrings:function(r,e,n){return n===void 0&&(n={}),V(r.map(function(t){return R(t,e)}),n)},featureCollection:V,multiLineString:Ft,multiPoint:Ve,multiPolygon:Ot,geometryCollection:function(r,e,n){return n===void 0&&(n={}),U({type:"GeometryCollection",geometries:r},e,n)},round:function(r,e){if(e===void 0&&(e=0),e&&e<0)throw Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(r*n)/n},radiansToLength:se,lengthToRadians:Wt,lengthToDegrees:Qe,bearingToAzimuth:function(r){var e=r%360;return 0>e&&(e+=360),e},radiansToDegrees:mt,degreesToRadians:T,convertLength:jt,convertArea:function(r,e,n){if(e===void 0&&(e="meters"),n===void 0&&(n="kilometers"),r<0)throw Error("area must be a positive number");var t=oe[e];if(!t)throw Error("invalid original units");var i=oe[n];if(!i)throw Error("invalid final units");return r/t*i},isNumber:zt,isObject:At,validateBBox:function(r){if(!r)throw Error("bbox is required");if(!Array.isArray(r))throw Error("bbox must be an Array");if(r.length!==4&&r.length!==6)throw Error("bbox must be an Array of 4 or 6 numbers");r.forEach(function(e){if(!zt(e))throw Error("bbox must only contain numbers")})},validateId:function(r){if(!r)throw Error("id is required");if(["string","number"].indexOf(typeof r)===-1)throw Error("id must be a number or a string")}});function rt(r,e,n){if(r!==null)for(var t,i,o,s,a,l,u,c,h=0,p=0,f=r.type,v=f==="FeatureCollection",g=f==="Feature",d=v?r.features.length:1,y=0;d>y;y++){a=(c=!!(u=v?r.features[y].geometry:g?r.geometry:r)&&u.type==="GeometryCollection")?u.geometries.length:1;for(var w=0;a>w;w++){var b=0,E=0;if((s=c?u.geometries[w]:u)!==null){l=s.coordinates;var O=s.type;switch(h=!n||O!=="Polygon"&&O!=="MultiPolygon"?0:1,O){case null:break;case"Point":if(e(l,p,y,b,E)===!1)return!1;p++,b++;break;case"LineString":case"MultiPoint":for(t=0;l.length>t;t++){if(e(l[t],p,y,b,E)===!1)return!1;p++,O==="MultiPoint"&&b++}O==="LineString"&&b++;break;case"Polygon":case"MultiLineString":for(t=0;l.length>t;t++){for(i=0;l[t].length-h>i;i++){if(e(l[t][i],p,y,b,E)===!1)return!1;p++}O==="MultiLineString"&&b++,O==="Polygon"&&E++}O==="Polygon"&&b++;break;case"MultiPolygon":for(t=0;l.length>t;t++){for(E=0,i=0;l[t].length>i;i++){for(o=0;l[t][i].length-h>o;o++){if(e(l[t][i][o],p,y,b,E)===!1)return!1;p++}E++}b++}break;case"GeometryCollection":for(t=0;s.geometries.length>t;t++)if(rt(s.geometries[t],e,n)===!1)return!1;break;default:throw Error("Unknown Geometry Type")}}}}}function Ke(r,e){var n;switch(r.type){case"FeatureCollection":for(n=0;r.features.length>n&&e(r.features[n].properties,n)!==!1;n++);break;case"Feature":e(r.properties,0)}}function yt(r,e){if(r.type==="Feature")e(r,0);else if(r.type==="FeatureCollection")for(var n=0;r.features.length>n&&e(r.features[n],n)!==!1;n++);}function He(r,e,n){var t=n;return yt(r,function(i,o){t=o===0&&n===void 0?i:e(t,i,o)}),t}function ae(r,e){var n,t,i,o,s,a,l,u,c,h,p=0,f=r.type==="FeatureCollection",v=r.type==="Feature",g=f?r.features.length:1;for(n=0;g>n;n++){for(u=f?r.features[n].properties:v?r.properties:{},c=f?r.features[n].bbox:v?r.bbox:void 0,h=f?r.features[n].id:v?r.id:void 0,s=(l=!!(a=f?r.features[n].geometry:v?r.geometry:r)&&a.type==="GeometryCollection")?a.geometries.length:1,i=0;s>i;i++)if((o=l?a.geometries[i]:a)!==null)switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(e(o,p,u,c,h)===!1)return!1;break;case"GeometryCollection":for(t=0;o.geometries.length>t;t++)if(e(o.geometries[t],p,u,c,h)===!1)return!1;break;default:throw Error("Unknown Geometry Type")}else if(e(null,p,u,c,h)===!1)return!1;p++}}function Ze(r,e,n){var t=n;return ae(r,function(i,o,s,a,l){t=o===0&&n===void 0?i:e(t,i,o,s,a,l)}),t}function tt(r,e){ae(r,function(n,t,i,o,s){var a,l=n===null?null:n.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return e(U(n,i,{bbox:o,id:s}),t,0)!==!1&&void 0}switch(l){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var u=0;n.coordinates.length>u;u++)if(e(U({type:a,coordinates:n.coordinates[u]},i),t,u)===!1)return!1})}function le(r,e){tt(r,function(n,t,i){var o=0;if(n.geometry){var s=n.geometry.type;if(s!=="Point"&&s!=="MultiPoint"){var a,l=0,u=0,c=0;return rt(n,function(h,p,f,v,g){if(a===void 0||t>l||v>u||g>c)return a=h,l=t,u=v,c=g,void(o=0);var d=R([a,h],n.properties);if(e(d,t,i,g,o)===!1)return!1;o++,a=h})!==!1&&void 0}}})}function qe(r,e,n){var t=n,i=!1;return le(r,function(o,s,a,l,u){t=i===!1&&n===void 0?o:e(t,o,s,a,l,u),i=!0}),t}function $e(r,e){if(!r)throw Error("geojson is required");tt(r,function(n,t,i){if(n.geometry!==null){var o=n.geometry.coordinates;switch(n.geometry.type){case"LineString":if(e(n,t,i,0,0)===!1)return!1;break;case"Polygon":for(var s=0;o.length>s;s++)if(e(R(o[s],n.properties),t,i,s)===!1)return!1}}})}var ri=Object.freeze({__proto__:null,coordAll:function(r){var e=[];return rt(r,function(n){e.push(n)}),e},coordEach:rt,coordReduce:function(r,e,n,t){var i=n;return rt(r,function(o,s,a,l,u){i=s===0&&n===void 0?o:e(i,o,s,a,l,u)},t),i},featureEach:yt,featureReduce:He,findPoint:function(r,e){if(!At(e=e||{}))throw Error("options is invalid");var n,t=e.featureIndex||0,i=e.multiFeatureIndex||0,o=e.geometryIndex||0,s=e.coordIndex||0,a=e.properties;switch(r.type){case"FeatureCollection":0>t&&(t=r.features.length+t),a=a||r.features[t].properties,n=r.features[t].geometry;break;case"Feature":a=a||r.properties,n=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=r;break;default:throw Error("geojson is invalid")}if(n===null)return null;var l=n.coordinates;switch(n.type){case"Point":return G(l,a,e);case"MultiPoint":return 0>i&&(i=l.length+i),G(l[i],a,e);case"LineString":return 0>s&&(s=l.length+s),G(l[s],a,e);case"Polygon":return 0>o&&(o=l.length+o),0>s&&(s=l[o].length+s),G(l[o][s],a,e);case"MultiLineString":return 0>i&&(i=l.length+i),0>s&&(s=l[i].length+s),G(l[i][s],a,e);case"MultiPolygon":return 0>i&&(i=l.length+i),0>o&&(o=l[i].length+o),0>s&&(s=l[i][o].length-s),G(l[i][o][s],a,e)}throw Error("geojson is invalid")},findSegment:function(r,e){if(!At(e=e||{}))throw Error("options is invalid");var n,t=e.featureIndex||0,i=e.multiFeatureIndex||0,o=e.geometryIndex||0,s=e.segmentIndex||0,a=e.properties;switch(r.type){case"FeatureCollection":0>t&&(t=r.features.length+t),a=a||r.features[t].properties,n=r.features[t].geometry;break;case"Feature":a=a||r.properties,n=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=r;break;default:throw Error("geojson is invalid")}if(n===null)return null;var l=n.coordinates;switch(n.type){case"Point":case"MultiPoint":return null;case"LineString":return 0>s&&(s=l.length+s-1),R([l[s],l[s+1]],a,e);case"Polygon":return 0>o&&(o=l.length+o),0>s&&(s=l[o].length+s-1),R([l[o][s],l[o][s+1]],a,e);case"MultiLineString":return 0>i&&(i=l.length+i),0>s&&(s=l[i].length+s-1),R([l[i][s],l[i][s+1]],a,e);case"MultiPolygon":return 0>i&&(i=l.length+i),0>o&&(o=l[i].length+o),0>s&&(s=l[i][o].length-s-1),R([l[i][o][s],l[i][o][s+1]],a,e)}throw Error("geojson is invalid")},flattenEach:tt,flattenReduce:function(r,e,n){var t=n;return tt(r,function(i,o,s){t=o===0&&s===0&&n===void 0?i:e(t,i,o,s)}),t},geomEach:ae,geomReduce:Ze,lineEach:$e,lineReduce:function(r,e,n){var t=n;return $e(r,function(i,o,s,a){t=o===0&&n===void 0?i:e(t,i,o,s,a)}),t},propEach:Ke,propReduce:function(r,e,n){var t=n;return Ke(r,function(i,o){t=o===0&&n===void 0?i:e(t,i,o)}),t},segmentEach:le,segmentReduce:qe});function ot(r){var e=[1/0,1/0,-1/0,-1/0];return rt(r,function(n){e[0]>n[0]&&(e[0]=n[0]),e[1]>n[1]&&(e[1]=n[1]),n[0]>e[2]&&(e[2]=n[0]),n[1]>e[3]&&(e[3]=n[1])}),e}ot.default=ot;var oi=Object.freeze({__proto__:null,default:ot});function F(r){if(!r)throw Error("coord is required");if(!Array.isArray(r)){if(r.type==="Feature"&&r.geometry!==null&&r.geometry.type==="Point")return r.geometry.coordinates;if(r.type==="Point")return r.coordinates}if(Array.isArray(r)&&r.length>=2&&!Array.isArray(r[0])&&!Array.isArray(r[1]))return r;throw Error("coord must be GeoJSON Point or an Array of numbers")}function Q(r){if(Array.isArray(r))return r;if(r.type==="Feature"){if(r.geometry!==null)return r.geometry.coordinates}else if(r.coordinates)return r.coordinates;throw Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function tn(r,e,n){if(!r)throw Error("No feature passed");if(!n)throw Error(".featureOf() requires a name");if(!r||r.type!=="Feature"||!r.geometry)throw Error("Invalid input to "+n+", Feature with geometry required");if(!r.geometry||r.geometry.type!==e)throw Error("Invalid input to "+n+": must be a "+e+", given "+r.geometry.type)}function K(r){return r.type==="Feature"?r.geometry:r}function ue(r,e){return r.type==="FeatureCollection"?"FeatureCollection":r.type==="GeometryCollection"?"GeometryCollection":r.type==="Feature"&&r.geometry!==null?r.geometry.type:r.type}function Ut(r){if(r.__esModule)return r;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(r).forEach(function(n){var t=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(e,n,t.get?t:{enumerable:!0,get:function(){return r[n]}})}),e}function et(r,e,n){if(n===void 0&&(n={}),!r)throw Error("point is required");if(!e)throw Error("polygon is required");var t=F(r),i=K(e),o=i.type,s=e.bbox,a=i.coordinates;if(s&&function(p,f){return!(f[0]>p[0]||f[1]>p[1]||p[0]>f[2]||p[1]>f[3])}(t,s)===!1)return!1;o==="Polygon"&&(a=[a]);for(var l=!1,u=0;a.length>u&&!l;u++)if(en(t,a[u][0],n.ignoreBoundary)){for(var c=!1,h=1;a[u].length>h&&!c;)en(t,a[u][h],!n.ignoreBoundary)&&(c=!0),h++;c||(l=!0)}return l}function en(r,e,n){var t=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var i=0,o=e.length-1;e.length>i;o=i++){var s=e[i][0],a=e[i][1],l=e[o][0],u=e[o][1];if(r[1]*(s-l)+a*(l-r[0])+u*(r[0]-s)==0&&0>=(s-r[0])*(l-r[0])&&0>=(a-r[1])*(u-r[1]))return!n;a>r[1]!=u>r[1]&&(l-s)*(r[1]-a)/(u-a)+s>r[0]&&(t=!t)}return t}function H(r,e,n){n===void 0&&(n={});var t=F(r),i=F(e),o=T(i[1]-t[1]),s=T(i[0]-t[0]),a=T(t[1]),l=T(i[1]),u=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(a)*Math.cos(l);return se(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),n.units)}function nn(r){if(!r)throw Error("geojson is required");switch(r.type){case"Feature":return rn(r);case"FeatureCollection":return function(e){var n={type:"FeatureCollection"};return Object.keys(e).forEach(function(t){switch(t){case"type":case"features":return;default:n[t]=e[t]}}),n.features=e.features.map(function(t){return rn(t)}),n}(r);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return ce(r);default:throw Error("unknown GeoJSON type")}}function rn(r){var e={type:"Feature"};return Object.keys(r).forEach(function(n){switch(n){case"type":case"properties":case"geometry":return;default:e[n]=r[n]}}),e.properties=on(r.properties),e.geometry=ce(r.geometry),e}function on(r){var e={};return r&&Object.keys(r).forEach(function(n){var t=r[n];e[n]=typeof t=="object"?t===null?null:Array.isArray(t)?t.map(function(i){return i}):on(t):t}),e}function ce(r){var e={type:r.type};return r.bbox&&(e.bbox=r.bbox),r.type==="GeometryCollection"?(e.geometries=r.geometries.map(function(n){return ce(n)}),e):(e.coordinates=sn(r.coordinates),e)}function sn(r){var e=r;return typeof e[0]!="object"?e.slice():e.map(function(n){return sn(n)})}function he(r,e,n,t){t===void 0&&(t={});var i=F(r),o=T(i[0]),s=T(i[1]),a=T(n),l=Wt(e,t.units),u=Math.asin(Math.sin(s)*Math.cos(l)+Math.cos(s)*Math.sin(l)*Math.cos(a));return G([mt(o+Math.atan2(Math.sin(a)*Math.sin(l)*Math.cos(s),Math.cos(l)-Math.sin(s)*Math.sin(u))),mt(u)],t.properties)}function pe(r,e,n){if(n===void 0&&(n={}),n.final===!0)return function(u,c){var h=pe(c,u);return h=(h+180)%360}(r,e);var t=F(r),i=F(e),o=T(t[0]),s=T(i[0]),a=T(t[1]),l=T(i[1]);return mt(Math.atan2(Math.sin(s-o)*Math.cos(l),Math.cos(a)*Math.sin(l)-Math.sin(a)*Math.cos(l)*Math.cos(s-o)))}function ve(r){if(!r)throw Error("geojson is required");var e=[];return tt(r,function(n){(function(t,i){var o=[],s=t.geometry;if(s!==null){switch(s.type){case"Polygon":o=Q(s);break;case"LineString":o=[Q(s)]}o.forEach(function(a){var l=function(u,c){var h=[];return u.reduce(function(p,f){var v,g,d,y,w,b,E=R([p,f],c);return E.bbox=[(w=(g=f)[0])>(d=(v=p)[0])?d:w,(b=g[1])>(y=v[1])?y:b,d>w?d:w,y>b?y:b],h.push(E),f}),h}(a,t.properties);l.forEach(function(u){u.id=i.length,i.push(u)})})}})(n,e)}),V(e)}function si(r,e,n,t,i){an(r,e,n||0,t||r.length-1,i||ai)}function an(r,e,n,t,i){for(;t>n;){if(t-n>600){var o=t-n+1,s=e-n+1,a=Math.log(o),l=.5*Math.exp(2*a/3),u=.5*Math.sqrt(a*l*(o-l)/o)*(0>s-o/2?-1:1);an(r,e,Math.max(n,Math.floor(e-s*l/o+u)),Math.min(t,Math.floor(e+(o-s)*l/o+u)),i)}var c=r[e],h=n,p=t;for(St(r,n,e),i(r[t],c)>0&&St(r,n,t);p>h;){for(St(r,h,p),h++,p--;0>i(r[h],c);)h++;for(;i(r[p],c)>0;)p--}i(r[n],c)===0?St(r,n,p):St(r,++p,t),p>e||(n=p+1),e>p||(t=p-1)}}function St(r,e,n){var t=r[e];r[e]=r[n],r[n]=t}function ai(r,e){return e>r?-1:r>e?1:0}function li(r,e,n){if(!n)return e.indexOf(r);for(let t=0;e.length>t;t++)if(n(r,e[t]))return t;return-1}function bt(r,e){Pt(r,0,r.children.length,e,r)}function Pt(r,e,n,t,i){i||(i=wt(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(let o=e;n>o;o++){const s=r.children[o];Bt(i,r.leaf?t(s):s)}return i}function Bt(r,e){return r.minX=Math.min(r.minX,e.minX),r.minY=Math.min(r.minY,e.minY),r.maxX=Math.max(r.maxX,e.maxX),r.maxY=Math.max(r.maxY,e.maxY),r}function ui(r,e){return r.minX-e.minX}function ci(r,e){return r.minY-e.minY}function fe(r){return(r.maxX-r.minX)*(r.maxY-r.minY)}function Yt(r){return r.maxX-r.minX+(r.maxY-r.minY)}function hi(r,e){const n=Math.max(r.minX,e.minX),t=Math.max(r.minY,e.minY),i=Math.min(r.maxX,e.maxX),o=Math.min(r.maxY,e.maxY);return Math.max(0,i-n)*Math.max(0,o-t)}function ge(r,e){return!(r.minX>e.minX||r.minY>e.minY||e.maxX>r.maxX||e.maxY>r.maxY)}function Jt(r,e){return!(e.minX>r.maxX||e.minY>r.maxY||r.minX>e.maxX||r.minY>e.maxY)}function wt(r){return{children:r,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function ln(r,e,n,t,i){const o=[e,n];for(;o.length;){if(t>=(n=o.pop())-(e=o.pop()))continue;const s=e+Math.ceil((n-e)/t/2)*t;si(r,s,e,n,i),o.push(e,s,s,n)}}var pi=Object.freeze({__proto__:null,default:class{constructor(r=9){this._maxEntries=Math.max(4,r),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}all(){return this._all(this.data,[])}search(r){let e=this.data;const n=[];if(!Jt(r,e))return n;const t=this.toBBox,i=[];for(;e;){for(let o=0;e.children.length>o;o++){const s=e.children[o],a=e.leaf?t(s):s;Jt(r,a)&&(e.leaf?n.push(s):ge(r,a)?this._all(s,n):i.push(s))}e=i.pop()}return n}collides(r){let e=this.data;if(!Jt(r,e))return!1;const n=[];for(;e;){for(let t=0;e.children.length>t;t++){const i=e.children[t],o=e.leaf?this.toBBox(i):i;if(Jt(r,o)){if(e.leaf||ge(r,o))return!0;n.push(i)}}e=n.pop()}return!1}load(r){if(!r||!r.length)return this;if(this._minEntries>r.length){for(let n=0;r.length>n;n++)this.insert(r[n]);return this}let e=this._build(r.slice(),0,r.length-1,0);if(this.data.children.length)if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(e.height>this.data.height){const n=this.data;this.data=e,e=n}this._insert(e,this.data.height-e.height-1,!0)}else this.data=e;return this}insert(r){return r&&this._insert(r,this.data.height-1),this}clear(){return this.data=wt([]),this}remove(r,e){if(!r)return this;let n=this.data;const t=this.toBBox(r),i=[],o=[];let s,a,l;for(;n||i.length;){if(n||(n=i.pop(),a=i[i.length-1],s=o.pop(),l=!0),n.leaf){const u=li(r,n.children,e);if(u!==-1)return n.children.splice(u,1),i.push(n),this._condense(i),this}l||n.leaf||!ge(n,t)?a?(s++,n=a.children[s],l=!1):n=null:(i.push(n),o.push(s),s=0,a=n,n=n.children[0])}return this}toBBox(r){return r}compareMinX(r,e){return r.minX-e.minX}compareMinY(r,e){return r.minY-e.minY}toJSON(){return this.data}fromJSON(r){return this.data=r,this}_all(r,e){const n=[];for(;r;)r.leaf?e.push(...r.children):n.push(...r.children),r=n.pop();return e}_build(r,e,n,t){const i=n-e+1;let o,s=this._maxEntries;if(s>=i)return o=wt(r.slice(e,n+1)),bt(o,this.toBBox),o;t||(s=Math.ceil(i/Math.pow(s,(t=Math.ceil(Math.log(i)/Math.log(s)))-1))),o=wt([]),o.leaf=!1,o.height=t;const a=Math.ceil(i/s),l=a*Math.ceil(Math.sqrt(s));ln(r,e,n,l,this.compareMinX);for(let u=e;n>=u;u+=l){const c=Math.min(u+l-1,n);ln(r,u,c,a,this.compareMinY);for(let h=u;c>=h;h+=a)o.children.push(this._build(r,h,Math.min(h+a-1,c),t-1))}return bt(o,this.toBBox),o}_chooseSubtree(r,e,n,t){for(;t.push(e),!e.leaf&&t.length-1!==n;){let s,a=1/0,l=1/0;for(let u=0;e.children.length>u;u++){const c=e.children[u],h=fe(c),p=(Math.max((o=c).maxX,(i=r).maxX)-Math.min(o.minX,i.minX))*(Math.max(o.maxY,i.maxY)-Math.min(o.minY,i.minY))-h;l>p?(l=p,a=a>h?h:a,s=c):p===l&&a>h&&(a=h,s=c)}e=s||e.children[0]}var i,o;return e}_insert(r,e,n){const t=n?r:this.toBBox(r),i=[],o=this._chooseSubtree(t,this.data,e,i);for(o.children.push(r),Bt(o,t);e>=0&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(t,i,e)}_split(r,e){const n=r[e],t=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,t);const o=this._chooseSplitIndex(n,i,t),s=wt(n.children.splice(o,n.children.length-o));s.height=n.height,s.leaf=n.leaf,bt(n,this.toBBox),bt(s,this.toBBox),e?r[e-1].children.push(s):this._splitRoot(n,s)}_splitRoot(r,e){this.data=wt([r,e]),this.data.height=r.height+1,this.data.leaf=!1,bt(this.data,this.toBBox)}_chooseSplitIndex(r,e,n){let t,i=1/0,o=1/0;for(let s=e;n-e>=s;s++){const a=Pt(r,0,s,this.toBBox),l=Pt(r,s,n,this.toBBox),u=hi(a,l),c=fe(a)+fe(l);i>u?(i=u,t=s,o=o>c?c:o):u===i&&o>c&&(o=c,t=s)}return t||n-e}_chooseSplitAxis(r,e,n){const t=r.leaf?this.compareMinX:ui,i=r.leaf?this.compareMinY:ci,o=this._allDistMargin(r,e,n,t);this._allDistMargin(r,e,n,i)>o&&r.children.sort(t)}_allDistMargin(r,e,n,t){r.children.sort(t);const i=this.toBBox,o=Pt(r,0,e,i),s=Pt(r,n-e,n,i);let a=Yt(o)+Yt(s);for(let l=e;n-e>l;l++){const u=r.children[l];Bt(o,r.leaf?i(u):u),a+=Yt(o)}for(let l=n-e-1;l>=e;l--){const u=r.children[l];Bt(s,r.leaf?i(u):u),a+=Yt(s)}return a}_adjustParentBBoxes(r,e,n){for(let t=n;t>=0;t--)Bt(e[t],r)}_condense(r){for(let e,n=r.length-1;n>=0;n--)r[n].children.length===0?n>0?(e=r[n-1].children,e.splice(e.indexOf(r[n]),1)):this.clear():bt(r[n],this.toBBox)}}}),nt=Ut(pi),vi=Ut(ii),fi=Ut(ri),Et=Ut(oi).default,gi=fi.featureEach,un=vi.featureCollection;function cn(r){var e=new nt(r);return e.insert=function(n){if(n.type!=="Feature")throw Error("invalid feature");return n.bbox=n.bbox?n.bbox:Et(n),nt.prototype.insert.call(this,n)},e.load=function(n){var t=[];return Array.isArray(n)?n.forEach(function(i){if(i.type!=="Feature")throw Error("invalid features");i.bbox=i.bbox?i.bbox:Et(i),t.push(i)}):gi(n,function(i){if(i.type!=="Feature")throw Error("invalid features");i.bbox=i.bbox?i.bbox:Et(i),t.push(i)}),nt.prototype.load.call(this,t)},e.remove=function(n,t){if(n.type!=="Feature")throw Error("invalid feature");return n.bbox=n.bbox?n.bbox:Et(n),nt.prototype.remove.call(this,n,t)},e.clear=function(){return nt.prototype.clear.call(this)},e.search=function(n){var t=nt.prototype.search.call(this,this.toBBox(n));return un(t)},e.collides=function(n){return nt.prototype.collides.call(this,this.toBBox(n))},e.all=function(){var n=nt.prototype.all.call(this);return un(n)},e.toJSON=function(){return nt.prototype.toJSON.call(this)},e.fromJSON=function(n){return nt.prototype.fromJSON.call(this,n)},e.toBBox=function(n){var t;if(n.bbox)t=n.bbox;else if(Array.isArray(n)&&n.length===4)t=n;else if(Array.isArray(n)&&n.length===6)t=[n[0],n[1],n[3],n[4]];else if(n.type==="Feature")t=Et(n);else{if(n.type!=="FeatureCollection")throw Error("invalid geojson");t=Et(n)}return{minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]}},e}var Xt=cn;function kt(r,e){var n={},t=[];if(r.type==="LineString"&&(r=U(r)),e.type==="LineString"&&(e=U(e)),r.type==="Feature"&&e.type==="Feature"&&r.geometry!==null&&e.geometry!==null&&r.geometry.type==="LineString"&&e.geometry.type==="LineString"&&r.geometry.coordinates.length===2&&e.geometry.coordinates.length===2){var i=hn(r,e);return i&&t.push(i),V(t)}var o=Xt();return o.load(ve(e)),yt(ve(r),function(s){yt(o.search(s),function(a){var l=hn(s,a);if(l){var u=Q(l).join(",");n[u]||(n[u]=!0,t.push(l))}})}),V(t)}function hn(r,e){var n=Q(r),t=Q(e);if(n.length!==2)throw Error("<intersects> line1 must only contain 2 coordinates");if(t.length!==2)throw Error("<intersects> line2 must only contain 2 coordinates");var i=n[0][0],o=n[0][1],s=n[1][0],a=n[1][1],l=t[0][0],u=t[0][1],c=t[1][0],h=t[1][1],p=(h-u)*(s-i)-(c-l)*(a-o),f=(c-l)*(o-u)-(h-u)*(i-l),v=(s-i)*(o-u)-(a-o)*(i-l);if(p===0)return null;var g=f/p,d=v/p;return 0>g||g>1||0>d||d>1?null:G([i+g*(s-i),o+g*(a-o)])}function pn(r,e,n){n===void 0&&(n={});var t=G([1/0,1/0],{dist:1/0}),i=0;return tt(r,function(o){for(var s=Q(o),a=0;s.length-1>a;a++){var l=G(s[a]);l.properties.dist=H(e,l,n);var u=G(s[a+1]);u.properties.dist=H(e,u,n);var c=H(l,u,n),h=Math.max(l.properties.dist,u.properties.dist),p=pe(l,u),f=he(e,h,p+90,n),v=he(e,h,p-90,n),g=kt(R([f.geometry.coordinates,v.geometry.coordinates]),R([l.geometry.coordinates,u.geometry.coordinates])),d=null;g.features.length>0&&((d=g.features[0]).properties.dist=H(e,d,n),d.properties.location=i+H(l,d,n)),t.properties.dist>l.properties.dist&&((t=l).properties.index=a,t.properties.location=i),t.properties.dist>u.properties.dist&&((t=u).properties.index=a+1,t.properties.location=i+c),d&&t.properties.dist>d.properties.dist&&((t=d).properties.index=a),i+=c}}),t}function vn(r,e,n){n===void 0&&(n={});var t=F(r),i=F(e);i[0]+=i[0]-t[0]>180?-360:t[0]-i[0]>180?360:0;var o=function(s,a,l){var u=l=l===void 0?D:Number(l),c=s[1]*Math.PI/180,h=a[1]*Math.PI/180,p=h-c,f=Math.abs(a[0]-s[0])*Math.PI/180;f>Math.PI&&(f-=2*Math.PI);var v=Math.log(Math.tan(h/2+Math.PI/4)/Math.tan(c/2+Math.PI/4)),g=Math.abs(v)>1e-11?p/v:Math.cos(c);return Math.sqrt(p*p+g*g*f*f)*u}(t,i);return jt(o,"meters",n.units)}function di(r,e,n){if(n===void 0&&(n={}),n.method||(n.method="geodesic"),n.units||(n.units="kilometers"),!r)throw Error("pt is required");if(Array.isArray(r)?r=G(r):r.type==="Point"?r=U(r):tn(r,"Point","point"),!e)throw Error("line is required");Array.isArray(e)?e=R(e):e.type==="LineString"?e=U(e):tn(e,"LineString","line");var t=1/0,i=r.geometry.coordinates;return le(e,function(o){var s=function(a,l,u,c){var h=[u[0]-l[0],u[1]-l[1]],p=[a[0]-l[0],a[1]-l[1]],f=fn(p,h);if(0>=f)return de(a,l,{method:c.method,units:"degrees"});var v=fn(h,h);if(f>=v)return de(a,u,{method:c.method,units:"degrees"});var g=f/v,d=[l[0]+g*h[0],l[1]+g*h[1]];return de(a,d,{method:c.method,units:"degrees"})}(i,o.geometry.coordinates[0],o.geometry.coordinates[1],n);t>s&&(t=s)}),jt(t,"degrees",n.units)}function fn(r,e){return r[0]*e[0]+r[1]*e[1]}function de(r,e,n){return n.method==="planar"?vn(r,e,n):H(r,e,n)}Xt.default=cn;var gn=6378137;function mi(r){return Ze(r,function(e,n){return e+function(t){var i,o=0;switch(t.type){case"Polygon":return dn(t.coordinates);case"MultiPolygon":for(i=0;t.coordinates.length>i;i++)o+=dn(t.coordinates[i]);return o;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(n)},0)}function dn(r){var e=0;if(r&&r.length>0){e+=Math.abs(mn(r[0]));for(var n=1;r.length>n;n++)e-=Math.abs(mn(r[n]))}return e}function mn(r){var e,n,t,i,o,s,a=0,l=r.length;if(l>2){for(s=0;l>s;s++)s===l-2?(t=l-2,i=l-1,o=0):s===l-1?(t=l-1,i=0,o=1):(t=s,i=s+1,o=s+2),e=r[t],n=r[i],a+=(me(r[o][0])-me(e[0]))*Math.sin(me(n[1]));a=a*gn*gn/2}return a}function me(r){return r*Math.PI/180}function Mt(r,e,n){n===void 0&&(n={});for(var t=F(r),i=Q(e),o=0;i.length-1>o;o++){var s=!1;if(n.ignoreEndVertices&&(o===0&&(s="start"),o===i.length-2&&(s="end"),o===0&&o+1===i.length-1&&(s="both")),yi(i[o],i[o+1],t,s,n.epsilon===void 0?null:n.epsilon))return!0}return!1}function yi(r,e,n,t,i){var o=n[0],s=n[1],a=r[0],l=r[1],u=e[0],c=e[1],h=u-a,p=c-l,f=(n[0]-a)*p-(n[1]-l)*h;if(i!==null){if(Math.abs(f)>i)return!1}else if(f!==0)return!1;return t?t==="start"?Math.abs(p)>Math.abs(h)?p>0?s>l&&c>=s:s>=c&&l>s:h>0?o>a&&u>=o:o>=u&&a>o:t==="end"?Math.abs(p)>Math.abs(h)?p>0?s>=l&&c>s:s>c&&l>=s:h>0?o>=a&&u>o:o>u&&a>=o:t==="both"&&(Math.abs(p)>Math.abs(h)?p>0?s>l&&c>s:s>c&&l>s:h>0?o>a&&u>o:o>u&&a>o):Math.abs(p)>Math.abs(h)?p>0?s>=l&&c>=s:s>=c&&l>=s:h>0?o>=a&&u>=o:o>=u&&a>=o}function bi(r,e){e===void 0&&(e={});var n=e.precision,t=e.coordinates,i=e.mutate;if(n=n==null||isNaN(n)?6:n,t=t==null||isNaN(t)?3:t,!r)throw Error("<geojson> is required");if(typeof n!="number")throw Error("<precision> must be a number");if(typeof t!="number")throw Error("<coordinates> must be a number");i!==!1&&i!==void 0||(r=JSON.parse(JSON.stringify(r)));var o=Math.pow(10,n);return rt(r,function(s){(function(a,l,u){a.length>u&&a.splice(u,a.length);for(var c=0;a.length>c;c++)a[c]=Math.round(a[c]*l)/l})(s,o,t)}),r}function yn(r,e){var n=[],t=Xt();return tt(e,function(i){if(n.forEach(function(a,l){a.id=l}),n.length){var o=t.search(i);if(o.features.length){var s=bn(i,o);n=n.filter(function(a){return a.id!==s.id}),t.remove(s),yt(ye(s,i),function(a){n.push(a),t.insert(a)})}}else(n=ye(r,i).features).forEach(function(a){a.bbox||(a.bbox=function(l){var u=l[0],c=l[1],h=l[2],p=l[3],f=H(l.slice(0,2),[h,c]);if(H(l.slice(0,2),[u,p])>f){var v=(u+h)/2;return[v-(p-c)/2,c,v+(p-c)/2,p]}var g=(c+p)/2;return[u,g-(h-u)/2,h,g+(h-u)/2]}(ot(a)))}),t.load(V(n))}),V(n)}function ye(r,e){var n=[],t=Q(r)[0],i=Q(r)[r.geometry.coordinates.length-1];if(be(t,F(e))||be(i,F(e)))return V([r]);var o=Xt(),s=ve(r);o.load(s);var a=o.search(e);if(!a.features.length)return V([r]);var l=bn(e,a),u=He(s,function(c,h,p){var f=Q(h)[1],v=F(e);return p===l.id?(c.push(v),n.push(R(c)),be(v,f)?[v]:[v,f]):(c.push(f),c)},[t]);return u.length>1&&n.push(R(u)),V(n)}function bn(r,e){if(!e.features.length)throw Error("lines must contain features");if(e.features.length===1)return e.features[0];var n,t=1/0;return yt(e,function(i){var o=pn(i,r).properties.dist;t>o&&(n=i,t=o)}),n}function be(r,e){return r[0]===e[0]&&r[1]===e[1]}function we(r,e){e===void 0&&(e={});var n=K(r);switch(e.properties||r.type!=="Feature"||(e.properties=r.properties),n.type){case"Polygon":return function(t,i){i===void 0&&(i={});var o=K(t),s=o.coordinates,a=i.properties?i.properties:t.type==="Feature"?t.properties:{};return wn(s,a)}(n,e);case"MultiPolygon":return function(t,i){i===void 0&&(i={});var o=K(t),s=o.coordinates,a=i.properties?i.properties:t.type==="Feature"?t.properties:{},l=[];return s.forEach(function(u){l.push(wn(u,a))}),V(l)}(n,e);default:throw Error("invalid poly")}}function wn(r,e){return r.length>1?Ft(r,e):R(r[0],e)}function wi(r,e){var n,t,i;e===void 0&&(e={});var o=e.properties,s=(n=e.autoComplete)===null||n===void 0||n,a=(t=e.orderCoords)===null||t===void 0||t;if((i=e.mutate)!==null&&i!==void 0&&i||(r=nn(r)),r.type==="FeatureCollection"){var l=[];return r.features.forEach(function(u){l.push(Q(En(u,{},s,a)))}),Ot(l,o)}return En(r,o,s,a)}function En(r,e,n,t){e=e||(r.type==="Feature"?r.properties:{});var i=K(r),o=i.coordinates,s=i.type;if(!o.length)throw Error("line must contain coordinates");switch(s){case"LineString":return n&&(o=kn(o)),gt([o],e);case"MultiLineString":var a=[],l=0;return o.forEach(function(u){if(n&&(u=kn(u)),t){var c=function(h){var p=h[0],f=h[1],v=h[2],g=h[3];return Math.abs(p-v)*Math.abs(f-g)}(ot(R(u)));c>l?(a.unshift(u),l=c):a.push(u)}else a.push(u)}),gt(a,e);default:throw Error("geometry type "+s+" is not supported")}}function kn(r){var e=r[0],n=r[r.length-1];return e[0]===n[0]&&e[1]===n[1]||r.push(e),r}function Mn(r,e){var n=T(r[1]),t=T(e[1]),i=T(e[0]-r[0]);return i>Math.PI&&(i-=2*Math.PI),-Math.PI>i&&(i+=2*Math.PI),(mt(Math.atan2(i,Math.log(Math.tan(t/2+Math.PI/4)/Math.tan(n/2+Math.PI/4))))+360)%360}function Ei(r,e,n,t){t===void 0&&(t={});var i=0>e,o=jt(Math.abs(e),t.units,"meters");i&&(o=-Math.abs(o));var s=F(r),a=function(l,u,c,h){h=h===void 0?D:Number(h);var p=u/h,f=l[0]*Math.PI/180,v=T(l[1]),g=T(c),d=p*Math.cos(g),y=v+d;Math.abs(y)>Math.PI/2&&(y=y>0?Math.PI-y:-Math.PI-y);var w=Math.log(Math.tan(y/2+Math.PI/4)/Math.tan(v/2+Math.PI/4)),b=Math.abs(w)>1e-11?d/w:Math.cos(v);return[(180*(f+p*Math.sin(g)/b)/Math.PI+540)%360-180,180*y/Math.PI]}(s,o,n);return a[0]+=a[0]-s[0]>180?-360:s[0]-a[0]>180?360:0,G(a,t.properties)}function Vt(r){var e=r[0],n=r[1];return[n[0]-e[0],n[1]-e[1]]}function Ee(r,e){return r[0]*e[1]-e[0]*r[1]}function ki(r,e){return!function(n,t){return Ee(Vt(n),Vt(t))===0}(r,e)&&function(n,t){var i,o,s=n[0],a=Vt(n),l=t[0],u=Vt(t),c=Ee(a,u),h=function(p,f){return[p[0]+f[0],p[1]+f[1]]}(s,function(p,f){return[p*f[0],p*f[1]]}(Ee([(i=l)[0]-(o=s)[0],i[1]-o[1]],u)/c,a));return h}(r,e)}function Ln(r,e,n){if(!At(n=n||{}))throw Error("options is invalid");var t=n.units;if(!r)throw Error("geojson is required");if(e==null||isNaN(e))throw Error("distance is required");var i=ue(r),o=r.properties;switch(i){case"LineString":return xn(r,e,t);case"MultiLineString":var s=[];return tt(r,function(a){s.push(xn(a,e,t).geometry.coordinates)}),Ft(s,o);default:throw Error("geometry "+i+" is not supported")}}function xn(r,e,n){var t=[],i=Qe(e,n),o=Q(r),s=[];return o.forEach(function(a,l){if(l!==o.length-1){var u=[[(p=a)[0]+(v=i)*((f=o[l+1])[1]-p[1])/(g=Math.sqrt((p[0]-f[0])*(p[0]-f[0])+(p[1]-f[1])*(p[1]-f[1]))),p[1]+v*(p[0]-f[0])/g],[f[0]+v*(f[1]-p[1])/g,f[1]+v*(p[0]-f[0])/g]];if(t.push(u),l>0){var c=t[l-1],h=ki(u,c);h!==!1&&(c[1]=h,u[0]=h),s.push(c[0]),l===o.length-2&&(s.push(u[0]),s.push(u[1]))}o.length===2&&(s.push(u[0]),s.push(u[1]))}var p,f,v,g}),R(s,r.properties)}function ke(r,e){var n=!0;return tt(r,function(t){tt(e,function(i){if(n===!1)return!1;n=function(o,s){switch(o.type){case"Point":switch(s.type){case"Point":return!((a=o.coordinates)[0]===(l=s.coordinates)[0]&&a[1]===l[1]);case"LineString":return!On(s,o);case"Polygon":return!et(o,s)}break;case"LineString":switch(s.type){case"Point":return!On(o,s);case"LineString":return!function(u,c){return kt(u,c).features.length>0}(o,s);case"Polygon":return!An(s,o)}break;case"Polygon":switch(s.type){case"Point":return!et(s,o);case"LineString":return!An(o,s);case"Polygon":return!function(u,c){for(var h=0,p=u.coordinates[0];p.length>h;h++)if(et(p[h],c))return!0;for(var f=0,v=c.coordinates[0];v.length>f;f++)if(et(v[f],u))return!0;var g=kt(we(u),we(c));return g.features.length>0}(s,o)}}var a,l;return!1}(t.geometry,i.geometry)})}),n}function On(r,e){for(var n=0;r.coordinates.length-1>n;n++)if(Mi(r.coordinates[n],r.coordinates[n+1],e.coordinates))return!0;return!1}function An(r,e){for(var n=0,t=e.coordinates;t.length>n;n++)if(et(t[n],r))return!0;return kt(e,we(r)).features.length>0}function Mi(r,e,n){var t=e[0]-r[0],i=e[1]-r[1];return(n[0]-r[0])*i-(n[1]-r[1])*t==0&&(Math.abs(i)>Math.abs(t)?i>0?n[1]>=r[1]&&e[1]>=n[1]:n[1]>=e[1]&&r[1]>=n[1]:t>0?n[0]>=r[0]&&e[0]>=n[0]:n[0]>=e[0]&&r[0]>=n[0])}function Li(r,e){var n=K(r),t=K(e),i=n.type,o=t.type,s=n.coordinates,a=t.coordinates;switch(i){case"Point":if(o==="Point")return Me(s,a);throw Error("feature2 "+o+" geometry not supported");case"MultiPoint":switch(o){case"Point":return function(l,u){var c,h=!1;for(c=0;l.coordinates.length>c;c++)if(Me(l.coordinates[c],u.coordinates)){h=!0;break}return h}(n,t);case"MultiPoint":return function(l,u){for(var c=0,h=u.coordinates;h.length>c;c++){for(var p=h[c],f=!1,v=0,g=l.coordinates;g.length>v;v++)if(Me(p,g[v])){f=!0;break}if(!f)return!1}return!0}(n,t);default:throw Error("feature2 "+o+" geometry not supported")}case"LineString":switch(o){case"Point":return Mt(t,n,{ignoreEndVertices:!0});case"LineString":return function(l,u){for(var c=!1,h=0,p=u.coordinates;p.length>h;h++){var f=p[h];if(Mt({type:"Point",coordinates:f},l,{ignoreEndVertices:!0})&&(c=!0),!Mt({type:"Point",coordinates:f},l,{ignoreEndVertices:!1}))return!1}return c}(n,t);case"MultiPoint":return function(l,u){for(var c=!1,h=0,p=u.coordinates;p.length>h;h++){var f=p[h];if(Mt(f,l,{ignoreEndVertices:!0})&&(c=!0),!Mt(f,l))return!1}return!!c}(n,t);default:throw Error("feature2 "+o+" geometry not supported")}case"Polygon":switch(o){case"Point":return et(t,n,{ignoreBoundary:!0});case"LineString":return function(l,u){var c=!1,h=0,p=ot(l),f=ot(u);if(!Sn(p,f))return!1;for(;u.coordinates.length-1>h;h++)if(et({type:"Point",coordinates:xi(u.coordinates[h],u.coordinates[h+1])},l,{ignoreBoundary:!0})){c=!0;break}return c}(n,t);case"Polygon":return function(l,u){if(l.type==="Feature"&&l.geometry===null||u.type==="Feature"&&u.geometry===null)return!1;var c=ot(l),h=ot(u);if(!Sn(c,h))return!1;for(var p=K(u).coordinates,f=0,v=p;v.length>f;f++)for(var g=0,d=v[f];d.length>g;g++)if(!et(d[g],l))return!1;return!0}(n,t);case"MultiPoint":return function(l,u){for(var c=0,h=u.coordinates;h.length>c;c++)if(!et(h[c],l,{ignoreBoundary:!0}))return!1;return!0}(n,t);default:throw Error("feature2 "+o+" geometry not supported")}default:throw Error("feature1 "+i+" geometry not supported")}}function Sn(r,e){return e[0]>=r[0]&&r[2]>=e[2]&&e[1]>=r[1]&&e[3]<=r[3]}function Me(r,e){return r[0]===e[0]&&r[1]===e[1]}function xi(r,e){return[(r[0]+e[0])/2,(r[1]+e[1])/2]}/**
   * splaytree v3.1.2
   * Fast Splay tree for Node and browser
   *
   * @author Alexander Milevski <info@w8r.name>
   * @license MIT
   * @preserve
   *//*! *****************************************************************************
	  Copyright (c) Microsoft Corporation. All rights reserved.
	  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
	  this file except in compliance with the License. You may obtain a copy of the
	  License at http://www.apache.org/licenses/LICENSE-2.0

	  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
	  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
	  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
	  MERCHANTABLITY OR NON-INFRINGEMENT.

	  See the Apache Version 2.0 License for specific language governing permissions
	  and limitations under the License.
	  ***************************************************************************** */function Oi(r,e){var n,t,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,t&&(i=2&c[0]?t.return:c[0]?t.throw||((i=t.return)&&i.call(t),0):t.next)&&!(i=i.call(t,c[1])).done)return i;switch(t=0,i&&(c=[2&c[0],i.value]),c[0]){case 0:case 1:i=c;break;case 4:return s.label++,{value:c[1],done:!1};case 5:s.label++,t=c[1],c=[0];continue;case 7:c=s.ops.pop(),s.trys.pop();continue;default:if(i=s.trys,!((i=i.length>0&&i[i.length-1])||c[0]!==6&&c[0]!==2)){s=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&i[3]>c[1])){s.label=c[1];break}if(c[0]===6&&i[1]>s.label){s.label=i[1],i=c;break}if(i&&i[2]>s.label){s.label=i[2],s.ops.push(c);break}i[2]&&s.ops.pop(),s.trys.pop();continue}c=e.call(r,s)}catch(h){c=[6,h],t=0}finally{n=i=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([l,u])}}}var ut=function(r,e){this.next=null,this.key=r,this.data=e,this.left=null,this.right=null};function Ai(r,e){return r>e?1:e>r?-1:0}function ct(r,e,n){for(var t=new ut(null,null),i=t,o=t;;){var s=n(r,e.key);if(0>s){if(e.left===null||0>n(r,e.left.key)&&(e.left=(a=e.left).right,a.right=e,(e=a).left===null))break;o.left=e,o=e,e=e.left}else{if(0>=s||e.right===null)break;var a;if(n(r,e.right.key)>0&&(e.right=(a=e.right).left,a.left=e,(e=a).right===null))break;i.right=e,i=e,e=e.right}}return i.right=e.left,o.left=e.right,e.left=t.right,e.right=t.left,e}function Le(r,e,n,t){var i=new ut(r,e);if(n===null)return i.left=i.right=null,i;var o=t(r,(n=ct(r,n,t)).key);return 0>o?(i.left=n.left,i.right=n,n.left=null):0>o||(i.right=n.right,i.left=n,n.right=null),i}function Pn(r,e,n){var t=null,i=null;if(e){var o=n((e=ct(r,e,n)).key,r);o===0?(t=e.left,i=e.right):0>o?(i=e.right,e.right=null,t=e):(t=e.left,e.left=null,i=e)}return{left:t,right:i}}function xe(r,e,n,t,i){if(r){t(e+(n?"└── ":"├── ")+i(r)+`
`);var o=e+(n?"    ":"│   ");r.left&&xe(r.left,o,!1,t,i),r.right&&xe(r.right,o,!0,t,i)}}var Oe=function(){function r(e){e===void 0&&(e=Ai),this._root=null,this._size=0,this._comparator=e}return r.prototype.insert=function(e,n){return this._size++,this._root=Le(e,n,this._root,this._comparator)},r.prototype.add=function(e,n){var t=new ut(e,n);this._root===null&&(t.left=t.right=null,this._size++,this._root=t);var i=this._comparator,o=ct(e,this._root,i),s=i(e,o.key);return s===0?this._root=o:(0>s?(t.left=o.left,t.right=o,o.left=null):s>0&&(t.right=o.right,t.left=o,o.right=null),this._size++,this._root=t),this._root},r.prototype.remove=function(e){this._root=this._remove(e,this._root,this._comparator)},r.prototype._remove=function(e,n,t){var i;return n===null?null:t(e,(n=ct(e,n,t)).key)===0?(n.left===null?i=n.right:(i=ct(e,n.left,t)).right=n.right,this._size--,i):n},r.prototype.pop=function(){var e=this._root;if(e){for(;e.left;)e=e.left;return this._root=ct(e.key,this._root,this._comparator),this._root=this._remove(e.key,this._root,this._comparator),{key:e.key,data:e.data}}return null},r.prototype.findStatic=function(e){for(var n=this._root,t=this._comparator;n;){var i=t(e,n.key);if(i===0)return n;n=0>i?n.left:n.right}return null},r.prototype.find=function(e){return this._root&&(this._root=ct(e,this._root,this._comparator),this._comparator(e,this._root.key)!==0)?null:this._root},r.prototype.contains=function(e){for(var n=this._root,t=this._comparator;n;){var i=t(e,n.key);if(i===0)return!0;n=0>i?n.left:n.right}return!1},r.prototype.forEach=function(e,n){for(var t=this._root,i=[],o=!1;!o;)t!==null?(i.push(t),t=t.left):i.length!==0?(t=i.pop(),e.call(n,t),t=t.right):o=!0;return this},r.prototype.range=function(e,n,t,i){for(var o=[],s=this._comparator,a=this._root;o.length!==0||a;)if(a)o.push(a),a=a.left;else{if(s((a=o.pop()).key,n)>0)break;if(s(a.key,e)>=0&&t.call(i,a))return this;a=a.right}return this},r.prototype.keys=function(){var e=[];return this.forEach(function(n){return e.push(n.key)}),e},r.prototype.values=function(){var e=[];return this.forEach(function(n){return e.push(n.data)}),e},r.prototype.min=function(){return this._root?this.minNode(this._root).key:null},r.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},r.prototype.minNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.left;)e=e.left;return e},r.prototype.maxNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.right;)e=e.right;return e},r.prototype.at=function(e){for(var n=this._root,t=!1,i=0,o=[];!t;)if(n)o.push(n),n=n.left;else if(o.length>0){if(n=o.pop(),i===e)return n;i++,n=n.right}else t=!0;return null},r.prototype.next=function(e){var n=this._root,t=null;if(e.right){for(t=e.right;t.left;)t=t.left;return t}for(var i=this._comparator;n;){var o=i(e.key,n.key);if(o===0)break;0>o?(t=n,n=n.left):n=n.right}return t},r.prototype.prev=function(e){var n=this._root,t=null;if(e.left!==null){for(t=e.left;t.right;)t=t.right;return t}for(var i=this._comparator;n;){var o=i(e.key,n.key);if(o===0)break;0>o?n=n.left:(t=n,n=n.right)}return t},r.prototype.clear=function(){return this._root=null,this._size=0,this},r.prototype.toList=function(){return function(e){for(var n=e,t=[],i=!1,o=new ut(null,null),s=o;!i;)n?(t.push(n),n=n.left):t.length>0?n=(n=s=s.next=t.pop()).right:i=!0;return s.next=null,o.next}(this._root)},r.prototype.load=function(e,n,t){n===void 0&&(n=[]),t===void 0&&(t=!1);var i=e.length,o=this._comparator;if(t&&Pe(e,n,0,i-1,o),this._root===null)this._root=Ae(e,n,0,i),this._size=i;else{var s=function(a,l,u){for(var c=new ut(null,null),h=c,p=a,f=l;p!==null&&f!==null;)0>u(p.key,f.key)?(h.next=p,p=p.next):(h.next=f,f=f.next),h=h.next;return p!==null?h.next=p:f!==null&&(h.next=f),c.next}(this.toList(),function(a,l){for(var u=new ut(null,null),c=u,h=0;a.length>h;h++)c=c.next=new ut(a[h],l[h]);return c.next=null,u.next}(e,n),o);this._root=Se({head:s},0,i=this._size+i)}return this},r.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(r.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),r.prototype.toString=function(e){e===void 0&&(e=function(t){return t.key+""});var n=[];return xe(this._root,"",!0,function(t){return n.push(t)},e),n.join("")},r.prototype.update=function(e,n,t){var i=this._comparator,o=Pn(e,this._root,i),s=o.left,a=o.right;0>i(e,n)?a=Le(n,t,a,i):s=Le(n,t,s,i),this._root=function(l,u,c){return u===null?l:(l===null||((u=ct(l.key,u,c)).left=l),u)}(s,a,i)},r.prototype.split=function(e){return Pn(e,this._root,this._comparator)},r.prototype[Symbol.iterator]=function(){var e,n,t;return Oi(this,function(i){switch(i.label){case 0:e=this._root,n=[],t=!1,i.label=1;case 1:return t?[3,6]:e===null?[3,2]:(n.push(e),e=e.left,[3,5]);case 2:return n.length===0?[3,4]:[4,e=n.pop()];case 3:return i.sent(),e=e.right,[3,5];case 4:t=!0,i.label=5;case 5:return[3,1];case 6:return[2]}})},r}();function Ae(r,e,n,t){var i=t-n;if(i>0){var o=n+Math.floor(i/2),s=new ut(r[o],e[o]);return s.left=Ae(r,e,n,o),s.right=Ae(r,e,o+1,t),s}return null}function Se(r,e,n){var t=n-e;if(t>0){var i=e+Math.floor(t/2),o=Se(r,e,i),s=r.head;return s.left=o,r.head=r.head.next,s.right=Se(r,i+1,n),s}return null}function Pe(r,e,n,t,i){if(t>n){for(var o=r[n+t>>1],s=n-1,a=t+1;;){do s++;while(0>i(r[s],o));do a--;while(i(r[a],o)>0);if(s>=a)break;var l=r[s];r[s]=r[a],r[a]=l,l=e[s],e[s]=e[a],e[a]=l}Pe(r,e,n,a,i),Pe(r,e,a+1,t,i)}}function Z(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function Bn(r,e){for(var n=0;e.length>n;n++){var t=e[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(r,t.key,t)}}function W(r,e,n){return e&&Bn(r.prototype,e),n&&Bn(r,n),r}var Gt=function(r,e){return!(r.ll.x>e.x||e.x>r.ur.x||r.ll.y>e.y||e.y>r.ur.y)},Be=function(r,e){return r.ll.x>e.ur.x||e.ll.x>r.ur.x||r.ll.y>e.ur.y||e.ll.y>r.ur.y?null:{ll:{x:e.ll.x>r.ll.x?e.ll.x:r.ll.x,y:e.ll.y>r.ll.y?e.ll.y:r.ll.y},ur:{x:e.ur.x>r.ur.x?r.ur.x:e.ur.x,y:e.ur.y>r.ur.y?r.ur.y:e.ur.y}}},ht=Number.EPSILON;ht===void 0&&(ht=Math.pow(2,-52));var Si=ht*ht,Ge=function(r,e){if(r>-ht&&ht>r&&e>-ht&&ht>e)return 0;var n=r-e;return Si*r*e>n*n?0:e>r?-1:1},Pi=function(){function r(){Z(this,r),this.reset()}return W(r,[{key:"reset",value:function(){this.xRounder=new Gn,this.yRounder=new Gn}},{key:"round",value:function(e,n){return{x:this.xRounder.round(e),y:this.yRounder.round(n)}}}]),r}(),Gn=function(){function r(){Z(this,r),this.tree=new Oe,this.round(0)}return W(r,[{key:"round",value:function(e){var n=this.tree.add(e),t=this.tree.prev(n);if(t!==null&&Ge(n.key,t.key)===0)return this.tree.remove(e),t.key;var i=this.tree.next(n);return i!==null&&Ge(n.key,i.key)===0?(this.tree.remove(e),i.key):e}}]),r}(),It=new Pi,Ct=function(r,e){return r.x*e.y-r.y*e.x},In=function(r,e){return r.x*e.x+r.y*e.y},Cn=function(r,e,n){var t=Ct({x:e.x-r.x,y:e.y-r.y},{x:n.x-r.x,y:n.y-r.y});return Ge(t,0)},Qt=function(r){return Math.sqrt(In(r,r))},Bi=function(r,e,n){var t={x:e.x-r.x,y:e.y-r.y},i={x:n.x-r.x,y:n.y-r.y};return In(i,t)/Qt(i)/Qt(t)},Rn=function(r,e,n){return e.y===0?null:{x:r.x+e.x/e.y*(n-r.y),y:n}},Nn=function(r,e,n){return e.x===0?null:{x:n,y:r.y+e.y/e.x*(n-r.x)}},it=function(){function r(e,n){Z(this,r),e.events===void 0?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=n}return W(r,null,[{key:"compare",value:function(e,n){var t=r.comparePoints(e.point,n.point);return t!==0?t:(e.point!==n.point&&e.link(n),e.isLeft!==n.isLeft?e.isLeft?1:-1:Kt.compare(e.segment,n.segment))}},{key:"comparePoints",value:function(e,n){return n.x>e.x?-1:e.x>n.x?1:n.y>e.y?-1:e.y>n.y?1:0}}]),W(r,[{key:"link",value:function(e){if(e.point===this.point)throw Error("Tried to link already linked events");for(var n=e.point.events,t=0,i=n.length;i>t;t++){var o=n[t];this.point.events.push(o),o.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var e=this.point.events.length,n=0;e>n;n++){var t=this.point.events[n];if(t.segment.consumedBy===void 0)for(var i=n+1;e>i;i++){var o=this.point.events[i];o.consumedBy===void 0&&t.otherSE.point.events===o.otherSE.point.events&&t.segment.consume(o.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var e=[],n=0,t=this.point.events.length;t>n;n++){var i=this.point.events[n];i!==this&&!i.segment.ringOut&&i.segment.isInResult()&&e.push(i)}return e}},{key:"getLeftmostComparator",value:function(e){var n=this,t=new Map,i=function(o){var s,a,l,u,c,h=o.otherSE;t.set(o,{sine:(s=n.point,a=e.point,l=h.point,u={x:a.x-s.x,y:a.y-s.y},c={x:l.x-s.x,y:l.y-s.y},Ct(c,u)/Qt(c)/Qt(u)),cosine:Bi(n.point,e.point,h.point)})};return function(o,s){t.has(o)||i(o),t.has(s)||i(s);var a=t.get(o),l=a.sine,u=a.cosine,c=t.get(s),h=c.sine,p=c.cosine;return 0>l||0>h?0>l&&0>h?p>u?-1:u>p?1:0:l>h?-1:h>l?1:0:p>u?1:u>p?-1:0}}}]),r}(),Gi=0,Kt=function(){function r(e,n,t,i){Z(this,r),this.id=++Gi,this.leftSE=e,e.segment=this,e.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=e,this.rings=t,this.windings=i}return W(r,null,[{key:"compare",value:function(e,n){var t=e.leftSE.point.x,i=n.leftSE.point.x,o=e.rightSE.point.x,s=n.rightSE.point.x;if(t>s)return 1;if(i>o)return-1;var a=e.leftSE.point.y,l=n.leftSE.point.y,u=e.rightSE.point.y,c=n.rightSE.point.y;if(i>t){if(a>l&&u>l)return 1;if(l>a&&l>u)return-1;var h=e.comparePoint(n.leftSE.point);if(0>h)return 1;if(h>0)return-1;var p=n.comparePoint(e.rightSE.point);return p!==0?p:-1}if(t>i){if(l>a&&c>a)return-1;if(a>l&&a>c)return 1;var f=n.comparePoint(e.leftSE.point);if(f!==0)return f;var v=e.comparePoint(n.rightSE.point);return 0>v?1:v>0?-1:1}if(l>a)return-1;if(a>l)return 1;if(s>o){var g=n.comparePoint(e.rightSE.point);if(g!==0)return g}if(o>s){var d=e.comparePoint(n.rightSE.point);if(0>d)return 1;if(d>0)return-1}if(o!==s){var y=u-a,w=o-t,b=c-l,E=s-i;if(y>w&&E>b)return 1;if(w>y&&b>E)return-1}return o>s?1:s>o||c>u?-1:u>c?1:n.id>e.id?-1:e.id>n.id?1:0}}]),W(r,[{key:"replaceRightSE",value:function(e){this.rightSE=e,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var e=this.leftSE.point.y,n=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:n>e?e:n},ur:{x:this.rightSE.point.x,y:e>n?e:n}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(e){return e.x===this.leftSE.point.x&&e.y===this.leftSE.point.y||e.x===this.rightSE.point.x&&e.y===this.rightSE.point.y}},{key:"comparePoint",value:function(e){if(this.isAnEndpoint(e))return 0;var n=this.leftSE.point,t=this.rightSE.point,i=this.vector();if(n.x===t.x)return e.x===n.x?0:n.x>e.x?1:-1;if(e.x===n.x+(e.y-n.y)/i.y*i.x)return 0;var o=n.y+(e.x-n.x)/i.x*i.y;return e.y===o?0:o>e.y?-1:1}},{key:"getIntersection",value:function(e){var n=this.bbox(),t=e.bbox(),i=Be(n,t);if(i===null)return null;var o=this.leftSE.point,s=this.rightSE.point,a=e.leftSE.point,l=e.rightSE.point,u=Gt(n,a)&&this.comparePoint(a)===0,c=Gt(t,o)&&e.comparePoint(o)===0,h=Gt(n,l)&&this.comparePoint(l)===0,p=Gt(t,s)&&e.comparePoint(s)===0;if(c&&u)return p&&!h?s:!p&&h?l:null;if(c)return h&&o.x===l.x&&o.y===l.y?null:o;if(u)return p&&s.x===a.x&&s.y===a.y?null:a;if(p&&h)return null;if(p)return s;if(h)return l;var f=function(v,g,d,y){if(g.x===0)return Nn(d,y,v.x);if(y.x===0)return Nn(v,g,d.x);if(g.y===0)return Rn(d,y,v.y);if(y.y===0)return Rn(v,g,d.y);var w=Ct(g,y);if(w==0)return null;var b={x:d.x-v.x,y:d.y-v.y},E=Ct(b,g)/w,O=Ct(b,y)/w;return{x:(v.x+O*g.x+(d.x+E*y.x))/2,y:(v.y+O*g.y+(d.y+E*y.y))/2}}(o,this.vector(),a,e.vector());return f===null?null:Gt(i,f)?It.round(f.x,f.y):null}},{key:"split",value:function(e){var n=[],t=e.events!==void 0,i=new it(e,!0),o=new it(e,!1),s=this.rightSE;this.replaceRightSE(o),n.push(o),n.push(i);var a=new r(i,s,this.rings.slice(),this.windings.slice());return it.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),it.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),t&&(i.checkForConsuming(),o.checkForConsuming()),n}},{key:"swapEvents",value:function(){var e=this.rightSE;this.rightSE=this.leftSE,this.leftSE=e,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var n=0,t=this.windings.length;t>n;n++)this.windings[n]*=-1}},{key:"consume",value:function(e){for(var n=this,t=e;n.consumedBy;)n=n.consumedBy;for(;t.consumedBy;)t=t.consumedBy;var i=r.compare(n,t);if(i!==0){if(i>0){var o=n;n=t,t=o}if(n.prev===t){var s=n;n=t,t=s}for(var a=0,l=t.rings.length;l>a;a++){var u=t.rings[a],c=t.windings[a],h=n.rings.indexOf(u);h===-1?(n.rings.push(u),n.windings.push(c)):n.windings[h]+=c}t.rings=null,t.windings=null,t.consumedBy=n,t.leftSE.consumedBy=n.leftSE,t.rightSE.consumedBy=n.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0||(this._prevInResult=this.prev?this.prev.isInResult()?this.prev:this.prev.prevInResult():null),this._prevInResult}},{key:"beforeState",value:function(){return this._beforeState!==void 0?this._beforeState:(this.prev?this._beforeState=(this.prev.consumedBy||this.prev).afterState():this._beforeState={rings:[],windings:[],multiPolys:[]},this._beforeState)}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var e=this.beforeState();this._afterState={rings:e.rings.slice(0),windings:e.windings.slice(0),multiPolys:[]};for(var n=this._afterState.rings,t=this._afterState.windings,i=this._afterState.multiPolys,o=0,s=this.rings.length;s>o;o++){var a=this.rings[o],l=this.windings[o],u=n.indexOf(a);u===-1?(n.push(a),t.push(l)):t[u]+=l}for(var c=[],h=[],p=0,f=n.length;f>p;p++)if(t[p]!==0){var v=n[p],g=v.poly;if(h.indexOf(g)===-1)if(v.isExterior)c.push(g);else{h.indexOf(g)===-1&&h.push(g);var d=c.indexOf(v.poly);d!==-1&&c.splice(d,1)}}for(var y=0,w=c.length;w>y;y++){var b=c[y].multiPoly;i.indexOf(b)===-1&&i.push(b)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var e=this.beforeState().multiPolys,n=this.afterState().multiPolys;switch(st.type){case"union":this._isInResult=e.length===0!=(n.length===0);break;case"intersection":var t,i;n.length>e.length?(t=e.length,i=n.length):(t=n.length,i=e.length),this._isInResult=i===st.numMultiPolys&&i>t;break;case"xor":this._isInResult=Math.abs(e.length-n.length)%2==1;break;case"difference":var o=function(s){return s.length===1&&s[0].isSubject};this._isInResult=o(e)!==o(n);break;default:throw Error("Unrecognized operation type found ".concat(st.type))}return this._isInResult}}],[{key:"fromRing",value:function(e,n,t){var i,o,s,a=it.comparePoints(e,n);if(0>a)i=e,o=n,s=1;else{if(0>=a)throw Error("Tried to create degenerate segment at [".concat(e.x,", ").concat(e.y,"]"));i=n,o=e,s=-1}return new r(new it(i,!0),new it(o,!1),[t],[s])}}]),r}(),Dn=function(){function r(e,n,t){if(Z(this,r),!Array.isArray(e)||e.length===0||(this.poly=n,this.isExterior=t,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number"))throw Error("Input geometry is not a valid Polygon or MultiPolygon");var i=It.round(e[0][0],e[0][1]);this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};for(var o=i,s=1,a=e.length;a>s;s++){if(typeof e[s][0]!="number"||typeof e[s][1]!="number")throw Error("Input geometry is not a valid Polygon or MultiPolygon");var l=It.round(e[s][0],e[s][1]);l.x===o.x&&l.y===o.y||(this.segments.push(Kt.fromRing(o,l,this)),this.bbox.ll.x>l.x&&(this.bbox.ll.x=l.x),this.bbox.ll.y>l.y&&(this.bbox.ll.y=l.y),l.x>this.bbox.ur.x&&(this.bbox.ur.x=l.x),l.y>this.bbox.ur.y&&(this.bbox.ur.y=l.y),o=l)}i.x===o.x&&i.y===o.y||this.segments.push(Kt.fromRing(o,i,this))}return W(r,[{key:"getSweepEvents",value:function(){for(var e=[],n=0,t=this.segments.length;t>n;n++){var i=this.segments[n];e.push(i.leftSE),e.push(i.rightSE)}return e}}]),r}(),Ii=function(){function r(e,n){if(Z(this,r),!Array.isArray(e))throw Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Dn(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var t=1,i=e.length;i>t;t++){var o=new Dn(e[t],this,!1);this.bbox.ll.x>o.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),this.bbox.ll.y>o.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.interiorRings.push(o)}this.multiPoly=n}return W(r,[{key:"getSweepEvents",value:function(){for(var e=this.exteriorRing.getSweepEvents(),n=0,t=this.interiorRings.length;t>n;n++)for(var i=this.interiorRings[n].getSweepEvents(),o=0,s=i.length;s>o;o++)e.push(i[o]);return e}}]),r}(),_n=function(){function r(e,n){if(Z(this,r),!Array.isArray(e))throw Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch{}this.polys=[],this.bbox={ll:{x:1/0,y:1/0},ur:{x:-1/0,y:-1/0}};for(var t=0,i=e.length;i>t;t++){var o=new Ii(e[t],this);this.bbox.ll.x>o.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),this.bbox.ll.y>o.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.polys.push(o)}this.isSubject=n}return W(r,[{key:"getSweepEvents",value:function(){for(var e=[],n=0,t=this.polys.length;t>n;n++)for(var i=this.polys[n].getSweepEvents(),o=0,s=i.length;s>o;o++)e.push(i[o]);return e}}]),r}(),Ci=function(){function r(e){Z(this,r),this.events=e;for(var n=0,t=e.length;t>n;n++)e[n].segment.ringOut=this;this.poly=null}return W(r,null,[{key:"factory",value:function(e){for(var n=[],t=0,i=e.length;i>t;t++){var o=e[t];if(o.isInResult()&&!o.ringOut){for(var s=null,a=o.leftSE,l=o.rightSE,u=[a],c=a.point,h=[];s=a,u.push(a=l),a.point!==c;)for(;;){var p=a.getAvailableLinkedEvents();if(p.length===0){var f=u[0].point,v=u[u.length-1].point;throw Error("Unable to complete output ring starting at [".concat(f.x,",")+" ".concat(f.y,"]. Last matching segment found ends at")+" [".concat(v.x,", ").concat(v.y,"]."))}if(p.length===1){l=p[0].otherSE;break}for(var g=null,d=0,y=h.length;y>d;d++)if(h[d].point===a.point){g=d;break}if(g===null){h.push({index:u.length,point:a.point});var w=a.getLeftmostComparator(s);l=p.sort(w)[0].otherSE;break}var b=h.splice(g)[0],E=u.splice(b.index);E.unshift(E[0].otherSE),n.push(new r(E.reverse()))}n.push(new r(u))}}return n}}]),W(r,[{key:"getGeom",value:function(){for(var e=this.events[0].point,n=[e],t=1,i=this.events.length-1;i>t;t++){var o=this.events[t].point;Cn(o,e,this.events[t+1].point)!==0&&(n.push(o),e=o)}if(n.length===1)return null;Cn(n[0],e,n[1])===0&&n.shift(),n.push(n[0]);for(var s=this.isExteriorRing()?1:-1,a=this.isExteriorRing()?0:n.length-1,l=this.isExteriorRing()?n.length:-1,u=[],c=a;c!=l;c+=s)u.push([n[c].x,n[c].y]);return u}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var e=this.enclosingRing();this._isExteriorRing=!e||!e.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var e=this.events[0],n=1,t=this.events.length;t>n;n++){var i=this.events[n];it.compare(e,i)>0&&(e=i)}for(var o=e.segment.prevInResult(),s=o?o.prevInResult():null;;){if(!o)return null;if(!s)return o.ringOut;if(s.ringOut!==o.ringOut)return s.ringOut.enclosingRing()!==o.ringOut?o.ringOut:o.ringOut.enclosingRing();o=s.prevInResult(),s=o?o.prevInResult():null}}}]),r}(),Tn=function(){function r(e){Z(this,r),this.exteriorRing=e,e.poly=this,this.interiorRings=[]}return W(r,[{key:"addInterior",value:function(e){this.interiorRings.push(e),e.poly=this}},{key:"getGeom",value:function(){var e=[this.exteriorRing.getGeom()];if(e[0]===null)return null;for(var n=0,t=this.interiorRings.length;t>n;n++){var i=this.interiorRings[n].getGeom();i!==null&&e.push(i)}return e}}]),r}(),Ri=function(){function r(e){Z(this,r),this.rings=e,this.polys=this._composePolys(e)}return W(r,[{key:"getGeom",value:function(){for(var e=[],n=0,t=this.polys.length;t>n;n++){var i=this.polys[n].getGeom();i!==null&&e.push(i)}return e}},{key:"_composePolys",value:function(e){for(var n=[],t=0,i=e.length;i>t;t++){var o=e[t];if(!o.poly)if(o.isExteriorRing())n.push(new Tn(o));else{var s=o.enclosingRing();s.poly||n.push(new Tn(s)),s.poly.addInterior(o)}}return n}}]),r}(),Ni=function(){function r(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Kt.compare;Z(this,r),this.queue=e,this.tree=new Oe(n),this.segments=[]}return W(r,[{key:"process",value:function(e){var n=e.segment,t=[];if(e.consumedBy)return e.isLeft?this.queue.remove(e.otherSE):this.tree.remove(n),t;var i=e.isLeft?this.tree.insert(n):this.tree.find(n);if(!i)throw Error("Unable to find segment #".concat(n.id," ")+"[".concat(n.leftSE.point.x,", ").concat(n.leftSE.point.y,"] -> ")+"[".concat(n.rightSE.point.x,", ").concat(n.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var o=i,s=i,a=void 0,l=void 0;a===void 0;)(o=this.tree.prev(o))===null?a=null:o.key.consumedBy===void 0&&(a=o.key);for(;l===void 0;)(s=this.tree.next(s))===null?l=null:s.key.consumedBy===void 0&&(l=s.key);if(e.isLeft){var u=null;if(a){var c=a.getIntersection(n);if(c!==null&&(n.isAnEndpoint(c)||(u=c),!a.isAnEndpoint(c)))for(var h=this._splitSafely(a,c),p=0,f=h.length;f>p;p++)t.push(h[p])}var v=null;if(l){var g=l.getIntersection(n);if(g!==null&&(n.isAnEndpoint(g)||(v=g),!l.isAnEndpoint(g)))for(var d=this._splitSafely(l,g),y=0,w=d.length;w>y;y++)t.push(d[y])}if(u!==null||v!==null){var b=null;u===null?b=v:v===null?b=u:b=it.comparePoints(u,v)>0?v:u,this.queue.remove(n.rightSE),t.push(n.rightSE);for(var E=n.split(b),O=0,Y=E.length;Y>O;O++)t.push(E[O])}t.length>0?(this.tree.remove(n),t.push(e)):(this.segments.push(n),n.prev=a)}else{if(a&&l){var C=a.getIntersection(l);if(C!==null){if(!a.isAnEndpoint(C))for(var j=this._splitSafely(a,C),q=0,vt=j.length;vt>q;q++)t.push(j[q]);if(!l.isAnEndpoint(C))for(var lt=this._splitSafely(l,C),ft=0,De=lt.length;De>ft;ft++)t.push(lt[ft])}}this.tree.remove(n)}return t}},{key:"_splitSafely",value:function(e,n){this.tree.remove(e);var t=e.rightSE;this.queue.remove(t);var i=e.split(n);return i.push(t),e.consumedBy===void 0&&this.tree.insert(e),i}}]),r}(),Fn=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Di=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,st=new(function(){function r(){Z(this,r)}return W(r,[{key:"run",value:function(e,n,t){st.type=e,It.reset();for(var i=[new _n(n,!0)],o=0,s=t.length;s>o;o++)i.push(new _n(t[o],!1));if(st.numMultiPolys=i.length,st.type==="difference")for(var a=i[0],l=1;i.length>l;)Be(i[l].bbox,a.bbox)!==null?l++:i.splice(l,1);if(st.type==="intersection"){for(var u=0,c=i.length;c>u;u++)for(var h=i[u],p=u+1,f=i.length;f>p;p++)if(Be(h.bbox,i[p].bbox)===null)return[]}for(var v=new Oe(it.compare),g=0,d=i.length;d>g;g++)for(var y=i[g].getSweepEvents(),w=0,b=y.length;b>w;w++)if(v.insert(y[w]),v.size>Fn)throw Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var E=new Ni(v),O=v.size,Y=v.pop();Y;){var C=Y.key;if(v.size===O){var j=C.segment;throw Error("Unable to pop() ".concat(C.isLeft?"left":"right"," SweepEvent ")+"[".concat(C.point.x,", ").concat(C.point.y,"] from segment #").concat(j.id," ")+"[".concat(j.leftSE.point.x,", ").concat(j.leftSE.point.y,"] -> ")+"[".concat(j.rightSE.point.x,", ").concat(j.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(v.size>Fn)throw Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(E.segments.length>Di)throw Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var q=E.process(C),vt=0,lt=q.length;lt>vt;vt++){var ft=q[vt];ft.consumedBy===void 0&&v.insert(ft)}O=v.size,Y=v.pop()}It.reset();var De=Ci.factory(E.segments);return new Ri(De).getGeom()}}]),r}()),_i=function(r){for(var e=arguments.length,n=Array(e>1?e-1:0),t=1;e>t;t++)n[t-1]=arguments[t];return st.run("union",r,n)},Ti=function(r){for(var e=arguments.length,n=Array(e>1?e-1:0),t=1;e>t;t++)n[t-1]=arguments[t];return st.run("difference",r,n)};function Wn(r,e,n){n===void 0&&(n={});var t=K(r),i=K(e),o=_i(t.coordinates,i.coordinates);return o.length===0?null:o.length===1?gt(o[0],n.properties):Ot(o,n.properties)}var N={getLineCenter:function(r,e){r instanceof BMapGL.Point&&e instanceof BMapGL.Point&&(r=G([r.lng,r.lat]),e=G([e.lng,e.lat]));var n=function(t,i){return he(t,H(t,i)/2,pe(t,i))}(r,e);return{geoCenter:n,bdCenter:new BMapGL.Point(n.geometry.coordinates[0],n.geometry.coordinates[1])}},getDistance:function(r,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"kilometers";return r instanceof BMapGL.Point&&e instanceof BMapGL.Point&&(r=G([r.lng,r.lat]),e=G([e.lng,e.lat])),H(r,e,{units:n})},getLength:function(r){var e;return(e={units:arguments.length>1&&arguments[1]!==void 0?arguments[1]:"kilometers"})===void 0&&(e={}),qe(r,function(n,t){var i=t.geometry.coordinates;return n+H(i[0],i[1],e)},0)},getPolygonCenter:function(r){var e=function(n,t){t===void 0&&(t={});var i=0,o=0,s=0;return rt(n,function(a){i+=a[0],o+=a[1],s++},!0),G([i/s,o/s],t.properties)}(r);return{geoCenter:e,bdCenter:new BMapGL.Point(e.geometry.coordinates[0],e.geometry.coordinates[1])}},getPolygonArea:function(r){return r instanceof BMapGL.Polygon&&(r=r.toGeoJSON()),mi(r)/1e6},unionPolygon:function(r){for(var e=r[0],n=0,t=r.length;t>n;n++)e=Wn(e,r[n]);return e},isDisjoint:function(r,e){return!ke(r,e)},intersect:function(r,e){var n=[];if(e.__proto__ instanceof BMapGL.Overlay){if(!e.toGeoJSON)return n;e=e.toGeoJSON()}return r.forEach(function(t){var i=t;if(t.__proto__ instanceof BMapGL.Overlay){if(!t.toGeoJSON)return!0;i=t.toGeoJSON()}N.isDisjoint(i,e)&&n.push(t)}),n},isContains:function(r,e){return Li(r,e)},isPointOnLine:function(r,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{ignoreEndVertices:!1};return r instanceof BMapGL.Point&&(r=r.toGeoJSON()),e instanceof BMapGL.Polyline&&(e=e.toGeoJSON()),Mt(r,e,n)},isPointInPolygon:function(r,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{ignoreBoundary:!0};return r instanceof BMapGL.Point&&(r=r.toGeoJSON()),e instanceof BMapGL.Polygon&&(e=e.toGeoJSON()),et(r,e,n)},getDistance2Lines:function(r,e){return di(G([r.lng,r.lat]),R(e))},getNearestPointOnLine:function(r,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"kilometers",t=G([r.lng,r.lat]),i=[];e.geometry.type==="Polygon"?i=e.geometry.coordinates[0]:e.geometry.type==="LineString"&&(i=e.geometry.coordinates);var o=pn(R(i),t,n),s=new BMapGL.Point(o.geometry.coordinates[0],o.geometry.coordinates[1]);return{geoPoint:t,geoNearestPoint:o,toLineDistance:H(t,o),bdNearestPoint:s}}},Fi=function(r){S(n,r);var e=P(n);function n(t){var i;return k(this,n),(i=e.call(this)).point=void 0,i.overlay=void 0,i.map=t,i}return x(n,[{key:"confirmOperate",value:function(){var t=""+this.overlay;t==="Polyline"||t==="Polygon"?this.overlay.disableEditing():t==="Marker"&&this.overlay.disableDragging(),this.dispatchEvent(new A("ok",this.overlay))}},{key:"cancelOperate",value:function(){this.dispatchEvent(new A("cancel",this.overlay))}},{key:"setPosition",value:function(t,i){this.point=t;var o=this.map.pointToOverlayPixel(this.point);i?(this.div.classList.remove("operateLeft"),this.div.style.left=o.x+15+"px"):(this.div.classList.add("operateLeft"),this.div.style.left=o.x-105+"px"),this.div.style.top=o.y-16+"px"}},{key:"draw",value:function(){var t=this.map.pointToOverlayPixel(this.point);this.div.style.left=t.x+15+"px",this.div.style.top=t.y-16+"px"}},{key:"calculateOverlay",value:function(){var t={data:0};switch(""+this.overlay){case"Polyline":t.data=1e3*N.getLength(this.overlay.toGeoJSON());break;case"Polygon":t.data=1e6*N.getPolygonArea(this.overlay);break;case"Circle":var i=this.overlay.getRadius();t.data=Math.PI*i*i}return t.data=!t.data||0>t.data?0:t.data.toFixed(2),t}}]),n}(ne(BMapGL.Overlay,z)),Rt=function(r){S(n,r);var e=P(n);function n(t,i){var o;return k(this,n),(o=e.call(this,t)).limit=void 0,o.element=i,o}return x(n,[{key:"setData",value:function(t){for(var i in t)t.hasOwnProperty(i)&&(this[i]=t[i]);this.type=""+this.overlay,this.type==="Marker"?(this.overlayTypeText="可以拖动图标改变位置",this.unit=this.type==="Polyline"?"万米":"万平方米"):this.overlayTypeText=this.type==="Polyline"?"长度不超过"+(this.limit||1e10)/1e4+"万米！":"面积不超过"+(this.limit||1e10)/1e4+"万平方米！"}},{key:"initialize",value:function(t){var i;return this.element?(i=this.div=this.element).className="operateWindow":((i=this.div=document.createElement("div")).className="operateWindow",i.innerHTML=`<div class="containerbox">
                <span id="confirmOperate"></span>
                <span id="cancelOperate"></span>
                <span id="warnOperate">`.concat(this.overlayTypeText,`</span>
                </div>`)),t.getPanes().markerPane.appendChild(this.div),this.bind(),this.updateWindow(),i}},{key:"bind",value:function(){var t=this;if(this.element)throw console.log("自定义operate必须重写bind方法"),{errMsg:"自定义operate必须重写bind方法"};document.getElementById("confirmOperate").addEventListener("click",function(i){var o=t.calculateOverlay();t.overlay.geometryCalculate=o,t.confirmOperate()}),document.getElementById("cancelOperate").addEventListener("click",function(i){t.cancelOperate()})}},{key:"updateWindow",value:function(){if(this.element)throw console.log("自定义operate必须重写updateWindow方法"),{errMsg:"自定义operate必须重写updateWindow方法"};var t=this.limit||1e7,i=this.calculateOverlay();document.getElementById("confirmOperate")&&(i.data>~~t?(document.getElementById("confirmOperate").style.display="none",document.getElementById("warnOperate").style.display="block"):(document.getElementById("confirmOperate").style.display="block",document.getElementById("warnOperate").style.display="none"))}}]),n}(Fi),jn=function(r){S(n,r);var e=P(n);function n(t,i){var o;return k(this,n),(o=e.call(this))._enableEdgeMove=!1,o.cursor="crosshair",o.container=void 0,o.map=t,i&&(o.cursor=i),o}return x(n,[{key:"initialize",value:function(t){var i=this;this.dispose();var o=t.getSize(),s=this.container=document.createElement("div");return s.style.cssText=`position:absolute;background:transparent;
            cursor:`.concat(this.cursor,";width:").concat(o.width,"px;height:").concat(o.height,"px"),t.addEventListener("resize",function(a){i.adjustSize(a.size)}),t.getPanes().floatPane.appendChild(s),this.bindEvent(),s}},{key:"draw",value:function(){var t=this.map.pixelToPoint(new BMapGL.Pixel(0,0)),i=this.map.pointToOverlayPixel(t);this.container.style.left=i.x+"px",this.container.style.top=i.y+"px"}},{key:"setCursor",value:function(t){this.cursor=t,this.container&&(this.container.style.cursor=t)}},{key:"adjustSize",value:function(t){this.container.style.width=t.width+"px",this.container.style.height=t.height+"px"}},{key:"bindEvent",value:function(){for(var t=this,i=null,o=null,s=function(c){return{x:c.clientX,y:c.clientY}},a=function(c){var h=c.type,p=t.getDrawLatlngPoint(c),f=function(g){c.point=p,t.dispatchEvent(c)};h==="mousedown"&&(i=s(c));var v=s(c);h==="click"?5>Math.abs(v.x-i.x)&&5>Math.abs(v.y-i.y)&&(o&&5>Math.abs(v.x-o.x)&&5>Math.abs(v.y-o.y)?o=null:(f(),o=s(c))):f()},l=["click","mousedown","mousemove","mouseup","dblclick","rightclick"],u=l.length;u--;)m.on(this.container,l[u],a,this._listeners);m.on(this.container,"mousemove",function(c){t._enableEdgeMove&&t.mousemoveAction(c)},this._listeners)}},{key:"mousemoveAction",value:function(t){var i=this,o=this.map.pointToPixel(this.getDrawLatlngPoint(t)),s=function(a){var l=a.clientX,u=a.clientY;return a.changedTouches&&(l=a.changedTouches[0].clientX,u=a.changedTouches[0].clientY),new BMapGL.Pixel(l,u)}(t);o=new BMapGL.Pixel(s.x-(s.x-o.x),s.y-(s.y-o.y)),this.draggingMovePixel=o,this.panByX=this.panByY=0,o.x>=4&&20>=o.x||o.x>=this.map.width-20&&this.map.width-4>=o.x||o.y>=4&&50>=o.y||o.y>=this.map.height-10&&this.map.height-4>=o.y?(o.x>20?this.map.width-20>o.x||(this.panByX=-8):this.panByX=8,o.y>50?this.map.height-10>o.y||(this.panByY=-8):this.panByY=8,this.edgeMoveTimer||(this.edgeMoveTimer=setInterval(function(){i.map.panBy(i.panByX,i.panByY,{noAnimation:!0})},30))):this.edgeMoveTimer&&(clearInterval(this.edgeMoveTimer),this.edgeMoveTimer=null)}},{key:"getDrawLatlngPoint",value:function(t){var i=m.getTarget(t),o=t.offsetX||t.layerX||0,s=t.offsetY||t.layerY||0;for(i.nodeType!==1&&(i=i.parentNode);i&&i!==this.map.getContainer();)i.clientWidth===0&&i.clientHeight===0&&i.offsetParent&&i.offsetParent.nodeName==="TD"||(o+=i.offsetLeft||0,s+=i.offsetTop||0),i=i.offsetParent;var a=new BMapGL.Pixel(o,s);return this.map.pixelToPoint(a)}},{key:"enableEdgeMove",value:function(){this._enableEdgeMove=!0}},{key:"disableEdgeMove",value:function(){clearInterval(this.edgeMoveTimer),this._enableEdgeMove=!1}}]),n}(ne(BMapGL.Overlay,z)),Ht=function(r){S(n,r);var e=P(n);function n(t){var i,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(k(this,n),(i=e.call(this)).isOpen=void 0,i.drawType=void 0,i.instances=[],i.selectInstance=[],i.mask=void 0,i.map=void 0,i.operate=void 0,i._currentStatus=I.STATUS_FREE,i._runningAction=null,i._stopClick=!1,!(t instanceof BMapGL.Map))throw Error("Scene实例化必须输入map参数");return i.options={},m.deepCopy(qn,2,i.options,0,[Rt]),m.copyOptions(i.options,o,[Rt]),i.map=t,i.mask=new jn(t,i.options.drawCursor),i.operate=i.options.operate||new Rt(t),i.options.operate&&(i.options.operate.ignore=!0),i.addMapListener(t),document.onkeydown=function(s){s.keyCode===i.options.keyCode&&(i._stopClick=!0)},document.onkeyup=function(s){s.keyCode===i.options.keyCode&&(i._stopClick=!1)},i}return x(n,[{key:"currentStatus",get:function(){return this._currentStatus},set:function(t){this._currentStatus=t,this.updateMapListenerControl(t)}},{key:"runningAction",get:function(){return this._runningAction},set:function(t){this._runningAction=t}},{key:"addMapListener",value:function(t){var i=this;this.mapSelect=new ie(t),this.mapSelect.addEventListener(M.CLICK,function(o){i._currentStatus!==I.STATUS_MOVE&&i.dispatchEvent(o)}),this.mapSelect.addEventListener(M.RIGHTCLICK,function(o){i._currentStatus!==I.STATUS_MOVE&&i.dispatchEvent(o)}),this.mapSelect.addEventListener(M.MOVE,function(o){i._currentStatus!==I.STATUS_DRAWING&&i._currentStatus!==I.STATUS_EDITER&&i._currentStatus!==I.STATUS_MOVE&&i.dispatchEvent(o)})}},{key:"updateMapListenerControl",value:function(t){if(this.mapSelect)switch(t){case I.STATUS_FREE:this.mapSelect.open();break;case I.STATUS_EDITER:this.mapSelect.openClick(),this.mapSelect.openMouse();break;case I.STATUS_DRAWING:case I.STATUS_MOVE:this.mapSelect.closeClick(),this.mapSelect.openMouse();break;default:this.mapSelect.open()}}},{key:"open",value:function(){return this.isOpen=!0,this.mask||(this.mask=new jn(this.map,this.options.drawCursor)),this.map.addOverlay(this.mask),this.setCurrentDrawType(this.drawType),!0}},{key:"close",value:function(){var t=0>=arguments.length||arguments[0]===void 0||arguments[0];this.isOpen=!1,this.closeRunningAction(),t&&(this.currentStatus=I.STATUS_FREE),this.mask&&this.map.removeOverlay(this.mask)}},{key:"closeRunningAction",value:function(){this.runningAction&&this.runningAction.close instanceof Function&&this.runningAction.close()}},{key:"addOverlay",value:function(t){this.instances.find(function(i){return i===t})||this.instances.push(t)}},{key:"removeOverlay",value:function(t){var i=this.instances.findIndex(function(o){return o===t});i!==-1&&(this.map.removeOverlay(this.instances[i]),this.instances.splice(i)),this.operate&&this.map.removeOverlay(this.operate)}},{key:"clearData",value:function(){var t=this;this.instances.forEach(function(i){t.map.removeOverlay(i)}),this.instances.length=0}},{key:"addSelectDrawData",value:function(t){this.selectInstance.find(function(i){return i===t})||this.selectInstance.push(t)}},{key:"hasOverlay",value:function(t){var i=this.instances.findIndex(function(o){return o===t});return i>-1||(i=this.selectInstance.findIndex(function(o){return o===t}))>-1}},{key:"clearSelectDrawData",value:function(){var t=this;this.selectInstance.forEach(function(i){t.map.removeOverlay(i)}),this.selectInstance.length=0}},{key:"setCurrentDrawType",value:function(t){this.drawType=t}},{key:"attachSnapSource",value:function(t){this._attachSnapSource=t}},{key:"setDrawCursor",value:function(t){this.mask&&this.mask.setCursor(t)}},{key:"getStopStatus",value:function(){return this._stopClick}}]),n}(z),pt=function(r,e,n,t){var i,o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:[],s=(i=t.getZoom(),Math.pow(2,18-i));n*=s;var a,l=ze(e);try{var u=function(){var h=a.value;if(o.find(function(C){return h===C}))return"continue";if(h instanceof BMapGL.Marker){var p=h.getPosition(),f=1e3*N.getDistance(r,p,"kilometers");return n>f?{v:p}:"continue"}if(h.toGeoJSON){for(var v=h.getPath(),g=[],d=h.toGeoJSON(),y=0;v.length-1>y;y++)g.push(N.getLineCenter(v[y],v[y+1]).bdCenter);var w,b=ze(v.concat(g));try{for(b.s();!(w=b.n()).done;){var E=w.value,O=1e3*N.getDistance(r,E,"kilometers");if(n>O)return{v:E}}}catch(C){b.e(C)}finally{b.f()}var Y=N.getNearestPointOnLine(r,d);if(n>1e3*Y.toLineDistance)return{v:Y.bdNearestPoint}}};for(l.s();!(a=l.n()).done;){var c=u();if(c!=="continue"&&_(c)==="object")return c.v}}catch(h){l.e(h)}finally{l.f()}return null},at=function(r){S(n,r);var e=P(n);function n(t){var i,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(k(this,n),(i=e.call(this)).type=void 0,i.isOpen=void 0,i.isOnMap=!0,i.isSeries=!0,i.skipEditing=!1,i.isSelectDraw=!1,i.enableCalculate=!1,i.enableSnap=!0,i.snapDistance=10,i.enableDragging=!1,i.mouseLnglat=void 0,i.match=null,i.matchOverlay=null,i.matchOverlayRadius=5,i.limitPoint=-1,!t)return Te(i);if(!(t instanceof Ht))throw Error("DrawBase实例化必须输入scene参数");i.scene=t;var s={};return m.copyOptionsToNew(i.scene.options,o,s),m.copyNotExitOptions(s,i.scene.options),i.defineProperty(s),i.options=s,i.setSnapPointType(i.options),i.setBaseOptions(i.options.baseOpts),i}return x(n,[{key:"bindEvent",value:function(){}},{key:"setBaseOptions",value:function(){this.baseOptions=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{}}},{key:"setCurrentStatus",value:function(t){this.scene.currentStatus=t}},{key:"skipEdit",value:function(t){t||this.skipEditing?this.scene.operate.confirmOperate():this.scene.mask.hide()}},{key:"emitEventIsonmap",value:function(t){var i=X.DRAW_ON_MAP;this.isSelectDraw&&(i=X.SELECT_ON_MAP);var o=new A(M.COMPLETE,{overlay:t,from:i});this.dispatchEvent(o),this.scene.dispatchEvent(o)}},{key:"emitEventIsnomap",value:function(t){this.scene.currentStatus=I.STATUS_FREE;var i=X.DRAW_NO_MAP;this.isSelectDraw&&(i=X.SELECT_NO_MAP);var o=new A(M.COMPLETE,{overlay:t,from:i});this.dispatchEvent(o),this.scene.dispatchEvent(o)}},{key:"registEvent",value:function(t){var i=this;t.addEventListener(M.INIT,function(o){i.skipEdit()}),t.addEventListener(M.COMPLETE,function(o){i.isSelectDraw?i.scene.addSelectDrawData(o.target.overlay):i.scene.addOverlay(o.target.overlay),o.continue!==!1&&i.isSeries&&(i.isOpen=!0,i.scene.mask.show(),i.bindEvent()),i.dispatchEvent(o),i.editOpe=null}),t.addEventListener(M.CANCEL,function(o){i.isSeries&&(i.isOpen=!0,i.scene.mask.show(),i.bindEvent()),i.dispatchEvent(o),i.editOpe=null})}},{key:"setRunningAction",value:function(t,i){if(t){if(this.isSeries&&this.scene.runningAction===this)return void i();this.scene.closeRunningAction(),this.scene.mask.show(),this.scene.runningAction=this,i(),this.callback&&this.callback()}else this.scene.runningAction=null,this.isOpen=!1,this.scene.mask.hide()}},{key:"closeEdit",value:function(){this.editOpe&&this.editOpe.close()}},{key:"closeAll",value:function(){this.close(),this.closeEdit(),this.scene.mask.disableEdgeMove()}},{key:"open",value:function(t){this.scene&&(this.callback=t,this.scene.drawType=this.type,this.scene.open(),this.isOpen=!0,this.bindEvent())}},{key:"close",value:function(t){t&&t()}},{key:"addLabel",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=new BMapGL.Label(t,{position:i.position,offset:i.offset||new BMapGL.Size(0,0)});return o.setStyle(i.labelOptions),o}},{key:"setRadius",value:function(){var t=this.scene.map.getZoomUnits();this.matchOverlay.setRadius(this.matchOverlayRadius*t)}},{key:"addMatchOverlay",value:function(t){this.matchOverlay instanceof BMapGL.Circle?(this.setRadius(),this.matchOverlay.setCenter(t),this.scene.map.addEventListener("zoomend",this._setRadius=this.setRadius.bind(this)),this.scene.map.addOverlay(this.matchOverlay)):(this.scene.map.addOverlay(this.matchOverlay),this.matchOverlay.setPosition(t))}},{key:"removeMatchOverlay",value:function(){this.scene.map.removeOverlay(this.matchOverlay),this._setRadius&&(this.scene.map.removeEventListener("zoomend",this._setRadius),this._setRadius=null)}},{key:"getSnap",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scene.instances,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:this.snapDistance,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.scene.map,l=null;return this.removeMatchOverlay(),l||(l=pt(t,i,s,a)),!l&&this.scene._attachSnapSource&&(l=pt(t,this.scene._attachSnapSource,s,a)),l||(l=pt(t,o,s,a)),l&&this.addMatchOverlay(l),l}}]),n}(z),Ie=function(r){S(n,r);var e=P(n);function n(t){var i,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return k(this,n),(i=e.call(this,t,o)).type=B.DRAWING_MARKER,i.scene.setCurrentDrawType(i.type),i.mouseMoveModel=o.mouseMove||!1,i.isOpen&&i.open(),i}return x(n,[{key:"clickAction",value:function(t){var i=this;this.scene.getStopStatus()||this.marker&&!this.isOnMap||(this.scene.mask.removeEventListener("mousemove",this.mousemove),this.scene.mask.removeEventListener("click",this.click),this.marker=new BMapGL.Marker(t.point,this.baseOptions),this.scene.map.addOverlay(this.marker),this.isSeries?this.isOnMap||this.bindEvent():this.scene.mask.hide(),this.isOnMap?(this.isSeries?(this.scene.mask.show(),this.bindEvent()):this.setCurrentStatus(I.STATUS_FREE),this.scene.addOverlay(this.marker),this.emitEventIsonmap(this.marker),this.enableDragging&&(this.marker.enableDragging(),this.marker.addEventListener("dragstart",this.centerDragstart.bind(this)),this.marker.addEventListener("dragging",this.centerDragging.bind(this)),this.marker.addEventListener("dragend",this.centerDragend.bind(this)))):(setTimeout(function(){i.scene.map.removeOverlay(i.marker),i.marker=null},200),this.emitEventIsnomap(this.marker)))}},{key:"moveAction",value:function(t){var i=new A(M.MOVE,t);this.dispatchEvent(i)}},{key:"centerDragstart",value:function(t){if(this.enableSnap){var i,o=t.target,s=BMapGL.Projection.convertMC2LL(o.point);(i=this.getSnap(s,this.scene.instances))&&(t.point=BMapGL.Projection.convertLL2MC(i),o.setPoint(t.point))}}},{key:"centerDragging",value:function(t){if(this.enableSnap){var i,o=t.target,s=BMapGL.Projection.convertMC2LL(o.point);(i=this.getSnap(s,this.scene.instances))&&(t.point=BMapGL.Projection.convertLL2MC(i),o.setPoint(t.point))}}},{key:"centerDragend",value:function(t){this.emitEventIsonmap(this.marker)}},{key:"bindEvent",value:function(){var t=this;this.isOpen&&$(J(n.prototype),"setRunningAction",this).call(this,!0,function(){t.setCurrentStatus(I.STATUS_DRAWING),t.mouseMoveModel&&t.scene.mask.addEventListener("mousemove",t.mousemove=t.moveAction.bind(t)),t.scene.mask.addEventListener("click",t.click=t.clickAction.bind(t))})}},{key:"close",value:function(t){$(J(n.prototype),"setRunningAction",this).call(this,!1),this.scene.mask.removeEventListener("click",this.click),this.mouseMoveModel&&this.scene.mask.addEventListener("mousemove",this.mousemove),t&&t()}}]),n}(at),Zt=function(r){S(n,r);var e=P(n);function n(t,i){var o,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(k(this,n),(o=e.call(this)).overlay=null,o.centerIcon=null,o.moveIcon=null,o.circleMoveIcon=null,!(t instanceof Ht))throw Error("EditBase实例化必须输入scene参数");o.scene=t;var a={};return m.copyOptionsToNew(o.scene.options,s,a),m.copyNotExitOptions(a,o.scene.options),o.target=i||Lt(o),o.setOptions(a),o}return x(n,[{key:"setOptions",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.defineProperty(t),this.baseOptions=this.target.__proto__ instanceof at?this.target.baseOptions:t.baseOpts}},{key:"saveSouce",value:function(t){this.source=this.type===B.DRAWING_CIRCLE?{center:t.getCenterIn().latLng,radius:t.getRadius()}:t.toGeoJSON()}},{key:"restoreSouce",value:function(t){this.source&&(this.type===B.DRAWING_CIRCLE?(t.setCenter(this.source.center),t.setRadius(this.source.radius)):t.updateByGeoJSON(this.source),this.restoreOpe(t))}},{key:"restoreOpe",value:function(){}},{key:"open",value:function(t,i,o){var s=this;this.scene&&(this.originStyle={icon:t._config.icon,fillColor:t._config.fillColor,fillOpacity:t._config.fillOpacity,strokeColor:t._config.strokeColor,strokeWeight:t._config.strokeWeight,strokeOpacity:t._config.strokeOpacity},this.overlay=t,this.overlay.setOptions(this.baseOptions),this.setRunningAction(!0,function(){s.setSceneStatus(I.STATUS_EDITER),s.edit(t,i),o&&o()}))}},{key:"emitOkEvent",value:function(t){var i=1>=arguments.length||arguments[1]===void 0||arguments[1],o=arguments.length>2&&arguments[2]!==void 0&&arguments[2],s=X.DRAW_ON_MAP;this.target.__proto__ instanceof at?this.target.isSelectDraw&&(s=X.SELECT_ON_MAP):s=X.EDIT_ON_MAP;var a=new A(M.COMPLETE,{overlay:t,from:s});a.continue=i,this.dispatchEvent(a),(o||this.type!==B.DRAWING_MARKER)&&this.scene.dispatchEvent(a)}},{key:"close",value:function(){var t=arguments.length>0&&arguments[0]!==void 0&&arguments[0],i=arguments.length>1?arguments[1]:void 0;this.overlay&&(this.overlay.setOptions(this.originStyle),this.setRunningAction(!1),this.setSceneStatus(I.STATUS_FREE),this.operateWindow&&(this.removeAttachOverlays(),this.scene.map.removeOverlay(this.operateWindow)),t||this.emitOkEvent(this.overlay,t),this.type!==B.DRAWING_POLYLINE&&this.type!==B.DRAWING_POLYGON||this.overlay.removeEventListener("lineupdate",this.lineUpdate),this.closeOpe(this.overlay),i&&i())}},{key:"setRunningAction",value:function(t,i){t?(this.scene.closeRunningAction(),this.scene.runningAction=this,i()):this.scene.runningAction=null}},{key:"closeOpe",value:function(t){}},{key:"addOperateWindow",value:function(t){var i=this,o=X.DRAW_ON_MAP;this.target.__proto__ instanceof at?this.target.isSelectDraw&&(o=X.SELECT_ON_MAP):(this.saveSouce(t.overlay),o=X.EDIT_ON_MAP);var s=this.operateWindow=this.scene.operate||new Rt(this.scene.map);return s.setData(t),s.addEventListener("ok",function(a){i.removeAttachOverlays(),i.close(!0),i.emitOkEvent(a.target),s._listeners={}}),s.addEventListener("cancel",function(a){i.removeAttachOverlays(),i.close(!0),i.target.__proto__ instanceof at?i.scene.map.removeOverlay(t.overlay):i.restoreSouce(t.overlay);var l=new A(M.CANCEL,{overlay:a.target,from:o+="-cancel"});i.dispatchEvent(l),i.scene.dispatchEvent(l),s._listeners={}}),this.scene.map.addOverlay(s),s}},{key:"removeAttachOverlays",value:function(){for(var t=this.scene.map,i=this.overlays,o=0;i.length>o;o++)if(Array.isArray(i[o]))for(var s in i[o])t.removeOverlay(i[o][s]);else t.removeOverlay(i[o])}},{key:"getSnap",value:function(t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:this.target.snapDistance,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.scene.map,a=null;return a||(a=pt(t,arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scene.instances,o,s)),a||(a=pt(t,i,o,s)),a}}]),n}(z),Ce=function(r){S(n,r);var e=P(n);function n(t,i,o){var s;return k(this,n),(s=e.call(this,t,i,o)).type=B.DRAWING_POLYLINE,s.scene.setCurrentDrawType(s.type),s}return x(n,[{key:"edit",value:function(t,i){var o=this;this.overlay=t;var s=!1;this instanceof n&&this.target.__proto__ instanceof at&&(s=!0);var a={limit:i||null,point:this.getNorthEast(t.getPath()),overlay:t};this.overlays=[];var l=this.addOperateWindow(a);this.lineUpdate=function(u){var c=o.getNorthEast(u.currentTarget.getPath());l.setPosition(c,!0),l.updateWindow();var h=new A(M.CHANGE,u.currentTarget);o.target.dispatchEvent(h)},this.onlinevertexdragging=function(u){var c=u.overlay,h=BMapGL.Projection.convertMC2LL(c.getPoint()),p=null;(p=s?o.getSnap(h,o.scene.instances,[o.overlay]):o.getSnap(h,o.scene.instances))&&(u.from.point=BMapGL.Projection.convertLL2MC(p),c.setPoint(u.from.point))},t.enableEditing(),t.addEventListener("lineupdate",this.lineUpdate),t.addEventListener("onlinevertexdragging",this.onlinevertexdragging),this.dispatchEvent(new A(M.INIT))}},{key:"restoreOpe",value:function(t){t.disableEditing()}},{key:"closeOpe",value:function(t){t.disableEditing()}},{key:"getNorthEast",value:function(t){for(var i=0,o=0,s=0;t.length>s;s++)t[s].lng>i&&(i=t[s].lng,o=s);return t[o]}}]),n}(Zt),zn=function(r){S(n,r);var e=P(n);function n(t,i,o){var s;return k(this,n),(s=e.call(this,t,i,o)).type=B.DRAWING_POLYGON,s.scene.setCurrentDrawType(s.type),s}return x(n)}(Ce),Nt=function(r){S(n,r);var e=P(n);function n(t){var i,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return k(this,n),(i=e.call(this,t,o)).type=B.DRAWING_POLYLINE,i.points=[],i.drawPoint=[],i.overlay=null,i.isBinded=!1,i.tipLabel=null,i.measureRes=0,i.scene.setCurrentDrawType(i.type),i.isOpen&&i.open(),i}return x(n,[{key:"getNorthEast",value:function(t){for(var i=0,o=0,s=0;t.length>s;s++)t[s].lng>i&&(i=t[s].lng,o=s);return t[o]}},{key:"startAction",value:function(t){this.scene.getStopStatus()||(this.points.push(this.match?this.match:t.point),this.drawPoint=this.points.concat(this.points[this.points.length-1]),this.points.length===1?(this.scene.drawType===B.DRAWING_POLYLINE?this.overlay=new BMapGL.Polyline(this.drawPoint,this.baseOptions):this.scene.drawType===B.DRAWING_POLYGON&&(this.overlay=new BMapGL.Polygon(this.drawPoint,this.baseOptions)),this.scene.map.addOverlay(this.overlay)):(this.overlay.setPath(this.drawPoint),this.limitPoint>0&&this.points.length>=this.limitPoint&&this.scene.drawType===B.DRAWING_POLYLINE&&this.dblclickAction(t)),this.isBinded||(this.isBinded=!0,this.scene.mask.enableEdgeMove(),this.scene.mask.removeEventListener("mousemove",this.mousemove),this.scene.mask.addEventListener("mousemove",this.mousemove=this.moveAction.bind(this)),this.scene.mask.addEventListener("dblclick",this.dblclick=this.dblclickAction.bind(this))))}},{key:"moveAction",value:function(t){if(this.scene.getStopStatus())this.scene.map.removeOverlay(this.tipLabel);else{var i=t.point;if(this.enableSnap){var o=[];if(this.overlay.points.length>2){var s=this.overlay.getPath().slice(0,this.overlay.points.length-1);o.push(new this.overlay.constructor(s))}if(this.match=this.getSnap(i,this.scene.instances,o),this.match)return void this.overlay.setPositionAt(this.drawPoint.length-1,this.match)}this.match=null,this.overlay.setPositionAt(this.drawPoint.length-1,t.point),this.scene.map.removeOverlay(this.tipLabel),this.tipLabel=new BMapGL.Label("单击绘制下一个点，双击完成绘制",{position:t.point,offset:new BMapGL.Size(10,10)}),this.tipLabel.setStyle(this.options.labelOptions),this.scene.map.addOverlay(this.tipLabel)}}},{key:"mousemoveAction",value:function(t){this.scene.getStopStatus()?this.scene.map.removeOverlay(this.tipLabel):(m.preventDefault(t),m.stopBubble(t),this.enableSnap&&(this.match=this.getSnap(t.point,this.scene.instances)),this.scene.map.removeOverlay(this.tipLabel),this.tipLabel=new BMapGL.Label("单击确认起点",{position:t.point,offset:new BMapGL.Size(10,10)}),this.tipLabel.setStyle(this.options.labelOptions),this.scene.map.addOverlay(this.tipLabel))}},{key:"dblclickAction",value:function(t){if(m.preventDefault(t),m.stopBubble(t),this.isBinded=!1,this.scene.map.removeOverlay(this.matchOverlay),this.scene.map.removeOverlay(this.tipLabel),this.scene.mask.disableEdgeMove(),this.scene.mask.removeEventListener("mousedown",this.mousedown),this.scene.mask.removeEventListener("mousemove",this.mousemove),this.scene.mask.removeEventListener("dblclick",this.dblclick),this.overlay.setPath(this.points),this.isSeries?this.isOnMap||this.bindEvent():this.scene.mask.hide(),this.isOnMap){var i=null;this.limit&&(i=this.scene.drawingType==="polygon"?this.limit.area:this.limit.distance),this.editOpe=this.type===B.DRAWING_POLYLINE?new Ce(this.scene,this):new zn(this.scene,this);var o=this.editOpe;this.registEvent(o),o.open(this.overlay,i)}else this.scene.map.removeOverlay(this.overlay),this.emitEventIsnomap(this.overlay)}},{key:"bindEvent",value:function(){var t=this;this.isOpen&&$(J(n.prototype),"setRunningAction",this).call(this,!0,function(){t.points.length=0,t.drawPoint.length=0,t.setCurrentStatus(I.STATUS_DRAWING),t.mousedown&&t.mousemove&&(t.isBinded=!1,t.scene.mask.removeEventListener("mousedown",t.mousedown),t.scene.mask.removeEventListener("mousemove",t.mousemove)),t.scene.mask.addEventListener("mousemove",t.mousemove=t.mousemoveAction.bind(t)),t.scene.mask.addEventListener("mousedown",t.mousedown=t.startAction.bind(t))})}},{key:"close",value:function(t){this.isBinded=!1,this.scene.map.removeOverlay(this.tipLabel),this.scene.map.removeOverlay(this.matchOverlay),this.scene.mask.removeEventListener("mousedown",this.mousedown),this.scene.mask.removeEventListener("mousemove",this.mousemove),this.scene.mask.removeEventListener("dblclick",this.dblclick),$(J(n.prototype),"setRunningAction",this).call(this,!1),t&&t()}}]),n}(at),qt=function(r){S(n,r);var e=P(n);function n(t){var i,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return k(this,n),(i=e.call(this,t,o)).type=B.DRAWING_POLYGON,i.scene.setCurrentDrawType(i.type),i}return x(n)}(Nt),Un=function(r){S(n,r);var e=P(n);function n(t,i,o,s,a){var l;return k(this,n),(l=e.call(this)).scene=a,l.type=t,l.point=i,l.number=o,l.overlay=s,l}return x(n,[{key:"initialize",value:function(t){this.map=t;var i,o=this.div=document.createElement("div");return o.className="screenshot",this.type==="circle"?i=`
                <div class="circlShot">
                <span id="screenshotNum">`.concat(this.number,`</span>
                <input id="circleInput" type="text" />
                <span class="unit">米</span>
                </div>
            `):this.type==="rectangle"&&(i=`
                <div class="rectWH">
                <div class="wh">
                    <span id="rectWidth">`.concat(this.number.width,`</span>
                    <input id="rectWidthInput" type="text" />
                </div>
                <span class="multiple">x</span>
                <div class="wh">
                    <span id="rectHeight">`).concat(this.number.height,`</span>
                    <input id="rectHeightInput" type="text" />
                </div>
                <span class="unit">米</span>
                </div>
            `)),o.innerHTML=i,o.addEventListener("mousemove",function(s){m.preventDefault(s),m.stopBubble(s)}),o.addEventListener("dblclick",function(s){m.preventDefault(s),m.stopBubble(s)}),this.map.getPanes().markerPane.appendChild(o),this.bind(),o}},{key:"bind",value:function(){this.setNumber(this.number),this.type==="circle"?this.bindCircleEvent():this.bindRectEvent()}},{key:"bindCircleEvent",value:function(){var t=this,i=document.getElementById("screenshotNum"),o=document.getElementById("circleInput");i.addEventListener("click",function(s){var a=i.innerText;i.style.display="none",o.value=a,o.style.display="inline-block",o.focus()}),o.addEventListener("click",function(s){o.focus()}),o.addEventListener("keydown",function(s){if(s.keyCode===13){var a=o.value;o.style.display="none",i.innerText=a,t.dispatchRadiusChange({radius:a,overlay:t.overlay})}}),o.addEventListener("blur",function(s){var a=o.value;o.style.display="none",i.style.display="inline-block",i.innerText=a,t.dispatchRadiusChange({radius:a,overlay:t.overlay})})}},{key:"bindRectEvent",value:function(){var t=this,i=document.getElementById("rectWidth"),o=document.getElementById("rectWidthInput"),s=document.getElementById("rectHeight"),a=document.getElementById("rectHeightInput");o.value=i.innerText,a.value=s.innerText,i.addEventListener("click",function(l){var u=i.innerText;i.style.display="none",o.value=u,o.style.display="inline-block",o.focus()}),s.addEventListener("click",function(l){var u=s.innerText;s.style.display="none",a.value=u,a.style.display="inline-block",a.focus()}),o.addEventListener("click",function(l){o.focus()}),a.addEventListener("click",function(l){a.focus()}),o.addEventListener("keydown",function(l){if(l.keyCode===13){var u=o.value,c=a.value;a.style.display="none",a.style.display="none",i.style.display="inline-block",a.style.display="inline-block",i.innerText=u,s.innerText=c,t.dispatchRectWHChange({width:u,height:c,overlay:t.overlay})}}),a.addEventListener("keydown",function(l){if(l.keyCode===13){var u=o.value,c=a.value;o.style.display="none",a.style.display="none",i.style.display="inline-block",s.style.display="inline-block",i.innerText=u,s.innerText=c,t.dispatchRectWHChange({width:u,height:c,overlay:t.overlay})}})}},{key:"setInfo",value:function(t,i){this.setNumber(i),this.setPosition(t)}},{key:"setNumber",value:function(t){this.type==="circle"?document.getElementById("screenshotNum").textContent=t:(document.getElementById("rectWidth").textContent=t.width,document.getElementById("rectHeight").textContent=t.height)}},{key:"setPosition",value:function(t){this.point=t;var i=this.type,o=this.map.pointToOverlayPixel(this.point);i==="circle"?(this.div.style.left=o.x-30+"px",this.div.style.top=o.y-40+"px"):i==="rectangle"&&(this.div.style.left=o.x+"px",this.div.style.top=o.y-45+"px")}},{key:"draw",value:function(){var t=this.map.pointToOverlayPixel(this.point);this.type==="circle"?(this.div.style.left=t.x-30+"px",this.div.style.top=t.y-40+"px"):this.type==="rectangle"&&(this.div.style.left=t.x+"px",this.div.style.top=t.y-45+"px")}},{key:"dispatchRadiusChange",value:function(t){var i=new A("radiuschange",t);this.dispatchEvent(i)}},{key:"dispatchRectWHChange",value:function(t){var i=new A("rectwhchange",t);this.dispatchEvent(i)}}]),n}(ne(BMapGL.Overlay,z)),Yn=function(r){S(n,r);var e=P(n);function n(t,i,o){var s;return k(this,n),(s=e.call(this,t,i,o)).type=B.DRAWING_RECTANGLE,s.scene.setCurrentDrawType(s.type),s}return x(n,[{key:"setIcon",value:function(t){this.moveIcon=t}},{key:"edit",value:function(t,i){var o=this;this.overlay=t;for(var s=this.getBox(t.getPath()),a=s.startPoint,l=s.endPoint,u=[],c=this.getRectAllPoints(a,l),h=[],p=this.scene.map.getDistance(a,c[2]).toFixed(0),f=this.scene.map.getDistance(a,c[6]).toFixed(0),v=new Un("rectangle",c[0],{width:p,height:f},t,this.scene),g=0;c.length>g;g++){var d=new BMapGL.Marker(c[g]);d.setIcon(this.target&&this.target.moveIcon?this.target.moveIcon:this.moveIcon),d.enableDragging(),u.push(d),this.scene.map.addOverlay(d),h[g]=m.mc2ll(d.point,this.scene.map),d.addEventListener("mousedown",function(w){l=m.mc2ll(w.target.point,o.scene.map)}),d.addEventListener("dragging",function(w){for(var b=w.latLng,E=0;h.length>E;E++)l.lng==h[E].lng&&(c[E].lng=b.lng),l.lat==h[E].lat&&(c[E].lat=b.lat);c=o.getRectAllPoints(c[0],c[4]);for(var O=0;u.length>O;O++)u[O].setPosition(c[O]);p=o.scene.map.getDistance(c[0],c[2]).toFixed(0),f=o.scene.map.getDistance(c[0],c[6]).toFixed(0),v.setInfo(c[0],{width:p,height:f}),y.setPosition(c[3],!0),t.setPath(c)}),d.addEventListener("dragend",function(w){for(var b=0;u.length>b;b++)h[b]=m.mc2ll(u[b].point,o.scene.map);y.updateWindow();var E=new A(M.CHANGE,t);o.target.dispatchEvent(E)})}v.addEventListener("rectwhchange",function(w){var b=w.target.width,E=w.target.height,O=m.getPointByDistance(c[0],b,"east"),Y=m.getPointByDistance(c[0],E,"south");c[4].lng=O.lng,c[4].lat=Y.lat,c=o.getRectAllPoints(c[0],c[4]);for(var C=0;u.length>C;C++)u[C].setPosition(c[C]);v.setInfo(c[0],{width:b,height:E}),y.setPosition(c[3],!0),t.setPath(c);for(var j=0;u.length>j;j++)h[j]=m.mc2ll(u[j].point,o.scene.map);y.updateWindow();var q=new A(M.CHANGE,t);o.target.dispatchEvent(q)}),this.overlays=[u,v];var y=this.addOperateWindow({limit:i,point:c[3],overlay:t});this.scene.map.addOverlay(v),this.dispatchEvent(new A(M.INIT)),this.onlinevertexdragging=function(w){console.log(w);var b,E=w.overlay,O=BMapGL.Projection.convertMC2LL(E.getPoint());(b=o.getSnap(O,o.scene.instances))&&(w.from.point=BMapGL.Projection.convertLL2MC(b),E.setPoint(w.from.point))},t.addEventListener("onlinevertexdragging",this.onlinevertexdragging)}},{key:"getBox",value:function(t){var i=1/0,o=-1/0,s=-1/0,a=1/0;return t.forEach(function(l){i>l.lng&&(i=l.lng),l.lat>o&&(o=l.lat),l.lng>s&&(s=l.lng),a>l.lat&&(a=l.lat)}),{startPoint:new BMapGL.Point(i,o),endPoint:new BMapGL.Point(s,a)}}},{key:"getRectAllPoints",value:function(t,i){var o=new BMapGL.Point(t.lng,t.lat),s=new BMapGL.Point(i.lng,t.lat),a=new BMapGL.Point(i.lng,i.lat),l=new BMapGL.Point(t.lng,i.lat);return[o,new BMapGL.Point((t.lng+i.lng)/2,t.lat),s,new BMapGL.Point(i.lng,(t.lat+i.lat)/2),a,new BMapGL.Point((t.lng+i.lng)/2,i.lat),l,new BMapGL.Point(t.lng,(t.lat+i.lat)/2)]}},{key:"getRectanglePoint",value:function(t,i){return[new BMapGL.Point(t.lng,t.lat),new BMapGL.Point(i.lng,t.lat),new BMapGL.Point(i.lng,i.lat),new BMapGL.Point(t.lng,i.lat)]}}]),n}(Zt),Re=function(r){S(n,r);var e=P(n);function n(t){var i,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return k(this,n),(i=e.call(this,t,o)).type=B.DRAWING_RECTANGLE,i.polygon=null,i.startPoint=null,i.scene.setCurrentDrawType(i.type),i.moveIcon=new BMapGL.Icon(Ue,new BMapGL.Size(10,10)),i.moveIcon.setImageSize(new BMapGL.Size(10,10)),i.isOpen&&i.open(),i}return x(n,[{key:"getRectAllPoints",value:function(t,i){var o=new BMapGL.Point(t.lng,t.lat),s=new BMapGL.Point(i.lng,t.lat),a=new BMapGL.Point(i.lng,i.lat),l=new BMapGL.Point(t.lng,i.lat);return[o,new BMapGL.Point((t.lng+i.lng)/2,t.lat),s,new BMapGL.Point(i.lng,(t.lat+i.lat)/2),a,new BMapGL.Point((t.lng+i.lng)/2,i.lat),l,new BMapGL.Point(t.lng,(t.lat+i.lat)/2)]}},{key:"getRectanglePoint",value:function(t,i){return[new BMapGL.Point(t.lng,t.lat),new BMapGL.Point(i.lng,t.lat),new BMapGL.Point(i.lng,i.lat),new BMapGL.Point(t.lng,i.lat)]}},{key:"startAction",value:function(t){if(!this.scene.getStopStatus()){m.stopBubble(t),m.preventDefault(t);var i=this.startPoint=t.point;this.enableSnap&&this.match&&(i=this.startPoint=this.match);var o=this.endPoint=i;this.polygon=new BMapGL.Polygon(this.getRectanglePoint(i,o),this.baseOptions),this.scene.map.addOverlay(this.polygon),this.scene.mask.enableEdgeMove(),this.scene.mask.removeEventListener("mousedown",this.mousedown),this.scene.mask.removeEventListener("mousemove",this.mousemove),this.scene.mask.addEventListener("mousemove",this.mousemove=this.moveAction.bind(this)),this.scene.mask.addEventListener("mouseup",this.mouseup=this.endAction.bind(this))}}},{key:"moveAction",value:function(t){if(this.scene.map.removeOverlay(this.tipLabel),!this.scene.getStopStatus())if(this.enableSnap&&(this.match=this.getSnap(t.point,this.scene.instances),this.match))this.polygon.setPath(this.getRectanglePoint(this.startPoint,this.match));else{this.match=null,this.polygon.setPath(this.getRectanglePoint(this.startPoint,t.point));var i=this.getRectAllPoints(this.startPoint,t.point),o=this.scene.map.getDistance(this.startPoint,i[2]).toFixed(0),s=this.scene.map.getDistance(this.startPoint,i[6]).toFixed(0);this.tipLabel=new BMapGL.Label("尺寸："+o+"米 x "+s+"米<br>松开结束绘制",{position:t.point,offset:new BMapGL.Size(10,10)}),this.tipLabel.setStyle(this.options.labelOptions),this.scene.map.addOverlay(this.tipLabel)}}},{key:"endAction",value:function(t){if(!this.scene.getStopStatus())if(this.scene.map.removeOverlay(this.tipLabel),this.scene.mask.removeEventListener("mousemove",this.mousemove),this.scene.mask.removeEventListener("mouseup",this.mouseup),this.scene.mask.disableEdgeMove(),this.enableSnap?(this.match=this.getSnap(t.point,this.scene.instances),this.match&&this.polygon.setPath(this.getRectanglePoint(this.startPoint,this.match))):this.polygon.setPath(this.getRectanglePoint(this.startPoint,t.point)),this.isSeries?this.isOnMap||this.bindEvent():this.scene.mask.hide(),this.isOnMap){var i=null;this.options.limit&&(i=this.options.limit.area);var o=this.editOpe=new Yn(this.scene,this);this.registEvent(o),o.open(this.polygon,i)}else this.scene.map.removeOverlay(this.polygon),this.emitEventIsnomap(this.polygon)}},{key:"mousemoveAction",value:function(t){this.scene.getStopStatus()?this.scene.map.removeOverlay(this.tipLabel):(m.preventDefault(t),m.stopBubble(t),this.enableSnap&&(this.match=this.getSnap(t.point,this.scene.instances)),this.scene.map.removeOverlay(this.tipLabel),this.tipLabel=new BMapGL.Label("按住确认起点，拖拽进行绘制",{position:t.point,offset:new BMapGL.Size(10,10)}),this.tipLabel.setStyle(this.options.labelOptions),this.scene.map.addOverlay(this.tipLabel))}},{key:"bindEvent",value:function(){var t=this;this.isOpen&&$(J(n.prototype),"setRunningAction",this).call(this,!0,function(){t.setCurrentStatus(I.STATUS_DRAWING),t.mousedown&&t.mousemove&&(t.scene.mask.removeEventListener("mousedown",t.mousedown),t.scene.mask.removeEventListener("mousemove",t.mousemove)),t.scene.mask.addEventListener("mousemove",t.mousemove=t.mousemoveAction.bind(t)),t.scene.mask.addEventListener("mousedown",t.mousedown=t.startAction.bind(t))})}},{key:"close",value:function(t){this.scene.map.removeOverlay(this.tipLabel),this.scene.map.removeOverlay(this.matchOverlay),this.scene.mask.removeEventListener("mouseup",this.mouseup),this.scene.mask.removeEventListener("mousedown",this.mousedown),this.scene.mask.removeEventListener("mousemove",this.mousemove),$(J(n.prototype),"setRunningAction",this).call(this,!1),t&&t()}}]),n}(at),Jn=function(r){S(n,r);var e=P(n);function n(t,i,o){var s;return k(this,n),(s=e.call(this,t,i,o)).type=B.DRAWING_CIRCLE,s.scene.setCurrentDrawType(s.type),s}return x(n,[{key:"setCenterIcon",value:function(t){this.centerIcon=t}},{key:"setMoveIcon",value:function(t){this.moveIcon=t}},{key:"edit",value:function(t,i){var o=this;this.overlay=t,this.centerPoint=t.getCenterIn().latLng;var s=new BMapGL.Point(t.getBounds().getNorthEast().lng,this.centerPoint.lat),a=this.centerMarker=new BMapGL.Marker(this.centerPoint);a.setIcon(this.centerIcon),a.enableDragging(),a.addEventListener("dragstart",this.centerDragstart.bind(this)),a.addEventListener("dragging",this.centerDragging.bind(this)),a.addEventListener("dragend",this.centerDragend.bind(this)),this.scene.map.addOverlay(a);var l=this.moveMarker=new BMapGL.Marker(s);l.setIcon(this.circleMoveIcon),l.enableDragging();var u=this.polyline=new BMapGL.Polyline([this.centerPoint,s],this.baseOptions||{}),c=new BMapGL.Point((t.getBounds().getNorthEast().lng+this.centerPoint.lng)/2,this.centerPoint.lat),h=this.radiusWindow=new Un("circle",c,Math.ceil(t.getRadius()),t,this.scene);this.overlays=[a,l,u,h];var p=this.operateWindow=this.addOperateWindow({limit:i,point:s,overlay:t});this.scene.map.addOverlay(l),this.scene.map.addOverlay(u),this.scene.map.addOverlay(h);var f=1;h.addEventListener("radiuschange",function(v){if(v.target.radius&&!isNaN(v.target.radius)){t.setRadius(f=v.target.radius);var g=m.getPointByDistance(o.centerPoint,f,"east"),d=new BMapGL.Point(g.lng,o.centerPoint.lat),y=g.lng>o.centerPoint.lng?(t.getBounds().getNorthEast().lng+o.centerPoint.lng)/2:(t.getBounds().getSouthWest().lng+o.centerPoint.lng)/2,w=new BMapGL.Point(y,o.centerPoint.lat);l.setPosition(d),h.setInfo(w,f),p.setPosition(d,!0),p.updateWindow(),u.setPath([o.centerPoint,d]);var b=new A(M.CHANGE,t);o.target.dispatchEvent(b)}}),l.addEventListener("dragging",function(v){var g=new BMapGL.Point(v.latLng.lng,o.centerPoint.lat),d=v.latLng.lng>o.centerPoint.lng?(t.getBounds().getNorthEast().lng+o.centerPoint.lng)/2:(t.getBounds().getSouthWest().lng+o.centerPoint.lng)/2,y=v.latLng.lng>o.centerPoint.lng,w=new BMapGL.Point(d,o.centerPoint.lat);v.target.setPosition(g),h.setInfo(w,o.scene.map.getDistance(o.centerPoint,v.latLng).toFixed(0)),p.setPosition(g,y),u.setPath([o.centerPoint,g]),f=o.scene.map.getDistance(o.centerPoint,v.latLng).toFixed(0),t.setRadius(o.scene.map.getDistance(o.centerPoint,v.latLng))}),l.addEventListener("dragend",function(v){p.updateWindow();var g=new A(M.CHANGE,t);o.target.dispatchEvent(g)}),this.dispatchEvent(new A(M.INIT))}},{key:"centerDragstart",value:function(t){this.moveMarker.hide(),this.polyline.hide(),this.radiusWindow.hide(),this.operateWindow.hide()}},{key:"centerDragging",value:function(t){this.centerPoint=t.latLng,this.overlay.setCenter(t.latLng)}},{key:"centerDragend",value:function(t){this.centerPoint=t.latLng;var i=new BMapGL.Point(this.overlay.getBounds().getNorthEast().lng,this.centerPoint.lat);this.moveMarker.setPosition(i),this.moveMarker.show();var o=new BMapGL.Point(this.overlay.getBounds().getNorthEast().lng,this.centerPoint.lat);this.polyline.setPath([this.centerPoint,o]),this.polyline.show();var s=(this.overlay.getBounds().getNorthEast().lng+this.centerPoint.lng)/2,a=new BMapGL.Point(s,this.centerPoint.lat);this.radiusWindow.setPosition(a),this.operateWindow.setPosition(o,!0),this.radiusWindow.show(),this.operateWindow.show();var l=new A(M.CHANGE,this.circle);this.target.dispatchEvent(l)}}]),n}(Zt),Ne=function(r){S(n,r);var e=P(n);function n(t){var i,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return k(this,n),(i=e.call(this,t,o)).type=B.DRAWING_CIRCLE,i.circle=null,i.overlays=[],i.centerPoint=null,i.radius=1,i.moveMarker=null,i.polyline=null,i.radiusWindow=null,i.operateWindow=null,i.scene.setCurrentDrawType(i.type),i.isOpen&&i.open(),i}return x(n,[{key:"startAction",value:function(t){this.scene.getStopStatus()||(this.centerPoint=t.point,this.circle=new BMapGL.Circle(this.centerPoint,this.radius,this.baseOptions),this.scene.map.addOverlay(this.circle),this.scene.mask.enableEdgeMove(),this.scene.mask.removeEventListener("mousemove",this.mousemove),this.scene.mask.addEventListener("mousemove",this.mousemove=this.moveAction.bind(this)),this.scene.mask.addEventListener("mouseup",this.mouseup=this.endAction.bind(this)))}},{key:"moveAction",value:function(t){this.scene.map.removeOverlay(this.tipLabel),this.scene.getStopStatus()||(this.radius=this.scene.map.getDistance(this.centerPoint,t.point).toFixed(0),this.circle.setRadius(this.radius),this.tipLabel=new BMapGL.Label("半径："+this.radius+"米<br>松开完成绘制",{position:t.point,offset:new BMapGL.Size(10,10)}),this.tipLabel.setStyle(this.options.labelOptions),this.scene.map.addOverlay(this.tipLabel))}},{key:"endAction",value:function(t){if(!this.scene.getStopStatus())if(this.scene.map.removeOverlay(this.tipLabel),this.scene.mask.disableEdgeMove(),this.scene.mask.removeEventListener("mousemove",this.mousemove),this.scene.mask.removeEventListener("mouseup",this.mouseup),this.isSeries?this.isOnMap||this.bindEvent():this.scene.mask.hide(),this.isOnMap){var i=null;this.limit&&(i=this.limit.area);var o=this.editOpe=new Jn(this.scene,this);this.registEvent(o),o.open(this.circle,i)}else this.scene.map.removeOverlay(this.centerMarker),this.scene.map.removeOverlay(this.circle),this.emitEventIsnomap(this.circle)}},{key:"mousedownAction",value:function(t){this.scene.getStopStatus()||(m.preventDefault(t),m.stopBubble(t),this.scene.mask.removeEventListener("mousedown",this.mousedown),this.centerPoint==null&&this.startAction(t))}},{key:"mousemoveAction",value:function(t){this.scene.map.removeOverlay(this.tipLabel),this.scene.getStopStatus()||(m.preventDefault(t),m.stopBubble(t),this.tipLabel=new BMapGL.Label("按下确认中心点，拖拽确认半径",{position:t.point,offset:new BMapGL.Size(10,10)}),this.tipLabel.setStyle(this.options.labelOptions),this.scene.map.addOverlay(this.tipLabel))}},{key:"bindEvent",value:function(){var t=this;this.isOpen&&$(J(n.prototype),"setRunningAction",this).call(this,!0,function(){t.centerPoint=null,t.radius=1,t.setCurrentStatus(I.STATUS_DRAWING),t.mousedown&&t.mousemove&&(t.scene.mask.removeEventListener("mousedown",t.mousedown),t.scene.mask.removeEventListener("mousemove",t.mousemove)),t.scene.mask.addEventListener("mousemove",t.mousemove=t.mousemoveAction.bind(t)),t.scene.mask.addEventListener("mousedown",t.mousedown=t.mousedownAction.bind(t))})}},{key:"close",value:function(t){$(J(n.prototype),"setRunningAction",this).call(this,!1),this.scene.map.removeOverlay(this.tipLabel),this.scene.mask.removeEventListener("mouseup",this.mouseup),this.scene.mask.removeEventListener("mousedown",this.mousedown),this.scene.mask.removeEventListener("mousemove",this.mousemove),t&&t()}}]),n}(at),Wi=function(r){S(n,r);var e=P(n);function n(t,i,o){var s;return k(this,n),(s=e.call(this,t,i,o)).type=B.DRAWING_MARKER,s.scene.setCurrentDrawType(s.type),s}return x(n,[{key:"setIcon",value:function(t){this.moveIcon=t}},{key:"edit",value:function(t){t.enableDragging(),t.addEventListener("dragstart",this.centerDragstart.bind(this)),t.addEventListener("dragging",this.centerDragging.bind(this)),t.addEventListener("dragend",this.centerDragend.bind(this))}},{key:"centerDragstart",value:function(t){}},{key:"centerDragging",value:function(t){var i,o=t.target,s=BMapGL.Projection.convertMC2LL(o.point);(i=this.getSnap(s,this.scene.instances))&&(t.point=BMapGL.Projection.convertLL2MC(i),o.setPoint(t.point))}},{key:"centerDragend",value:function(t){this.emitOkEvent(this.overlay,!0,!0);var i=new A(M.CHANGE,this.overlay);this.target.dispatchEvent(i)}},{key:"closeOpe",value:function(t){t.disableDragging(),t.removeEventListener("dragstart",this.centerDragstart),t.removeEventListener("dragging",this.centerDragging),t.removeEventListener("dragend",this.centerDragend)}}]),n}(Zt),ji=function(r){S(n,BMapGL.Control);var e=P(n);function n(t){var i,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return k(this,n),(i=e.call(this)).scene=t,i.opts=o,i.drawingItems=o.drawingItems||ni,i.defaultAnchor=o.anchor||BMAP_ANCHOR_TOP_LEFT,i.defaultOffset=o.offset||new BMapGL.Size(20,20),i.initialize(i.scene.map),i}return x(n,[{key:"initialize",value:function(t){this._map=t;var i=this.container=document.createElement("div");i.className="BMap_Drawing";var o=this.panel=document.createElement("div");o.className="BMap_Draw_Panel",i.appendChild(o);var s=this.generalHtml(t);o.appendChild(s);var a=this.tip=document.createElement("div");return a.className="BMapDraw_tip",a.innerHTML='<p class="BMapDraw_tip_title"></p><p class="BMapDraw_tip_text"></p>',this.opts.enableTips&&o.appendChild(a),t.getContainer().appendChild(i),this.bindEvt(),i}},{key:"generalHtml",value:function(t){for(var i=this,o={hander:"拖动地图",marker:"标记点",polyline:"折线",polygon:"多边形",circle:"圆形",rectangle:"矩形"},s=function(c,h){var p=document.createElement("a");return p.className=c,p.href="javascript:void(0)",p.setAttribute("drawingType",h),p.setAttribute("onfocus","this.blur()"),p.addEventListener("mouseenter",function(f){var v=f.target.getAttribute("drawingType"),g=o[v];v==="hander"?(i.tip.children[0].innerText=g,i.tip.children[1].innerText="使用鼠标拖动地图"):(i.tip.className+=" "+v,i.tip.children[0].innerText=g,i.tip.children[1].innerText="使用"+g+"选出目标区域"),i.tip.style.display="block"}),p.addEventListener("mouseleave",function(f){for(var v=f.target.getAttribute("drawingType"),g=" "+i.tip.className.replace(/[\t\r\n]/g,"")+" ";g.indexOf(" "+v+" ")>=0;)g=g.replace(" "+v+" "," ");i.tip.className=g.replace(/^\s+|\s+$/g,""),i.tip.style.display="none"}),p},a=document.createDocumentFragment(),l=0,u=this.drawingItems.length;u>l;l++)a.appendChild(s("BMapDraw_Box BMapDraw_"+this.drawingItems[l],this.drawingItems[l]));return a}},{key:"setStyleByDrawingItems",value:function(){for(var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"marker",i=this.panel.getElementsByTagName("a"),o=0,s=i.length;s>o;o++){var a=i[o];a.getAttribute("drawingType")===t?a.className="BMapDraw_Box BMapDraw_"+t+"_hover":a.className=a.className.replace(/_hover/,"")}}},{key:"bindEventByDrawingType",value:function(t){var i=this.scene;if(i.isOpen&&i.drawType===t)i.close(),i.map.enableDoubleClickZoom();else switch(t){case"marker":new Ie(i).open();break;case"polyline":new Nt(i).open();break;case"polygon":new qt(i).open();break;case"circle":new Ne(i).open();break;case"rectangle":new Re(i).open()}}},{key:"bindEvt",value:function(t){var i=this;m.on(this.panel,"click",function(o){var s=m.getTarget(o).getAttribute("drawingType");i.setStyleByDrawingItems(s),i.bindEventByDrawingType(s)})}}]),n}(),zi=function(r){S(n,r);var e=P(n);function n(t){var i,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return k(this,n),(i=e.call(this)).type=null,i.instance=null,i.graphicOpts=Xe,i.labelOptions=xt,i.isOnMap=!1,i.isSeries=!1,i.skipEditing=!1,i.mouseMove=!0,i.enableSnap=!1,i.limitPoint=-1,i.scene=t,i.defineProperty(o),i}return x(n,[{key:"close",value:function(t){this.instance&&(this.instance.close(),this.instance=null),t&&t()}},{key:"open",value:function(t){this.close(),this.scene.close(),this.defineProperty(t),this.type&&this.doAction()}},{key:"doAction",value:function(){var t=this;this.data=[];var i={isSelectDraw:!0,isOpen:!0,enableSnap:this.enableSnap,isOnMap:this.isOnMap,isSeries:this.isSeries,skipEditing:this.skipEditing,labelOptions:this.labelOptions,baseOpts:this.graphicOpts,mouseMove:this.mouseMove,limitPoint:this.limitPoint};switch(this.type){case B.DRAWING_POLYLINE:this.instance=new Nt(this.scene,i);break;case B.DRAWING_POLYGON:this.instance=new qt(this.scene,i);break;case B.DRAWING_RECTANGLE:this.instance=new Re(this.scene,i);break;case B.DRAWING_CIRCLE:this.instance=new Ne(this.scene,i);break;case B.DRAWING_MARKER:this.instance=new Ie(this.scene,i);break;case B.DRAWING_POINT:this.instance=new ie(this.scene.map);break;default:this.close()}this.instance&&(this.instance.addEventListener(M.CHANGE,function(o){t.dispatchEvent(o)}),this.instance.addEventListener(M.MOVE,function(o){t.dispatchEvent(o)}),this.instance.addEventListener(M.CLICK,function(o){t.dispatchEvent(o);var s=new A(M.COMPLETE,{from:X.SELECT_NO_MAP,mouseTarget:o.target,overlay:new BMapGL.Marker(new BMapGL.Point(o.target.latlng.lng,o.target.latlng.lat))});t.scene.dispatchEvent(s)}),this.instance.addEventListener(M.COMPLETE,function(o){t.dispatchEvent(o)}),this.instance.addEventListener(M.CANCEL,function(o){t.dispatchEvent(o)}))}},{key:"addData",value:function(t){this.scene&&this.scene.addSelectDrawData(t)}},{key:"clearData",value:function(){this.scene&&this.scene.clearSelectDrawData()}}]),n}(z),Ui=function(){function r(e,n){k(this,r),this.label=void 0,this.scene=e}return x(r,[{key:"getLength",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{showlabel:!0,unit:"kilometers"};e instanceof BMapGL.Polyline&&(e=e.toGeoJSON());var t=N.getLength(e);if(n.showlabel){var i=e.geometry.coordinates,o=new BMapGL.Point(i[i.length-1][0],i[i.length-1][1]),s="";switch(n.unit){case"kilometers":s="总长度："+t.toFixed(2)+"km";break;case"meters":s="总长度："+t.toFixed(2)+"m"}this.scene.map.removeOverlay(this.label),this.label=new BMapGL.Label(s,{position:o,offset:n.offset||new BMapGL.Size(0,0)}),this.label.setStyle(n.labelOptions),this.scene.map.addOverlay(this.label)}return t}},{key:"getPolygonArea",value:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{showlabel:!0,unit:"kilometers"};e instanceof BMapGL.Polygon&&(e=e.toGeoJSON());var t=N.getPolygonArea(e);if(n.showlabel){var i=N.getPolygonCenter(e),o="";switch(n.unit){case"kilometers":o=t.toFixed(2)+" km²";break;case"meters":o=t.toFixed(2)+" m²"}this.scene.map.removeOverlay(this.label),this.label=new BMapGL.Label(o,{position:i.bdCenter,offset:n.offset||new BMapGL.Size(-20,-10)}),this.label.setStyle(n.labelOptions),this.scene.map.addOverlay(this.label)}return t}}]),r}(),Yi=function(r){S(n,r);var e=P(n);function n(t){var i,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return k(this,n),(i=e.call(this,t,o)).tipLabel=null,i.lengthLabel=[],i.totalLabel=null,i.turnOverlays=[],i.totalLength=0,i.measureRes=0,i.subDistance=[],i.scene.setCurrentDrawType(i.type),i.setOtherOptions(o),i.isOpen&&i.open(),i}return x(n,[{key:"setOtherOptions",value:function(t){this.options=t,this.skipEditing=!0,this.isOpen=!0,this.options=Object.assign(ti,t),this.isSeries=this.options.isSeries,this.setBaseOptions(this.options.baseOpts)}},{key:"setTurnPoint",value:function(t){var i=this.options,o=new BMapGL.Marker(t,{icon:i.turnIcon?i.turnIcon:Je,clickable:!1,baseZIndex:35e5,zIndexFixed:!0});this.scene.map.addOverlay(o),this.turnOverlays.push(o)}},{key:"startAction",value:function(t){var i=this.match?this.match:t.point;this.points.push(i),this.drawPoint=this.points.concat(this.points[this.points.length-1]),this.points.length===1?(this.turnOverlays=[],this.lengthLabel=[],this.overlay=new BMapGL.Polyline(this.drawPoint,this.baseOptions),this.scene.map.addOverlay(this.overlay)):(this.overlay.setPath(this.drawPoint),this.scene.map.removeOverlay(this.measureLabel),this.scene.map.addOverlay(this.downLabel),this.subDistance.push(this.downLabel.content),this.lengthLabel.push(this.downLabel)),this.setTurnPoint(i),this.isBinded||(this.isBinded=!0,this.scene.mask.enableEdgeMove(),this.scene.mask.removeEventListener("mousemove",this.mousemove),this.scene.mask.addEventListener("mousemove",this.mousemove=this.moveAction.bind(this)),this.scene.mask.addEventListener("dblclick",this.dblclick=this.dblclickAction.bind(this)))}},{key:"moveAction",value:function(t){var i=t.point;if(this.enableSnap){var o=[];if(this.overlay.points.length>2){var s=this.overlay.getPath().slice(0,this.overlay.points.length-1);o.push(new this.overlay.constructor(s))}if(this.match=this.getSnap(i,this.scene.instances,o),this.match)return void this.overlay.setPositionAt(this.drawPoint.length-1,this.match)}this.match=null;var a=this.drawPoint[this.drawPoint.length-2],l=t.point;this.measureRes=N.getDistance(a,l),this.distance=this.measureRes.toFixed(2)+"km";var u=N.getLineCenter(a,l);this.scene.map.removeOverlay(this.measureLabel),this.measureLabel=this.addLabel(this.distance,{position:u.bdCenter}),this.downLabel=this.addLabel(this.distance,{position:u.bdCenter}),this.scene.map.addOverlay(this.measureLabel),this.overlay.setPositionAt(this.drawPoint.length-1,t.point),this.scene.map.removeOverlay(this.tipLabel),this.tipLabel=new BMapGL.Label(this.options.followLabel,{position:t.point,offset:new BMapGL.Size(10,10)}),this.tipLabel.setStyle(this.options.labelOptions),this.scene.map.addOverlay(this.tipLabel)}},{key:"dblclickAction",value:function(t){var i=this;m.preventDefault(t),m.stopBubble(t),this.isBinded=!1,this.scene.map.removeOverlay(this.matchOverlay),this.scene.map.removeOverlay(this.tipLabel),this.scene.mask.disableEdgeMove(),this.scene.mask.removeEventListener("mousedown",this.mousedown),this.scene.mask.removeEventListener("mousemove",this.mousemove),this.scene.mask.removeEventListener("dblclick",this.dblclick);var o=this.overlay.toGeoJSON(),s=o.geometry.coordinates,a=new BMapGL.Point(s[s.length-1][0],s[s.length-1][1]),l=[0,0],u=[0,0],c=this.scene.map.pointToPixel(this.points[this.points.length-2]),h=this.scene.map.pointToPixel(this.points[this.points.length-3]);l=0>c.x-h.x?[-14,0]:[14,0],u=0>c.y-h.y?[-5,-38]:[-5,11];var p=N.getLength(o,this.options.unit);this.totalLength=p;var f="";switch(this.options.unit){case"kilometers":f="总长："+p.toFixed(2)+"km";break;case"meters":f="总长："+p.toFixed(2)+"m"}this.totalLabel=new BMapGL.Label(f,{position:a,offset:new BMapGL.Size(u[0],u[1])}),this.totalLabel.setStyle(this.options.labelOptions),this.scene.map.addOverlay(this.totalLabel),this.lengthLabel.push(this.totalLabel),this.closeIcon=this.options.closeIcon?this.options.closeIcon:Ye,this.closeBtn=new BMapGL.Marker(a,{icon:this.closeIcon,baseZIndex:36e5,offset:new BMapGL.Size(l[0],l[1]),enableMassClear:!0}),this.closeBtn.setTitle("清除本次测距"),this.scene.map.addOverlay(this.closeBtn);var v={overlay:this.overlay,closeBtn:this.closeBtn,totalLabel:this.totalLabel,lengthLabel:this.lengthLabel,points:this.points.slice(0),turnOverlays:this.turnOverlays.slice(0)};this.closeBtn.addEventListener("click",function(g){i.scene.map.removeOverlay(v.closeBtn),i.scene.map.removeOverlay(v.overlay);for(var d=0,y=v.turnOverlays.length;y>d;d++)i.scene.map.removeOverlay(v.turnOverlays[d]),v.turnOverlays[d]=null;for(var w=0,b=v.lengthLabel.length;b>w;w++)i.scene.map.removeOverlay(v.lengthLabel[w]),v.lengthLabel[w]=null}),this.dispatchMeasureEvent(),this.overlay.setPath(this.points),this.isSeries?this.bindEvent():this.scene.mask.hide()}},{key:"dispatchMeasureEvent",value:function(){var t=new A(te.LENGTH_END,{points:this.points?this.points.slice(0):[],distance:this.totalLength,subDistance:this.subDistance,unit:this.options.unit,overlay:this.overlay});this.dispatchEvent(t),this.scene.dispatchEvent(t)}}]),n}(Nt),Ji=function(r){S(n,r);var e=P(n);function n(t){var i,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return k(this,n),(i=e.call(this,t,o)).measureArea=0,i.turnOverlays=[],i.scene.setCurrentDrawType(i.type),i.setOtherOptions(o),i.isOpen&&i.open(),i}return x(n,[{key:"setOtherOptions",value:function(t){this.options=t,this.skipEditing=!0,this.isOpen=!0,this.options=Object.assign($n,t),this.isSeries=this.options.isSeries,this.setBaseOptions(this.options.baseOpts)}},{key:"setTurnPoint",value:function(t){var i=this.options,o=new BMapGL.Marker(t,{icon:i.turnIcon?i.turnIcon:Je,clickable:!1,baseZIndex:35e5,zIndexFixed:!0});this.scene.map.addOverlay(o),this.turnOverlays.push(o)}},{key:"startAction",value:function(t){var i=this.match?this.match:t.point;if(this.points.push(i),this.drawPoint=this.points.concat(this.points[this.points.length-1]),this.points.length===1)this.turnOverlays=[],this.overlay=new BMapGL.Polygon(this.drawPoint,this.baseOptions),this.scene.map.addOverlay(this.overlay);else if(this.overlay.setPath(this.drawPoint),this.points.length>2){this.measureArea=N.getPolygonArea(this.overlay),this.area=this.measureArea.toFixed(2)+"km²";var o=N.getPolygonCenter(this.overlay.toGeoJSON());this.scene.map.removeOverlay(this.areaLabel),this.areaLabel=this.addLabel(this.area,{position:o.bdCenter,offset:new BMapGL.Size(5,-2)}),this.scene.map.addOverlay(this.areaLabel)}this.setTurnPoint(i),this.isBinded||(this.isBinded=!0,this.scene.mask.enableEdgeMove(),this.scene.mask.removeEventListener("mousemove",this.mousemove),this.scene.mask.addEventListener("mousemove",this.mousemove=this.moveAction.bind(this)),this.scene.mask.addEventListener("dblclick",this.dblclick=this.dblclickAction.bind(this)))}},{key:"dblclickAction",value:function(t){var i=this;m.preventDefault(t),m.stopBubble(t),this.isBinded=!1,this.scene.map.removeOverlay(this.matchOverlay),this.scene.map.removeOverlay(this.tipLabel),this.scene.mask.disableEdgeMove(),this.scene.mask.removeEventListener("mousedown",this.mousedown),this.scene.mask.removeEventListener("mousemove",this.mousemove),this.scene.mask.removeEventListener("dblclick",this.dblclick),this.overlay.setPath(this.points);var o=this.overlay.toGeoJSON().geometry.coordinates[0],s=new BMapGL.Point(o[o.length-1][0],o[o.length-1][1]);this.closeIcon=this.options.closeIcon?this.options.closeIcon:Ye,this.closeBtn=new BMapGL.Marker(s,{icon:this.closeIcon,baseZIndex:36e5,enableMassClear:!0,offset:new BMapGL.Size(10,10)});var a=N.getPolygonCenter(this.overlay.toGeoJSON());this.totalAreaLabel=this.addLabel(this.area,{position:a.bdCenter,offset:new BMapGL.Size(5,-2)});var l={overlay:this.overlay,closeBtn:this.closeBtn,points:this.points.slice(0),turnOverlays:this.turnOverlays.slice(0),totalAreaLabel:this.totalAreaLabel};this.scene.map.addOverlay(l.closeBtn),this.scene.map.removeOverlay(this.areaLabel),this.scene.map.addOverlay(l.totalAreaLabel),l.closeBtn.addEventListener("click",function(u){i.scene.map.removeOverlay(l.closeBtn),i.scene.map.removeOverlay(l.overlay),i.scene.map.removeOverlay(l.totalAreaLabel);for(var c=0,h=l.turnOverlays.length;h>c;c++)i.scene.map.removeOverlay(l.turnOverlays[c]),l.turnOverlays[c]=null}),this.dispatchMeasureEvent(),this.isSeries?this.bindEvent():this.scene.mask.hide()}},{key:"dispatchMeasureEvent",value:function(){var t=new A(te.AREA_END,{points:this.points?this.points.slice(0):[],unit:this.options.unit,area:this.measureArea,overlay:this.overlay});this.dispatchEvent(t),this.scene.dispatchEvent(t)}}]),n}(qt),Xi=function(r){S(n,r);var e=P(n);function n(){var t;k(this,n);for(var i=arguments.length,o=Array(i),s=0;i>s;s++)o[s]=arguments[s];return(t=e.call.apply(e,[this].concat(o))).tolerance=.001,t.toleranceType="kilometers",t}return x(n,[{key:"polygonCutByLine",value:function(t,i,o){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},a=t.geometry,l=i.geometry;l.coordinates.length=l.coordinates.length-1;var u,c,h,p,f,v,g,d=[],y=[],w=null;if(a.type!=="Polygon"&&a.type!=="MultiPolygon"||l.type!=="LineString"||(o===void 0&&(o=""),kt(a,l).features.length===0)||ke(l,a))return w;y[0]=Ln(l,this.tolerance,{units:this.toleranceType}),y[1]=Ln(l,-this.tolerance,{units:this.toleranceType});for(var b=0;1>=b;b++){var E=b;d=[];for(var O=0;l.coordinates.length>O;O++)d.push(l.coordinates[O]);for(var Y=y[E].geometry.coordinates.length-1;Y>=0;Y--)d.push(y[E].geometry.coordinates[Y]);d.push(l.coordinates[0]);var C=wi(R(d));h=C,p=void 0,f=void 0,v=void 0,g=void 0,p=K(c=a),f=K(h),v=c.properties||{},u=(g=Ti(p.coordinates,f.coordinates)).length===0?null:g.length===1?gt(g[0],v):Ot(g,v)}var j=new BMapGL.GeoJSONParse().readFeaturesFromObject(u,s),q=[],vt=[];return j.forEach(function(lt,ft){lt.properties=Object.assign({},t.properties||{}),lt.properties.id+="-".concat(ft),q.push(lt),vt.push(lt.toGeoJSON())}),{geojsonRes:vt,bdRes:q}}},{key:"lineCutByPoly",value:function(t,i,o){if(t.geometry===void 0||t.geometry.type.toLowerCase().indexOf("linestring")===-1)throw"传入的必须为linestring";var s=function(p,f){if(!p)throw Error("line is required");if(!f)throw Error("splitter is required");var v=ue(p),g=ue(f);if(v!=="LineString")throw Error("line must be LineString");if(g==="FeatureCollection")throw Error("splitter cannot be a FeatureCollection");if(g==="GeometryCollection")throw Error("splitter cannot be a GeometryCollection");var d=bi(f,{precision:7});switch(g){case"Point":return ye(p,d);case"MultiPoint":return yn(p,d);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return yn(p,kt(p,d))}}(t,i).features,a=[],l=new BMapGL.GeoJSONParse;if(s.length>1)for(var u=0,c=s.length;c>u;u++){var h=l.readFeatureFromObject(s[u],o);a.push(h)}return{geojsonRes:s,bdRes:a}}}]),n}(z),Vi=function(r){S(n,r);var e=P(n);function n(){var t;k(this,n);for(var i=arguments.length,o=Array(i),s=0;i>s;s++)o[s]=arguments[s];return(t=e.call.apply(e,[this].concat(o))).tolerance=.001,t.toleranceType="kilometers",t}return x(n,[{key:"polygonUnion",value:function(t,i){if(2>t.length)throw"至少2个数据";var o=null,s=!1;t.forEach(function(l,u){1>u?o=l:ke(o,l)?s=!0:o=Wn(o,l)});var a=s?null:o;return{geojsonRes:a,bdRes:new BMapGL.GeoJSONParse().readFeatureFromObject(a,i)}}}]),n}(z),Xn=function(r){S(n,r);var e=P(n);function n(){return k(this,n),e.apply(this,arguments)}return x(n,[{key:"geojsonMove",value:function(t,i,o){(i instanceof BMapGL.Point||i instanceof BMapGL.LatLng)&&(i=G([i.lng,i.lat])),(o instanceof BMapGL.Point||o instanceof BMapGL.LatLng)&&(o=G([o.lng,o.lat]));var s,a,l,u,c=function(h,p,f,v){if(!At(v=v||{}))throw Error("options is invalid");var g=v.units,d=v.zTranslation,y=v.mutate;if(!h)throw Error("geojson is required");if(p==null||isNaN(p))throw Error("distance is required");if(d&&typeof d!="number"&&isNaN(d))throw Error("zTranslation is not a number");if(d=d!==void 0?d:0,p===0&&d===0)return h;if(f==null||isNaN(f))throw Error("direction is required");return 0>p&&(p=-p,f+=180),y!==!1&&y!==void 0||(h=nn(h)),rt(h,function(w){var b=Q(Ei(w,p,f,{units:g}));w[0]=b[0],w[1]=b[1],d&&w.length===3&&(w[2]+=d)}),h}(t,vn(i,o),(s=i,a=o,l===void 0&&(l={}),(u=l.final?Mn(F(a),F(s)):Mn(F(s),F(a)))>180?-(360-u):u));return c}}]),n}(z),Dt=function(r){S(n,r);var e=P(n);function n(t){var i,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(k(this,n),(i=e.call(this)).currentModel=n.MODEL.MOVE,i.labelOptions=xt,i.baseOpts=Xe,i.enableSnap=!0,i.snapDistance=10,i.match=null,i.matchOverlay=null,i.matchOverlayRadius=1,!(t instanceof Ht))throw Error("MoveBase实例化必须输入scene参数");i.scene=t,i.scene.move=Lt(i);var s={};return m.copyOptionsToNew(i.scene.options,o,s),m.copyNotExitOptions(s,i.scene.options),i.options=s,i.target=o.target||Lt(i),i.setOptions(s),i.setSnapPointType(o),i.moveCalculate=new Xn,i.parse=new BMapGL.GeoJSONParse,i}return x(n,[{key:"setOptions",value:function(){this.defineProperty(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{})}},{key:"setCurrentModel",value:function(t){this.currentModel=t}},{key:"open",value:function(t,i){var o=this;this.scene&&(this.overlay=this.currentModel===n.MODEL.MOVE?t:this.parse.readFeatureFromObject(t.toGeoJSON()),this.scene.open(),this.setRunningAction(!0,function(){o.setSceneStatus(I.STATUS_MOVE),o.moveOpe(t),i&&i()}))}},{key:"close",value:function(t){this.overlay&&(this.setRunningAction(!1),this.setSceneStatus(I.STATUS_FREE),this.closeOpe(this.overlay),this.emitOkEvent(this.overlay),t&&t())}},{key:"moveOpe",value:function(t){}},{key:"closeOpe",value:function(t){}},{key:"emitOkEvent",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0&&arguments[1],o=new A(M.COMPLETE,{overlay:t,from:X.MOVE_ON_MAP,model:this.currentModel});this.dispatchEvent(o),i&&this.scene.dispatchEvent(o)}},{key:"setRunningAction",value:function(t,i){t?(this.scene.closeRunningAction(),this.scene.runningAction=this,this.scene.mask.show(),i()):(this.scene.runningAction=null,this.scene.mask.hide())}},{key:"setRadius",value:function(){var t=this.scene.map.getZoomUnits();this.matchOverlay.setRadius(this.matchOverlayRadius*t)}},{key:"addMatchOverlay",value:function(t){this.matchOverlay instanceof BMapGL.Circle?(this.setRadius(),this.matchOverlay.setCenter(t),this.scene.map.addEventListener("zoomend",this.setRadius.bind(this)),this.scene.map.addOverlay(this.matchOverlay)):(this.scene.map.addOverlay(this.matchOverlay),this.matchOverlay.setPosition(t))}},{key:"removeMatchOverlay",value:function(){this.scene.map.removeOverlay(this.matchOverlay),this.scene.map.removeEventListener("zoomend",this.setRadius.bind(this))}},{key:"getSnap",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scene.instances,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:this.snapDistance,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.scene.map,l=null;return this.removeMatchOverlay(),l||(l=pt(t,i,s,a)),!l&&this.scene._attachSnapSource&&(l=pt(t,this.scene._attachSnapSource,s,a)),l||(l=pt(t,o,s,a)),l&&this.addMatchOverlay(l),l}}]),n}(z);Dt.MODEL={COPY:Symbol(),MOVE:Symbol()};var Vn=function(r){S(n,r);var e=P(n);function n(t,i){var o;return k(this,n),(o=e.call(this,t,i)).type=B.DRAWING_POLYLINE,o.scene.setCurrentDrawType(o.type),o}return x(n,[{key:"startAction",value:function(t){m.stopBubble(t),m.preventDefault(t),this.start=this.match?this.match:t.point,this.currentModel===Dt.MODEL.COPY&&(this.overlay.setOptions(this.baseOpts),this.scene.map.addOverlay(this.overlay)),this.scene.mask.enableEdgeMove(),this.scene.mask.removeEventListener("mousedown",this.mousedown),this.scene.mask.removeEventListener("mousemove",this.mousemove),this.scene.mask.addEventListener("mousemove",this.mousemove=this.moveAction.bind(this)),this.scene.mask.addEventListener("mouseup",this.mouseup=this.endAction.bind(this))}},{key:"moveAction",value:function(t){m.preventDefault(t),m.stopBubble(t),this.scene.map.removeOverlay(this.tipLabel),this.tipLabel=new BMapGL.Label("移动改变位置<br>松开结束操作",{position:t.point,offset:new BMapGL.Size(10,10)}),this.tipLabel.setStyle(this.labelOptions),this.scene.map.addOverlay(this.tipLabel);var i=t.point;this.enableSnap&&(this.match=this.currentModel===Dt.MODEL.COPY?this.getSnap(t.point,this.scene.instances):this.getSnap(t.point,this.scene.instances,[],this.snapDistance,this.scene.map,[this.overlay]),this.match&&(i=this.match),this.match=null);var o=this.moveCalculate.geojsonMove(this.source,this.start,i);this.overlay.updateByGeoJSON(o)}},{key:"endAction",value:function(t){m.preventDefault(t),m.stopBubble(t),this.scene.map.removeOverlay(this.tipLabel),this.scene.map.removeOverlay(this.matchOverlay),this.scene.mask.removeEventListener("mousemove",this.mousemove),this.scene.mask.removeEventListener("mouseup",this.mouseup),this.scene.mask.disableEdgeMove(),this.finish()}},{key:"mousemoveAction",value:function(t){m.preventDefault(t),m.stopBubble(t),this.enableSnap&&(this.match=this.getSnap(t.point,this.scene.instances)),this.scene.map.removeOverlay(this.tipLabel),this.tipLabel=new BMapGL.Label("按住确认起点，拖拽进行移动",{position:t.point,offset:new BMapGL.Size(10,10)}),this.tipLabel.setStyle(this.labelOptions),this.scene.map.addOverlay(this.tipLabel)}},{key:"finish",value:function(){this.currentModel===Dt.MODEL.COPY&&this.scene.map.removeOverlay(this.overlay),this.emitOkEvent(this.overlay,!0);var t=new A(M.CHANGE,this.overlay);this.target.dispatchEvent(t),this.close()}},{key:"moveOpe",value:function(){this.source=this.overlay.toGeoJSON(),this.scene.mask.show(),this.scene.mask.addEventListener("mousemove",this.mousemove=this.mousemoveAction.bind(this)),this.scene.mask.addEventListener("mousedown",this.mousedown=this.startAction.bind(this))}},{key:"closeOpe",value:function(){this.scene.map.removeOverlay(this.tipLabel),this.scene.map.removeOverlay(this.matchOverlay),this.scene.mask.removeEventListener("mouseup",this.mouseup),this.scene.mask.removeEventListener("mousedown",this.mousedown),this.scene.mask.removeEventListener("mousemove",this.mousemove)}}]),n}(Dt),Qi=function(r){S(n,r);var e=P(n);function n(t,i){var o;return k(this,n),(o=e.call(this,t,i)).type=B.DRAWING_POLYGON,o.scene.setCurrentDrawType(o.type),o}return x(n)}(Vn),Ki=function(r){S(n,r);var e=P(n);function n(t,i){var o;return k(this,n),(o=e.call(this)).otherOverlays=[],o.snapDistance=15,o.isOpen=!1,o.cursor="default",o.scene=t,o.isOpen=~~i,o._initEvent(),o}return x(n,[{key:"open",get:function(){return this.isOpen},set:function(t){this.isOpen=t}},{key:"distance",get:function(){return this.snapDistance},set:function(t){this.snapDistance=t}},{key:"setPickCursor",value:function(t){this.cursor=t}},{key:"_initEvent",value:function(){var t=this;this.scene&&(this.scene.addEventListener(M.CLICK,function(i){if(t.isOpen&&t.scene.currentStatus===I.STATUS_FREE){var o=t.getSnap(i.target.latlng);if(o){var s=Fe(o,3),a=new Qn(s[0],s[1]);t.dispatchEvent(new A(M.CLICK,a))}}}),this.scene.addEventListener(M.MOVE,function(i){if(t.isOpen&&t.scene.currentStatus===I.STATUS_FREE){var o=t.getSnap(i.target.latlng);if(o){t.scene.map.platform.style.cursor=t.cursor;var s=Fe(o,3),a=new Qn(s[0],s[1]);t.dispatchEvent(new A(M.MOVE,a))}else t.scene.map.platform.style.cursor=t.scene.map.config.defaultCursor,t.dispatchEvent(new A(M.MOVE,null))}}))}},{key:"attachOverlays",value:function(t){t instanceof Array&&(this.otherOverlays=t)}},{key:"getSnap",value:function(t){var i=null;return i||(i=this.getSnapByLL(t,this.scene.instances)),!i&&this.otherOverlays&&this.otherOverlays.length>0&&(i=this.getSnapByLL(t,this.otherOverlays)),i}},{key:"getSnapByLL",value:function(t,i){var o,s=(o=this.scene.map.getZoom(),Math.pow(2,18-o)),a=this.snapDistance*s;if(!(i&&i instanceof Array))return null;for(var l in i){var u=i[l];if(u instanceof BMapGL.Marker){var c=u.getPosition();if(a>1e3*N.getDistance(t,c,"kilometers"))return[u,0,c]}else{var h=u.getPath();for(var p in h){var f=h[p],v=1e3*N.getDistance(t,f,"kilometers");if(v&&a>v)return[u,p,f]}}}return null}}]),n}(z),Qn=function(r){S(n,r);var e=P(n);function n(t,i){var o;return k(this,n),(o=e.call(this))._index=-1,o.overlay=t,o.path=t instanceof BMapGL.Marker?[t.getPosition()]:t.getPath(),i>o.path.length-1||(o.index=i),o}return x(n,[{key:"index",get:function(){return this._index},set:function(t){this._index=parseInt(t)||0;var i=new A(M.CHANGE,this.index);this.dispatchEvent(i)}},{key:"getCurrentNode",value:function(){return this.path[this.index]}},{key:"updateNode",value:function(t,i){if(this.overlay instanceof BMapGL.Marker){var o=BMapGL.Projection.convertLL2MC(t);this.overlay.setPoint(o)}else i!==void 0&&i>=0&&this.path.length>i?this.path[i]=t:this.path[this.index]=t,this.overlay.setPath(this.path)}},{key:"hasNext",value:function(){return this.index+1>=0&&this.path.length>this.index+1}},{key:"next",value:function(){return this.hasNext()?(this._index++,this.path[this.index]):null}},{key:"hasPrev",value:function(){return this.index-1>=0&&this.path.length>this.index-1}},{key:"prev",value:function(){return this.hasPrev()?(this._index--,this.path[this.index]):null}}]),n}(z);L.ActionStatus=X,L.AreaMeasure=Ji,L.CircleDraw=Ne,L.CircleEdit=Jn,L.CorrectPoint=Ki,L.CutCalculate=Xi,L.DistanceMeasure=Yi,L.DrawControl=ji,L.DrawScene=Ht,L.DrawStatus=I,L.DrawingType=B,L.GeoCalculator=N,L.MapSelect=ie,L.MarkerDraw=Ie,L.MarkerEdit=Wi,L.Measure=Ui,L.MeasureEvent=te,L.MoveCalculate=Xn,L.Operate=Rt,L.OperateEventType=M,L.PolygonDraw=qt,L.PolygonEdit=zn,L.PolygonMove=Qi,L.PolylineDraw=Nt,L.PolylineEdit=Ce,L.PolylineMove=Vn,L.RectDraw=Re,L.RectEdit=Yn,L.Select=zi,L.UnionCalculate=Vi,Object.defineProperty(L,"__esModule",{value:!0})})})(_e,_e.exports);var Kn=_e.exports;const $i=Hi(Kn),er=qi({__proto__:null,default:$i},[Kn]);export{er as b};
